{"version":3,"file":"static/js/main.920feb74.js","mappings":"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","sources":["app|sync|/^(?:/.//)(?%21(?:(?:(?:.*/+api)%7C(?:/+middleware)%7C(?:/+(html%7Cnative-intent))))/.[tj]sx?$).*(?:/.android%7C/.ios%7C/.native)?/.[tj]sx?$","types/dog-profile.ts","app/(tabs)/record.web.tsx","app/(tabs)/record.styles.ts","app/trails.tsx","context/AccountContext.tsx","app/(tabs)/explore.styles.ts","context/AuthContext.tsx","app/trail/[id].tsx","app/signup.tsx","app/login.tsx","web/reanimated-shim.js","web/nanoid-non-secure.js","app/(tabs)/explore.tsx","app/onboarding/dog-basics.tsx","app/(tabs)/record.tsx","components/AnimatedTabBar.styles.ts","components/AnimatedTabBar.tsx","app/(tabs)/_layout.tsx","app/index.tsx","app/demo.tsx","lib/api.ts","app/onboarding/dog-personality.tsx","context/TrailsContext.tsx","components/TrailMap.styles.ts","components/TrailMap.web.tsx","app/onboarding/dog-basics.styles.ts","context/ThemeContext.tsx","app/_layout.tsx","app/(tabs)/explore.web.tsx","app/(tabs)/profile.tsx","app/onboarding/dog-personality.styles.ts","app/(tabs)/profile.styles.ts","app/trail/[id].styles.ts","app/+not-found.tsx","utils/distance.ts","constants/colors.ts","components/TrailMapPreview.styles.ts","components/TrailMapPreview.web.tsx","context/DogsContext.tsx","webpack/bootstrap","webpack/runtime/chunk loaded","webpack/runtime/compat get default export","webpack/runtime/define property getters","webpack/runtime/global","webpack/runtime/hasOwnProperty shorthand","webpack/runtime/make namespace object","webpack/runtime/publicPath","webpack/runtime/jsonp chunk loading","webpack/startup"],"sourcesContent":["var map = {\n\t\"./(tabs)/_layout.tsx\": 5210,\n\t\"./(tabs)/explore.styles.ts\": 2699,\n\t\"./(tabs)/explore.tsx\": 4509,\n\t\"./(tabs)/explore.web.tsx\": 8389,\n\t\"./(tabs)/profile.styles.ts\": 8745,\n\t\"./(tabs)/profile.tsx\": 8415,\n\t\"./(tabs)/record.styles.ts\": 1095,\n\t\"./(tabs)/record.tsx\": 5209,\n\t\"./(tabs)/record.web.tsx\": 745,\n\t\"./+not-found.tsx\": 8973,\n\t\"./_layout.tsx\": 7990,\n\t\"./demo.tsx\": 5625,\n\t\"./index.tsx\": 5250,\n\t\"./login.tsx\": 4101,\n\t\"./onboarding/dog-basics.styles.ts\": 7924,\n\t\"./onboarding/dog-basics.tsx\": 4674,\n\t\"./onboarding/dog-personality.styles.ts\": 8625,\n\t\"./onboarding/dog-personality.tsx\": 6183,\n\t\"./signup.tsx\": 3764,\n\t\"./trail/[id].styles.ts\": 8776,\n\t\"./trail/[id].tsx\": 3686,\n\t\"./trails.tsx\": 2399\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 587;","export type DogSize = 'XS' | 'S' | 'M' | 'L' | 'XL';\n\nexport const DOG_SIZES: DogSize[] = ['XS', 'S', 'M', 'L', 'XL'];\n\nexport const PERSONALITY_TAGS = [\n  'Friendly',\n  'Shy',\n  'Energetic',\n  'Calm',\n  'Social',\n  'Independent',\n  'Playful',\n  'Curious',\n  'Barky',\n  'Reactive',\n  'Easily Triggered',\n  'Gentle',\n  'Protective',\n  'Anxious',\n  'Confident',\n  'Food-Motivated',\n  'Quiet',\n  'Adventurous',\n  'Lazy',\n  'Affectionate',\n  'Dominant',\n  'Submissive',\n  'Fearful',\n  'Obedient',\n  'Stubborn',\n  'High-Prey-Drive',\n  'Leash-Pulling',\n  'Good-With-Dogs',\n  'Good-With-Kids',\n] as const;\n\nexport type PersonalityTag = typeof PERSONALITY_TAGS[number];\n\nexport type RecallReliability = 'Poor' | 'Fair' | 'Good' | 'Excellent';\n\nexport const RECALL_RELIABILITY_OPTIONS: RecallReliability[] = ['Poor', 'Fair', 'Good', 'Excellent'];\n\nexport interface Vaccine {\n  name: string;\n  date: string;\n}\n\nexport interface DogProfile {\n  id?: string;\n  user_id: string;\n  name: string;\n  nickname?: string;\n  size: DogSize;\n  age: number;\n  photo?: string;\n  personality_tags: string[];\n  vaccines?: Vaccine[];\n  recall_reliability?: RecallReliability;\n  created_at?: string;\n  updated_at?: string;\n}\n","import React, { useState, useEffect, useRef } from 'react';\nimport { Text, View, StyleSheet, TouchableOpacity, Alert, ActivityIndicator, Animated, PanResponder, Dimensions, TextInput, ScrollView, Modal } from 'react-native';\n\nimport TrailMap from '@/components/TrailMap';\n\nimport { useLocalSearchParams, useRouter } from 'expo-router';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\n\nimport { Square, Play, MapPin, Watch, Bell, ChevronUp, Play as PlayIcon, Square as SquareIcon, ChevronDown, Navigation } from 'lucide-react-native';\nimport styles from './record.styles';\nimport colors from '@/constants/colors';\nimport { useTrails } from '@/context/TrailsContext';\nimport { useAuth } from '@/context/AuthContext';\n\nimport { Coordinate, Trail } from '@/types/trail';\n\nimport { formatDistance, calculateTotalDistance, formatDuration } from '@/utils/distance';\n\nconst LOCATION_KEY = 'recording_coordinates';\nconst START_TIME_KEY = 'recording_start_time';\nconst MAX_ELEV_KEY = 'recording_max_elevation';\nconst MAX_SPEED_KEY = 'recording_max_speed';\nconst LAST_UPDATE_KEY = 'recording_last_update';\n\nexport default function RecordScreenWeb() {\n  const { saveTrail, getTrailById } = useTrails();\n  const { user } = useAuth();\n  const params = useLocalSearchParams();\n  const router = useRouter();\n  const trailId = typeof params.trailId === 'string' ? params.trailId : undefined;\n  const existingTrail = trailId ? getTrailById(trailId) : undefined;\n  const mapRef = useRef<any>(null);\n\n  const [isRecording, setIsRecording] = useState<boolean>(false);\n  const [coordinates, setCoordinates] = useState<Coordinate[]>([]);\n  const [currentLocation, setCurrentLocation] = useState<Coordinate | null>(null);\n  const [duration, setDuration] = useState<number>(0);\n  const [hasPermission, setHasPermission] = useState<boolean | null>(null);\n  const [isLoadingPermission, setIsLoadingPermission] = useState<boolean>(true);\n  const [startLocation, setStartLocation] = useState<{ city?: string; country?: string } | null>(null);\n  const geocodeCache = useRef<Map<string, { city?: string; country?: string }>>(new Map());\n\n  const watchIdRef = useRef<number | null>(null);\n  const timerRef = useRef<ReturnType<typeof setInterval> | null>(null);\n  const wakeLockRef = useRef<any>(null);\n\n  const bottomSheetHeight = Dimensions.get('window').height * 0.5;\n  const collapsedHeight = 280;\n  const navbarHeight = 92;\n  const bottomSheetAnim = useRef(new Animated.Value(collapsedHeight)).current;\n  const [isExpanded, setIsExpanded] = useState<boolean>(false);\n  const [elevation, setElevation] = useState<number>(0);\n  const [maxElevation, setMaxElevation] = useState<number>(0);\n  const [pace, setPace] = useState<string>('0:00');\n  const [speed, setSpeed] = useState<number>(0);\n  const [maxSpeed, setMaxSpeed] = useState<number>(0);\n  const [showSaveModal, setShowSaveModal] = useState<boolean>(false);\n  const [draftTrail, setDraftTrail] = useState<Partial<Trail> | null>(null);\n  const [formName, setFormName] = useState<string>('');\n  const [formDescription, setFormDescription] = useState<string>('');\n  const [formPhoto, setFormPhoto] = useState<string | undefined>(undefined);\n\n  useEffect(() => {\n    // On web, check permissions via the Permissions API when available\n    (async () => {\n      try {\n        if ((navigator as any).permissions && (navigator as any).permissions.query) {\n          const status = await (navigator as any).permissions.query({ name: 'geolocation' });\n          setHasPermission(status.state === 'granted');\n          status.onchange = () => setHasPermission(status.state === 'granted');\n        } else {\n          // Fallback: attempt to get current position to trigger prompt\n          try {\n            await new Promise((resolve, reject) => {\n              navigator.geolocation.getCurrentPosition(() => resolve(true), () => resolve(false), { timeout: 5000 });\n            });\n            setHasPermission(true);\n          } catch (e) {\n            setHasPermission(false);\n          }\n        }\n      } catch (err) {\n        console.warn('Permission check failed', err);\n        setHasPermission(null);\n      } finally {\n        setIsLoadingPermission(false);\n        loadRecordingState();\n      }\n    })();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  const loadRecordingState = async () => {\n    try {\n      const coordsStr = await AsyncStorage.getItem(LOCATION_KEY);\n      if (coordsStr) {\n        const coords = JSON.parse(coordsStr);\n        setCoordinates(coords);\n      }\n\n      const maxElevationStr = await AsyncStorage.getItem(MAX_ELEV_KEY);\n      if (maxElevationStr) setMaxElevation(parseFloat(maxElevationStr));\n\n      const maxSpeedStr = await AsyncStorage.getItem(MAX_SPEED_KEY);\n      if (maxSpeedStr) setMaxSpeed(parseFloat(maxSpeedStr));\n\n      const startTimeStr = await AsyncStorage.getItem(START_TIME_KEY);\n      if (startTimeStr) {\n        const elapsed = Math.floor((Date.now() - parseInt(startTimeStr)) / 1000);\n        setDuration(elapsed);\n        setIsRecording(true);\n        startTimer();\n      }\n    } catch (error) {\n      console.error('Error loading recording state:', error);\n    }\n  };\n\n  const startTimer = () => {\n    if (timerRef.current) return;\n    timerRef.current = setInterval(async () => {\n      try {\n        const startTimeStr = await AsyncStorage.getItem(START_TIME_KEY);\n        if (startTimeStr) {\n          const elapsed = Math.floor((Date.now() - parseInt(startTimeStr)) / 1000);\n          setDuration(elapsed);\n        }\n      } catch (e) {}\n    }, 1000);\n  };\n\n  const stopTimer = () => {\n    if (timerRef.current) {\n      clearInterval(timerRef.current);\n      timerRef.current = null;\n    }\n  };\n\n  const startRecording = async () => {\n    console.log('Starting web recording...');\n    setIsRecording(true);\n    setCoordinates([]);\n    setDuration(0);\n    setMaxElevation(0);\n    setMaxSpeed(0);\n\n    try {\n      const startTime = Date.now();\n      await AsyncStorage.setItem(START_TIME_KEY, startTime.toString());\n      await AsyncStorage.removeItem(LOCATION_KEY);\n      await AsyncStorage.removeItem(MAX_ELEV_KEY);\n      await AsyncStorage.removeItem(MAX_SPEED_KEY);\n      await AsyncStorage.removeItem(LAST_UPDATE_KEY);\n\n      // get initial position\n      navigator.geolocation.getCurrentPosition(async (pos) => {\n        const coord = { latitude: pos.coords.latitude, longitude: pos.coords.longitude };\n        await AsyncStorage.setItem(LOCATION_KEY, JSON.stringify([coord]));\n        setCoordinates([coord]);\n        setCurrentLocation(coord);\n      }, (err) => {\n        console.warn('Initial geolocation failed', err);\n      }, { enableHighAccuracy: true, timeout: 10000 });\n\n      // start watch\n      const id = navigator.geolocation.watchPosition(async (pos) => {\n        const coord = { latitude: pos.coords.latitude, longitude: pos.coords.longitude };\n        setCurrentLocation(coord);\n        setCoordinates(prev => {\n          const newCoords = [...prev, coord];\n          AsyncStorage.setItem(LOCATION_KEY, JSON.stringify(newCoords)).catch(() => {});\n          return newCoords;\n        });\n\n        await AsyncStorage.setItem(LAST_UPDATE_KEY, Date.now().toString());\n      }, (err) => {\n        console.error('watchPosition error', err);\n      }, { enableHighAccuracy: true, maximumAge: 0, timeout: 10000 });\n\n      watchIdRef.current = id as unknown as number;\n\n      // request wake lock (Chromium) to keep screen on\n      try {\n        // @ts-ignore\n        if ((navigator as any).wakeLock && (navigator as any).wakeLock.request) {\n          // @ts-ignore\n          wakeLockRef.current = await (navigator as any).wakeLock.request('screen');\n        }\n      } catch (e) {\n        console.warn('Wake lock request failed', e);\n      }\n\n      startTimer();\n    } catch (error: any) {\n      console.error('Recording error:', error);\n      Alert.alert('Error', error?.message || 'Failed to start recording');\n      setIsRecording(false);\n    }\n  };\n\n  const stopRecording = async () => {\n    console.log('Stopping web recording...');\n    try {\n      if (watchIdRef.current !== null) {\n        navigator.geolocation.clearWatch(watchIdRef.current);\n        watchIdRef.current = null;\n      }\n\n      if (wakeLockRef.current && wakeLockRef.current.release) {\n        await wakeLockRef.current.release();\n        wakeLockRef.current = null;\n      }\n\n      stopTimer();\n\n      const coordsStr = await AsyncStorage.getItem(LOCATION_KEY);\n      const finalCoords = coordsStr ? JSON.parse(coordsStr) : coordinates;\n\n      const maxElevationStr = await AsyncStorage.getItem(MAX_ELEV_KEY);\n      const finalMaxElevation = maxElevationStr ? parseFloat(maxElevationStr) : maxElevation;\n\n      const maxSpeedStr = await AsyncStorage.getItem(MAX_SPEED_KEY);\n      const finalMaxSpeed = maxSpeedStr ? parseFloat(maxSpeedStr) : maxSpeed;\n\n      const startTimeStr = await AsyncStorage.getItem(START_TIME_KEY);\n      const finalDuration = startTimeStr ? Math.floor((Date.now() - parseInt(startTimeStr)) / 1000) : duration;\n\n      if (!finalCoords || finalCoords.length < 2) {\n        Alert.alert('No Trail Data', 'Not enough data to save this trail. Try walking a bit more!');\n        setIsRecording(false);\n        setCoordinates([]);\n        setDuration(0);\n        await AsyncStorage.removeItem(LOCATION_KEY);\n        await AsyncStorage.removeItem(MAX_ELEV_KEY);\n        await AsyncStorage.removeItem(MAX_SPEED_KEY);\n        await AsyncStorage.removeItem(START_TIME_KEY);\n        await AsyncStorage.removeItem(LAST_UPDATE_KEY);\n        return;\n      }\n\n      const distance = calculateTotalDistance(finalCoords);\n\n      const distanceKm = distance / 1000;\n      const durationMin = finalDuration / 60;\n      let finalPace = '0:00';\n      if (distanceKm > 0) {\n        const paceMinPerKm = durationMin / distanceKm;\n        const minutes = Math.floor(paceMinPerKm);\n        const seconds = Math.round((paceMinPerKm - minutes) * 60);\n        finalPace = `${minutes}:${seconds.toString().padStart(2, '0')}`;\n      }\n\n      const trail: Trail = {\n        id: Date.now().toString(),\n        date: Date.now(),\n        distance,\n        duration: finalDuration,\n        coordinates: finalCoords,\n        city: startLocation?.city,\n        country: startLocation?.country,\n        pace: finalPace,\n        speed: finalMaxSpeed,\n        maxElevation: finalMaxElevation,\n      };\n\n      // open save modal with draft data instead of saving immediately\n      setDraftTrail(trail);\n      setFormName(trail.name || '');\n      setFormDescription((trail as any).description || '');\n      setFormPhoto((trail as any).photo || undefined);\n      setShowSaveModal(true);\n    } catch (error) {\n      console.error('Stop error:', error);\n      Alert.alert('Error', 'Failed to stop recording');\n      setIsRecording(false);\n    }\n  };\n\n  const submitSave = async () => {\n    if (!draftTrail) return;\n    const toSave: Trail = {\n      ...(draftTrail as Trail),\n      name: formName || (draftTrail as any).name || 'Untitled Trail',\n      description: formDescription,\n      photo: formPhoto,\n    };\n\n    try {\n      await saveTrail(toSave);\n      setShowSaveModal(false);\n      setDraftTrail(null);\n      setIsRecording(false);\n      setCoordinates([]);\n      setDuration(0);\n      setStartLocation(null);\n      setElevation(0);\n      setMaxElevation(0);\n      setPace('0:00');\n      setSpeed(0);\n      setMaxSpeed(0);\n\n      await AsyncStorage.removeItem(LOCATION_KEY);\n      await AsyncStorage.removeItem(MAX_ELEV_KEY);\n      await AsyncStorage.removeItem(MAX_SPEED_KEY);\n      await AsyncStorage.removeItem(START_TIME_KEY);\n      await AsyncStorage.removeItem(LAST_UPDATE_KEY);\n\n      const savedId = (toSave as any).id || null;\n      if (savedId) router.push(`/trail/${savedId}`);\n      else Alert.alert('Success', 'Trail saved successfully!');\n    } catch (err) {\n      console.error('Save failed', err);\n      Alert.alert('Error', 'Failed to save trail');\n    }\n  };\n\n  const cancelSave = () => {\n    setShowSaveModal(false);\n    setDraftTrail(null);\n  };\n\n  useEffect(() => {\n    if (duration > 0) {\n      const distance = calculateTotalDistance(coordinates);\n      const distanceKm = distance / 1000;\n      const durationMin = duration / 60;\n      if (distanceKm > 0) {\n        const paceMinPerKm = durationMin / distanceKm;\n        const minutes = Math.floor(paceMinPerKm);\n        const seconds = Math.round((paceMinPerKm - minutes) * 60);\n        setPace(`${minutes}:${seconds.toString().padStart(2, '0')}`);\n      }\n    }\n  }, [duration, coordinates]);\n\n  const initialHeight = useRef<number>(0);\n\n  const panResponder = useRef(\n    PanResponder.create({\n      onStartShouldSetPanResponder: () => true,\n      onMoveShouldSetPanResponder: (_, gestureState) => Math.abs(gestureState.dy) > 5,\n      onPanResponderGrant: () => { initialHeight.current = (bottomSheetAnim as any)._value; },\n      onPanResponderMove: (_, gestureState) => {\n        const newValue = initialHeight.current - gestureState.dy;\n        if (newValue >= collapsedHeight && newValue <= bottomSheetHeight) {\n          bottomSheetAnim.setValue(newValue);\n        }\n      },\n      onPanResponderRelease: (_, gestureState) => {\n        const threshold = (bottomSheetHeight + collapsedHeight) / 2;\n        const currentValue = (bottomSheetAnim as any)._value;\n        if (gestureState.dy < -50) expandBottomSheet();\n        else if (gestureState.dy > 50) collapseBottomSheet();\n        else if (currentValue > threshold) expandBottomSheet();\n        else collapseBottomSheet();\n      },\n    })\n  ).current;\n\n  const expandBottomSheet = () => {\n    setIsExpanded(true);\n    Animated.spring(bottomSheetAnim, { toValue: bottomSheetHeight, useNativeDriver: false, tension: 50, friction: 8 }).start();\n  };\n\n  const collapseBottomSheet = () => {\n    setIsExpanded(false);\n    Animated.spring(bottomSheetAnim, { toValue: collapsedHeight, useNativeDriver: false, tension: 50, friction: 8 }).start();\n  };\n\n  const toggleBottomSheet = () => { if (isExpanded) collapseBottomSheet(); else expandBottomSheet(); };\n\n  if (isLoadingPermission) {\n    return (\n      <View style={styles.loadingContainer}>\n        <ActivityIndicator size=\"large\" color={colors.primary} />\n        <Text style={styles.loadingText}>Checking permissions...</Text>\n      </View>\n    );\n  }\n\n  if (!hasPermission) {\n    return (\n      <View style={styles.permissionContainer}>\n        <MapPin size={64} color=\"#666\" />\n        <Text style={styles.permissionTitle}>Location Permission Required</Text>\n        <Text style={styles.permissionText}>\n          This page needs access to your location to track your walks. Please allow location access in your browser.\n        </Text>\n        <TouchableOpacity style={styles.permissionButton} onPress={() => {\n          navigator.geolocation.getCurrentPosition(() => setHasPermission(true), () => setHasPermission(false));\n        }}>\n          <Text style={styles.permissionButtonText}>Grant Permission</Text>\n        </TouchableOpacity>\n      </View>\n    );\n  }\n\n  const distance = calculateTotalDistance(coordinates);\n  const progress = existingTrail && isRecording && coordinates.length > 0 && existingTrail.coordinates.length > 0\n    ? Math.min((distance / existingTrail.distance) * 100, 100)\n    : 0;\n  const showProgress = !!existingTrail;\n\n  const recenterMap = async () => {\n    if (mapRef.current) {\n      try {\n        navigator.geolocation.getCurrentPosition((pos) => {\n          const coord = { latitude: pos.coords.latitude, longitude: pos.coords.longitude };\n          setCurrentLocation(coord);\n          mapRef.current.animateToRegion({ latitude: coord.latitude, longitude: coord.longitude, latitudeDelta: 0.01, longitudeDelta: 0.01 }, 500);\n        });\n      } catch (error) {\n        console.error('Error getting current location:', error);\n      }\n    }\n  };\n\n  return (\n    <View style={styles.container}>\n      {currentLocation && (\n        <TrailMap\n          ref={mapRef}\n          coordinates={coordinates}\n          style={styles.map}\n          initialRegion={{ latitude: currentLocation.latitude, longitude: currentLocation.longitude, latitudeDelta: 0.01, longitudeDelta: 0.01 }}\n          showsUserLocation\n          followsUserLocation={isRecording}\n          showsMyLocationButton={false}\n        />\n      )}\n\n      <TouchableOpacity style={styles.recenterButton} onPress={recenterMap} activeOpacity={0.8}>\n        <Navigation size={24} color=\"#5d6b4a\" />\n      </TouchableOpacity>\n\n      <Animated.View style={[styles.bottomSheet, { height: Animated.add(bottomSheetAnim, navbarHeight), bottom: 0 }]}>\n        <View {...panResponder.panHandlers} style={styles.handleBar}>\n          <TouchableOpacity style={styles.handleContainer} onPress={toggleBottomSheet} activeOpacity={0.7}>\n            <View style={styles.handle} />\n            {isExpanded ? (<ChevronDown size={20} color=\"#9ca3af\" />) : (<ChevronUp size={20} color=\"#9ca3af\" />)}\n          </TouchableOpacity>\n        </View>\n\n        <View style={styles.bottomSheetContent}>\n          <View style={styles.statsGrid}>\n            <View style={styles.statItem}><Text style={styles.statItemLabel}>Time</Text><Text style={styles.statItemValue}>{formatDuration(duration)}</Text></View>\n            <View style={styles.statItem}><Text style={styles.statItemLabel}>Distance</Text><Text style={styles.statItemValue}>{formatDistance(distance)}</Text></View>\n            <View style={styles.statItem}><Text style={styles.statItemLabel}>Elevation</Text><Text style={styles.statItemValue}>{elevation.toFixed(0)}m</Text></View>\n            <View style={styles.statItem}><Text style={styles.statItemLabel}>Pace</Text><Text style={styles.statItemValue}>{pace}/km</Text></View>\n            <View style={styles.statItem}><Text style={styles.statItemLabel}>Speed</Text><Text style={styles.statItemValue}>{speed.toFixed(1)} km/h</Text></View>\n            {showProgress && (<View style={styles.statItem}><Text style={styles.statItemLabel}>Progress</Text><Text style={styles.statItemValue}>{progress.toFixed(0)}%</Text></View>)}\n          </View>\n\n          <TouchableOpacity style={[styles.recordButton, isRecording && styles.recordButtonActive]} onPress={isRecording ? stopRecording : startRecording} activeOpacity={0.8}>\n            {isRecording ? (<><Square size={24} color=\"#fff\" fill=\"#fff\" /><Text style={styles.recordButtonText}>Stop & Save</Text></>) : (<><Play size={24} color=\"#fff\" fill=\"#fff\" /><Text style={styles.recordButtonText}>Start Trail</Text></>) }\n          </TouchableOpacity>\n\n          {isExpanded && (\n            <View style={styles.expandedContent}>\n              <View style={styles.divider} />\n              <TouchableOpacity style={styles.optionRow} onPress={() => Alert.alert('Apple Watch', 'Connect your Apple Watch to sync workout data.')} activeOpacity={0.7}>\n                <View style={styles.optionIconContainer}><Watch size={24} color=\"#5d6b4a\" /></View>\n                <View style={styles.optionTextContainer}><Text style={styles.optionTitle}>Apple Watch</Text><Text style={styles.optionSubtitle}>Not connected</Text></View>\n                <View style={styles.optionBadge}><Text style={styles.optionBadgeText}>Connect</Text></View>\n              </TouchableOpacity>\n\n              <TouchableOpacity style={styles.optionRow} onPress={() => Alert.alert('Alerts', 'Configure alerts for distance milestones and pace notifications.')} activeOpacity={0.7}>\n                <View style={styles.optionIconContainer}><Bell size={24} color=\"#5d6b4a\" /></View>\n                <View style={styles.optionTextContainer}><Text style={styles.optionTitle}>Alerts</Text><Text style={styles.optionSubtitle}>Distance & pace notifications</Text></View>\n                <View style={[styles.optionBadge, styles.optionBadgeActive]}><Text style={[styles.optionBadgeText, styles.optionBadgeTextActive]}>Active</Text></View>\n              </TouchableOpacity>\n            </View>\n          )}\n        </View>\n      </Animated.View>\n      <Modal visible={showSaveModal} animationType=\"slide\" transparent={true} onRequestClose={cancelSave}>\n        <View style={styles.modalOverlay}>\n          <View style={styles.modalContainer}>\n            <View style={styles.modalContent}>\n              <Text style={styles.modalTitle}>Save Trail</Text>\n              <Text style={{ fontSize: 14, marginTop: 8 }}>Name</Text>\n              <TextInput placeholder=\"Trail name\" value={formName} onChangeText={setFormName} style={styles.input} />\n              <Text style={{ fontSize: 14, marginTop: 8 }}>Description</Text>\n              <TextInput placeholder=\"Description\" value={formDescription} onChangeText={setFormDescription} style={[styles.input, { height: 100 }]} multiline />\n              <Text style={{ fontSize: 14, marginTop: 8 }}>Photo URL (optional)</Text>\n              <TextInput placeholder=\"Photo URL\" value={formPhoto} onChangeText={setFormPhoto as any} style={styles.input} />\n              <View style={{ flexDirection: 'row', gap: 8, marginTop: 12 }}>\n                <TouchableOpacity style={styles.modalButton} onPress={cancelSave}><Text style={styles.modalButtonText}>Cancel</Text></TouchableOpacity>\n                <TouchableOpacity style={[styles.modalButton, styles.modalButtonPrimary]} onPress={submitSave}><Text style={[styles.modalButtonText, { color: '#fff' }]}>Save Trail</Text></TouchableOpacity>\n              </View>\n            </View>\n          </View>\n        </View>\n      </Modal>\n    </View>\n  );\n}\n\n// styles are imported from record.styles.ts\n","import { StyleSheet, Platform } from 'react-native';\nimport colors from '@/constants/colors';\n\nexport default StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: colors.background,\n  },\n  map: {\n    ...StyleSheet.absoluteFillObject,\n  },\n  webContainer: {\n    flex: 1,\n    justifyContent: 'center',\n    alignItems: 'center',\n    backgroundColor: colors.background,\n    padding: 20,\n  },\n  webText: {\n    marginTop: 16,\n    fontSize: 16,\n    color: colors.muted,\n    textAlign: 'center',\n  },\n  loadingContainer: {\n    flex: 1,\n    justifyContent: 'center',\n    alignItems: 'center',\n    backgroundColor: colors.background,\n  },\n  loadingText: {\n    marginTop: 16,\n    fontSize: 16,\n    color: colors.muted,\n  },\n  permissionContainer: {\n    flex: 1,\n    justifyContent: 'center',\n    alignItems: 'center',\n    backgroundColor: colors.background,\n    padding: 32,\n  },\n  permissionTitle: {\n    marginTop: 16,\n    fontSize: 20,\n    fontWeight: '700' as const,\n    color: colors.darkGreen,\n    textAlign: 'center',\n  },\n  permissionText: {\n    marginTop: 8,\n    fontSize: 16,\n    color: colors.muted,\n    textAlign: 'center',\n  },\n  permissionButton: {\n    marginTop: 24,\n    paddingHorizontal: 32,\n    paddingVertical: 16,\n    backgroundColor: colors.primary,\n    borderRadius: 12,\n  },\n  permissionButtonText: {\n    fontSize: 16,\n    fontWeight: '600' as const,\n    color: '#fff',\n  },\n  statsContainer: {\n    position: 'absolute',\n    left: 20,\n    right: 20,\n    flexDirection: 'row',\n    gap: 12,\n  },\n  statBox: {\n    flex: 1,\n    backgroundColor: 'rgba(255, 255, 255, 0.95)',\n    borderRadius: 16,\n    padding: 16,\n  shadowColor: '#000',\n    shadowOffset: { width: 0, height: 2 },\n    shadowOpacity: 0.1,\n    shadowRadius: 8,\n    elevation: 4,\n  },\n  statLabel: {\n    fontSize: 13,\n    color: colors.muted,\n    fontWeight: '500' as const,\n    marginBottom: 4,\n  },\n  statValue: {\n    fontSize: 24,\n    color: colors.darkGreen,\n    fontWeight: '700' as const,\n  },\n  controlContainer: {\n    position: 'absolute',\n    left: 20,\n    right: 20,\n    alignItems: 'center',\n  },\n  recordButton: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: 12,\n    paddingHorizontal: 32,\n    paddingVertical: 20,\n  backgroundColor: colors.primary,\n    borderRadius: 50,\n    shadowColor: '#000',\n    shadowOffset: { width: 0, height: 4 },\n    shadowOpacity: 0.3,\n    shadowRadius: 12,\n    elevation: 8,\n  },\n  recordButtonActive: {\n    backgroundColor: '#dc2626',\n  },\n  recordButtonText: {\n    fontSize: 18,\n    fontWeight: '700' as const,\n    color: '#fff',\n  },\n  bottomSheet: {\n    position: 'absolute',\n    left: 0,\n    right: 0,\n  backgroundColor: colors.background,\n    borderTopLeftRadius: 24,\n    borderTopRightRadius: 24,\n    shadowColor: '#000',\n    shadowOffset: { width: 0, height: -4 },\n    shadowOpacity: 0.15,\n    shadowRadius: 16,\n    elevation: 20,\n  },\n  handleBar: {\n    paddingTop: 12,\n    paddingBottom: 8,\n    alignItems: 'center',\n  },\n  handleContainer: {\n    alignItems: 'center',\n    gap: 4,\n  },\n  handle: {\n    width: 40,\n    height: 4,\n    backgroundColor: colors.border,\n    borderRadius: 2,\n  },\n  bottomSheetContent: {\n    flex: 1,\n    paddingHorizontal: 20,\n    paddingBottom: Platform.OS === 'ios' ? 100 : 92,\n  },\n  statsGrid: {\n    flexDirection: 'row',\n    flexWrap: 'wrap',\n    gap: 12,\n    marginBottom: 20,\n  },\n  statItem: {\n    width: '31%',\n    backgroundColor: colors.surface,\n    borderRadius: 12,\n    padding: 12,\n    alignItems: 'center',\n  },\n  statItemLabel: {\n    fontSize: 11,\n  color: colors.muted,\n    fontWeight: '600' as const,\n    textTransform: 'uppercase' as const,\n    letterSpacing: 0.5,\n    marginBottom: 6,\n  },\n  statItemValue: {\n    fontSize: 18,\n    color: colors.darkGreen,\n    fontWeight: '700' as const,\n  },\n  expandedContent: {\n    marginTop: 8,\n  },\n  divider: {\n    height: 1,\n    backgroundColor: colors.border,\n    marginVertical: 16,\n  },\n  optionRow: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    paddingVertical: 16,\n    paddingHorizontal: 16,\n    backgroundColor: colors.surface,\n    borderRadius: 12,\n    marginBottom: 12,\n  },\n  optionIconContainer: {\n    width: 48,\n    height: 48,\n    borderRadius: 24,\n    backgroundColor: 'rgba(93, 107, 74, 0.1)',\n    alignItems: 'center',\n    justifyContent: 'center',\n    marginRight: 12,\n  },\n  optionTextContainer: {\n    flex: 1,\n  },\n  optionTitle: {\n    fontSize: 16,\n    fontWeight: '600' as const,\n    color: colors.darkGreen,\n    marginBottom: 2,\n  },\n  optionSubtitle: {\n    fontSize: 13,\n    color: colors.muted,\n  },\n  optionBadge: {\n    paddingHorizontal: 12,\n    paddingVertical: 6,\n    borderRadius: 12,\n    backgroundColor: colors.border,\n  },\n  optionBadgeActive: {\n    backgroundColor: 'rgba(93, 107, 74, 0.15)',\n  },\n  optionBadgeText: {\n    fontSize: 12,\n    fontWeight: '600' as const,\n    color: colors.muted,\n  },\n  optionBadgeTextActive: {\n    color: colors.primary,\n  },\n  modalOverlay: {\n    flex: 1,\n    backgroundColor: 'rgba(0,0,0,0.4)',\n    justifyContent: 'center',\n    alignItems: 'center',\n    padding: 20,\n  },\n  modalContainer: {\n    width: '100%',\n    maxHeight: '90%',\n    backgroundColor: '#fff',\n    borderRadius: 12,\n    overflow: 'hidden',\n  },\n  modalContent: {\n    padding: 20,\n  },\n  modalTitle: {\n    fontSize: 20,\n    fontWeight: '700' as const,\n    color: '#1f2937',\n    marginBottom: 12,\n  },\n  input: {\n    borderWidth: 1,\n    borderColor: '#e5e7eb',\n    backgroundColor: '#f9fafb',\n    paddingHorizontal: 12,\n    paddingVertical: 10,\n    borderRadius: 8,\n    marginTop: 8,\n  },\n  modalButton: {\n    flex: 1,\n    paddingVertical: 12,\n    paddingHorizontal: 16,\n    borderRadius: 10,\n    backgroundColor: '#e5e7eb',\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  modalButtonPrimary: {\n    backgroundColor: '#5d6b4a',\n    marginLeft: 8,\n  },\n  modalButtonText: {\n    fontSize: 16,\n    fontWeight: '600' as const,\n    color: '#1f2937',\n  },\n  recenterButton: {\n    position: 'absolute',\n    top: 60,\n    right: 20,\n    width: 48,\n    height: 48,\n    borderRadius: 24,\n  backgroundColor: '#ffffff',\n    alignItems: 'center',\n    justifyContent: 'center',\n    shadowColor: '#000',\n    shadowOffset: { width: 0, height: 2 },\n    shadowOpacity: 0.15,\n    shadowRadius: 8,\n    elevation: 4,\n  },\n});\n","\nimport React from 'react';\nimport { StyleSheet, View, FlatList, TouchableOpacity, ActivityIndicator, Text } from 'react-native';\nimport colors from '@/constants/colors';\nimport { useRouter } from 'expo-router';\nimport { MapPin, Clock } from 'lucide-react-native';\nimport { useTrails } from '@/context/TrailsContext';\nimport { Trail } from '@/types/trail';\nimport { formatDistance, formatDuration, formatDate } from '@/utils/distance';\n\nexport default function TrailsScreen() {\n  const router = useRouter();\n  const { trails, isLoading } = useTrails();\n\n  const renderTrailItem = ({ item }: { item: Trail }) => (\n    <TouchableOpacity\n      style={styles.trailItem}\n      onPress={() => router.push(`/trail/${item.id}` as any)}\n    >\n      <View style={styles.trailHeader}>\n        <View style={styles.iconContainer}>\n          <MapPin size={24} color={colors.primary} />\n        </View>\n        <View style={styles.trailInfo}>\n          <Text style={styles.trailDate}>{formatDate(item.date)}</Text>\n          <View style={styles.statsRow}>\n            <View style={styles.statItem}>\n              <MapPin size={16} color={colors.muted} />\n              <Text style={styles.statText}>{formatDistance(item.distance)}</Text>\n            </View>\n            <View style={styles.statItem}>\n              <Clock size={16} color={colors.muted} />\n              <Text style={styles.statText}>{formatDuration(item.duration)}</Text>\n            </View>\n          </View>\n        </View>\n      </View>\n    </TouchableOpacity>\n  );\n\n  const renderEmptyState = () => (\n    <View style={styles.emptyContainer}>\n      <MapPin size={64} color={colors.border} />\n      <Text style={styles.emptyTitle}>No trails yet</Text>\n      <Text style={styles.emptyText}>\n        Start recording your first dog walk to see it here!\n      </Text>\n    </View>\n  );\n\n  if (isLoading) {\n    return (\n      <View style={styles.loadingContainer}>\n        <ActivityIndicator size=\"large\" color=\"#2563eb\" />\n      </View>\n    );\n  }\n\n  return (\n    <View style={styles.container}>\n      <FlatList\n        data={trails}\n        renderItem={renderTrailItem}\n        keyExtractor={(item) => item.id}\n        contentContainerStyle={trails.length === 0 ? styles.emptyList : styles.list}\n        ListEmptyComponent={renderEmptyState}\n      />\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: colors.surface,\n  },\n  list: {\n    padding: 16,\n    gap: 12,\n  },\n  emptyList: {\n    flex: 1,\n  },\n  loadingContainer: {\n    flex: 1,\n    justifyContent: 'center',\n    alignItems: 'center',\n    backgroundColor: colors.surface,\n  },\n  trailItem: {\n    backgroundColor: colors.white,\n    borderRadius: 16,\n    padding: 16,\n    marginBottom: 12,\n  shadowColor: colors.black,\n    shadowOffset: { width: 0, height: 2 },\n    shadowOpacity: 0.05,\n    shadowRadius: 8,\n    elevation: 2,\n  },\n  trailHeader: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: 12,\n  },\n  iconContainer: {\n    width: 48,\n    height: 48,\n    borderRadius: 24,\n    backgroundColor: colors.surface,\n    justifyContent: 'center',\n    alignItems: 'center',\n  },\n  trailInfo: {\n    flex: 1,\n  },\n  trailDate: {\n    fontSize: 16,\n    fontWeight: '600' as const,\n    color: colors.darkGreen,\n    marginBottom: 6,\n  },\n  statsRow: {\n    flexDirection: 'row',\n    gap: 16,\n  },\n  statItem: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: 6,\n  },\n  statText: {\n    fontSize: 14,\n    color: colors.muted,\n    fontWeight: '500' as const,\n  },\n  emptyContainer: {\n    flex: 1,\n    justifyContent: 'center',\n    alignItems: 'center',\n    padding: 32,\n  },\n  emptyTitle: {\n    fontSize: 20,\n    fontWeight: '700' as const,\n    color: '#1f2937',\n    marginTop: 16,\n    marginBottom: 8,\n  },\n  emptyText: {\n    fontSize: 16,\n    color: colors.muted,\n    textAlign: 'center',\n    lineHeight: 24,\n  },\n});\n","import React, { useEffect, useState, useCallback, useMemo } from 'react';\nimport createContextHook from '@nkzw/create-context-hook';\nimport { useAuth } from '@/context/AuthContext';\nimport { API_URL } from '@/lib/api';\n\nexport interface UserProfile {\n  id: string;\n  user_id: string;\n  name: string | null;\n  photo: string | null;\n  created_at: string;\n  updated_at: string;\n}\n\nexport const [AccountContext, useAccount] = createContextHook(() => {\n  const { user, session } = useAuth();\n  const [userProfile, setUserProfile] = useState<UserProfile | null>(null);\n  const [isLoading, setIsLoading] = useState<boolean>(true);\n\n  const fetchAccount = useCallback(async () => {\n    if (!session?.accessToken) return;\n\n    setIsLoading(true);\n    try {\n      const response = await fetch(`${API_URL}/account/me`, {\n        headers: {\n          'Authorization': `Bearer ${session.accessToken}`,\n        },\n      });\n\n      if (response.ok) {\n        const data = await response.json();\n        setUserProfile(data);\n      } else {\n        console.error('Failed to fetch account:', response.status);\n        setUserProfile(null);\n      }\n    } catch (error) {\n      console.error('Error fetching account:', error);\n      setUserProfile(null);\n    } finally {\n      setIsLoading(false);\n    }\n  }, [session?.accessToken]);\n\n  const updateAccount = useCallback(async (updates: Partial<Pick<UserProfile, 'name' | 'photo'>>) => {\n    if (!session?.accessToken) throw new Error('No active session');\n\n    try {\n      const response = await fetch(`${API_URL}/account/me`, {\n        method: 'PUT',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${session.accessToken}`,\n        },\n        body: JSON.stringify(updates),\n      });\n\n      if (!response.ok) {\n        const errorData = await response.json();\n        throw new Error(errorData.detail?.[0]?.msg || 'Failed to update account');\n      }\n\n      const data = await response.json();\n      setUserProfile(data);\n      return data;\n    } catch (error) {\n      console.error('Error updating account:', error);\n      throw error;\n    }\n  }, [session?.accessToken]);\n\n  const deleteAccount = useCallback(async () => {\n    if (!session?.accessToken) throw new Error('No active session');\n\n    try {\n      const response = await fetch(`${API_URL}/account/me`, {\n        method: 'DELETE',\n        headers: {\n          'Authorization': `Bearer ${session.accessToken}`,\n        },\n      });\n\n      if (!response.ok) {\n        const errorData = await response.json();\n        throw new Error(errorData.detail?.[0]?.msg || 'Failed to delete account');\n      }\n\n      setUserProfile(null);\n      return true;\n    } catch (error) {\n      console.error('Error deleting account:', error);\n      throw error;\n    }\n  }, [session?.accessToken]);\n\n  useEffect(() => {\n    if (session?.accessToken) {\n      fetchAccount();\n    } else {\n      setUserProfile(null);\n      setIsLoading(false);\n    }\n  }, [session?.accessToken, fetchAccount]);\n\n  return useMemo(() => ({\n    userProfile,\n    isLoading,\n    refreshAccount: fetchAccount,\n    updateAccount,\n    deleteAccount,\n  }), [userProfile, isLoading, fetchAccount, updateAccount, deleteAccount]);\n});\n","import { StyleSheet } from 'react-native';\nimport colors from '@/constants/colors';\n\nexport default StyleSheet.create({\n  safeContainer: {\n    flex: 1,\n    backgroundColor: colors.background,\n  },\n  container: {\n    flex: 1,\n    backgroundColor: colors.background,\n  },\n\n  stickyHeader: {\n    backgroundColor: colors.background,\n    paddingBottom: 8,\n  },\n  stickySearchContainer: {\n    paddingHorizontal: 16,\n    paddingBottom: 8,\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: 8,\n  },\n\n  searchBar: {\n    flex: 1,\n    flexDirection: 'row',\n    alignItems: 'center',\n  backgroundColor: colors.surface,\n    paddingHorizontal: 16,\n    paddingVertical: 14,\n    borderRadius: 28,\n    gap: 12,\n    borderWidth: 1,\n    borderColor: colors.border,\n  },\n  demoButton: {\n    backgroundColor: colors.primary,\n    paddingHorizontal: 16,\n    paddingVertical: 12,\n    borderRadius: 24,\n  },\n  demoButtonText: {\n     color: colors.white,\n    fontWeight: 'bold',\n  },\n  searchPlaceholder: {\n    fontSize: 16,\n    color: colors.muted,\n    fontWeight: '400' as const,\n  },\n\n  largeTrailCard: {\n  backgroundColor: colors.white,\n    borderRadius: 24,\n    overflow: 'hidden',\n    marginBottom: 20,\n  shadowColor: '#000',\n    shadowOffset: { width: 0, height: 4 },\n    shadowOpacity: 0.1,\n    shadowRadius: 16,\n    elevation: 4,\n    position: 'relative',\n  },\n  largeTrailImage: {\n    width: '100%',\n    height: 260,\n    backgroundColor: colors.surface,\n  },\n  bookmarkButton: {\n    position: 'absolute',\n    top: 20,\n    right: 20,\n    width: 44,\n    height: 44,\n    borderRadius: 22,\n    backgroundColor: 'rgba(255, 255, 255, 0.95)',\n    justifyContent: 'center',\n    alignItems: 'center',\n  shadowColor: colors.black,\n    shadowOffset: { width: 0, height: 2 },\n    shadowOpacity: 0.1,\n    shadowRadius: 8,\n    elevation: 4,\n  },\n  cardGradient: {\n    position: 'absolute',\n    top: 0,\n    bottom: 0,\n    left: 0,\n    right: 0,\n  },\n  cardOverlayContent: {\n    position: 'absolute',\n    bottom: 0,\n    left: 0,\n    right: 0,\n    padding: 18,\n    paddingBottom: 20,\n  },\n  overlayTrailName: {\n    fontSize: 28,\n    fontWeight: '700' as const,\n  color: colors.white,\n    marginBottom: 6,\n    lineHeight: 34,\n    textShadowColor: 'rgba(0, 0, 0, 0.3)',\n    textShadowOffset: { width: 0, height: 1 },\n    textShadowRadius: 4,\n  },\n  overlayLocation: {\n    fontSize: 16,\n  color: colors.white,\n    marginBottom: 16,\n    opacity: 0.95,\n    textShadowColor: 'rgba(0, 0, 0, 0.3)',\n    textShadowOffset: { width: 0, height: 1 },\n    textShadowRadius: 4,\n  },\n  overlayBadges: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: 12,\n    flexWrap: 'wrap' as const,\n  },\n  badge: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    backgroundColor: 'rgba(40, 40, 40, 0.8)',\n    paddingHorizontal: 14,\n    paddingVertical: 8,\n    borderRadius: 20,\n    gap: 6,\n  },\n  badgeText: {\n    fontSize: 14,\n    fontWeight: '600' as const,\n    color: '#fff',\n    textTransform: 'capitalize' as const,\n  },\n  categoriesSection: {\n    backgroundColor: colors.background,\n    paddingTop: 8,\n    paddingBottom: 16,\n  },\n  categoriesScroll: {\n    paddingHorizontal: 16,\n    gap: 12,\n  },\n  categoryButton: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    paddingHorizontal: 24,\n    paddingVertical: 14,\n    borderRadius: 28,\n  backgroundColor: colors.white,\n    borderWidth: 0,\n    gap: 8,\n  },\n  categoryButtonActive: {\n    backgroundColor: colors.primary,\n  },\n  categoryText: {\n    fontSize: 16,\n    fontWeight: '500' as const,\n    color: colors.muted,\n  },\n  categoryTextActive: {\n  color: colors.white,\n  },\n  categoryTrailsSection: {\n    paddingHorizontal: 16,\n    paddingTop: 16,\n  },\n  bottomPadding: {\n    height: 40,\n  },\n  loadingContainer: {\n    paddingVertical: 60,\n    alignItems: 'center',\n    gap: 16,\n  },\n  loadingText: {\n    fontSize: 14,\n    color: colors.muted,\n  },\n  emptyContainer: {\n    paddingVertical: 60,\n    alignItems: 'center',\n    gap: 16,\n    paddingHorizontal: 32,\n  },\n  emptyText: {\n    fontSize: 16,\n    color: colors.muted,\n    textAlign: 'center',\n    lineHeight: 24,\n  },\n  placeholderImage: {\n    justifyContent: 'center',\n    alignItems: 'center',\n    backgroundColor: colors.darkGreen,\n  },\n  searchModalContainer: {\n    flex: 1,\n    backgroundColor: colors.background,\n  },\n  searchModalHeader: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    paddingHorizontal: 16,\n    paddingTop: 12,\n    paddingBottom: 16,\n    gap: 12,\n    borderBottomWidth: 1,\n    borderBottomColor: colors.border,\n  },\n  backButton: {\n    width: 40,\n    height: 40,\n    borderRadius: 20,\n    backgroundColor: colors.paleYellow,\n    justifyContent: 'center',\n    alignItems: 'center',\n  },\n  searchModalInputContainer: {\n    flex: 1,\n    flexDirection: 'row',\n    alignItems: 'center',\n    backgroundColor: colors.white,\n    borderRadius: 28,\n    paddingHorizontal: 16,\n    paddingVertical: 12,\n    borderWidth: 1,\n    borderColor: colors.muted,\n    gap: 12,\n  },\n  searchModalInput: {\n    flex: 1,\n    fontSize: 16,\n    color: colors.darkGreen,\n    padding: 0,\n    fontWeight: '400' as const,\n  },\n  clearButton: {\n    width: 24,\n    height: 24,\n    borderRadius: 12,\n    backgroundColor: colors.border,\n    justifyContent: 'center',\n    alignItems: 'center',\n  },\n  searchModalContent: {\n    flex: 1,\n    paddingTop: 12,\n  },\n  currentLocationItem: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    paddingHorizontal: 20,\n    paddingVertical: 16,\n    gap: 16,\n    backgroundColor: colors.surface,\n    borderRadius: 16,\n    marginHorizontal: 16,\n    marginBottom: 12,\n  },\n  locationIconContainer: {\n    width: 48,\n    height: 48,\n    borderRadius: 24,\n    backgroundColor: colors.paleYellow,\n    justifyContent: 'center',\n    alignItems: 'center',\n  },\n  locationTextContainer: {\n    flex: 1,\n  },\n  locationTitle: {\n    fontSize: 17,\n    fontWeight: '600' as const,\n    color: colors.darkGreen,\n    marginBottom: 4,\n  },\n  locationSubtitle: {\n    fontSize: 14,\n    color: colors.muted,\n    fontWeight: '400' as const,\n  },\n  suggestionItem: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    paddingHorizontal: 20,\n    paddingVertical: 16,\n    gap: 16,\n    backgroundColor: colors.surface,\n    borderRadius: 16,\n    marginHorizontal: 16,\n    marginBottom: 12,\n  },\n  suggestionIconContainer: {\n    width: 48,\n    height: 48,\n    borderRadius: 24,\n    backgroundColor: colors.border,\n    justifyContent: 'center',\n    alignItems: 'center',\n  },\n  suggestionTextContainer: {\n    flex: 1,\n  },\n  suggestionTitle: {\n    fontSize: 17,\n    fontWeight: '600' as const,\n    color: colors.darkGreen,\n    marginBottom: 4,\n  },\n  suggestionSubtitle: {\n    fontSize: 14,\n    color: colors.muted,\n    fontWeight: '400' as const,\n  },\n});\n","import React, { useEffect, useState, useCallback, useMemo } from 'react';\nimport createContextHook from '@nkzw/create-context-hook';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport { API_URL } from '@/lib/api';\n\nexport interface User {\n  id: string;\n  email: string;\n  name: string;\n}\n\nexport interface Session {\n  user: User;\n  accessToken: string;\n  tokenType: string;\n}\n\nexport const [AuthContext, useAuth] = createContextHook(() => {\n  const [session, setSession] = useState<Session | null>(null);\n  const [user, setUser] = useState<User | null>(null);\n  const [isLoading, setIsLoading] = useState<boolean>(true);\n\n  useEffect(() => {\n    const loadSession = async () => {\n      try {\n        const savedSession = await AsyncStorage.getItem('session');\n        if (savedSession) {\n          const parsedSession = JSON.parse(savedSession);\n          setSession(parsedSession);\n          setUser(parsedSession.user);\n        }\n      } catch (error) {\n        console.error('Error loading session:', error);\n      } finally {\n        setIsLoading(false);\n      }\n    };\n\n    loadSession();\n  }, []);\n\n  const requestOtp = useCallback(async (email: string) => {\n    console.log('Requesting OTP for:', email);\n    const response = await fetch(`${API_URL}/otp/request`, {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({ email }),\n    });\n\n    if (!response.ok) {\n      const errorData = await response.json();\n      throw new Error(errorData.detail?.[0]?.msg || 'Failed to request OTP');\n    }\n\n    return true;\n  }, []);\n\n  const verifyOtp = useCallback(async (email: string, otpCode: string) => {\n    console.log('Verifying OTP for:', email);\n    const response = await fetch(`${API_URL}/otp/verify`, {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({ email, otpCode }),\n    });\n\n    if (!response.ok) {\n      const errorData = await response.json();\n      throw new Error(errorData.detail?.[0]?.msg || 'Invalid OTP code');\n    }\n\n    const data: Session = await response.json();\n    setSession(data);\n    setUser(data.user);\n    await AsyncStorage.setItem('session', JSON.stringify(data));\n    \n    return data;\n  }, []);\n\n  const requestRegistration = useCallback(async (email: string, name: string) => {\n    console.log('Requesting registration for:', email);\n    const response = await fetch(`${API_URL}/otp/register-request`, {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({ email, name }),\n    });\n\n    if (!response.ok) {\n      const errorData = await response.json();\n      throw new Error(errorData.detail?.[0]?.msg || 'Failed to request registration');\n    }\n\n    return true;\n  }, []);\n\n  const verifyRegistration = useCallback(async (email: string, otpCode: string) => {\n    console.log('Verifying registration for:', email);\n    const response = await fetch(`${API_URL}/otp/register-verify`, {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({ email, otpCode }),\n    });\n\n    if (!response.ok) {\n      const errorData = await response.json();\n      throw new Error(errorData.detail?.[0]?.msg || 'Invalid OTP code');\n    }\n\n    const data: Session = await response.json();\n    setSession(data);\n    setUser(data.user);\n    await AsyncStorage.setItem('session', JSON.stringify(data));\n    \n    return data;\n  }, []);\n\n  const signInWithToken = useCallback(async (tokenResponse: { accessToken: string; tokenType?: string; user?: User }) => {\n    // Accept token response from webauthn auth verify endpoint and persist session\n    const sessionObj: Session = {\n      accessToken: tokenResponse.accessToken,\n      tokenType: tokenResponse.tokenType || 'bearer',\n      user: (tokenResponse.user as User) || (user as User),\n    } as Session;\n    setSession(sessionObj);\n    setUser(sessionObj.user);\n    await AsyncStorage.setItem('session', JSON.stringify(sessionObj));\n    return sessionObj;\n  }, [user]);\n\n  const signOut = useCallback(async () => {\n    console.log('Signing out user');\n    setSession(null);\n    setUser(null);\n    await AsyncStorage.removeItem('session');\n  }, []);\n\n  return useMemo(() => ({\n    session,\n    user,\n    isLoading,\n    requestOtp,\n    verifyOtp,\n    requestRegistration,\n    verifyRegistration,\n    signInWithToken,\n    signOut,\n    isAuthenticated: !!session,\n  }), [session, user, isLoading, requestOtp, verifyOtp, requestRegistration, verifyRegistration, signOut]);\n});\n\n","import { useEffect, useRef, useState } from 'react';\nimport { \n  View,\n  StyleSheet,\n  ActivityIndicator,\n  Platform,\n  TouchableOpacity,\n  TextInput,\n  Alert,\n  Linking,\n  Animated,\n  Text,\n} from 'react-native';\n\nimport { router, useLocalSearchParams } from 'expo-router';\nimport { Image } from 'expo-image';\nimport TrailMap from '@/components/TrailMap';\nimport { Clock, MapPin, Calendar, Edit3, Check, X, Navigation, TrendingUp, Tag, Camera, Activity, Star, ArrowLeft, Share2, Bookmark, MoreVertical } from 'lucide-react-native';\nimport * as ImagePicker from 'expo-image-picker';\nimport * as Haptics from 'expo-haptics';\nimport { LinearGradient } from 'expo-linear-gradient';\nimport { useTrails } from '@/context/TrailsContext';\nimport { useAuth } from '@/context/AuthContext';\nimport { Trail } from '@/types/trail';\n\nimport { formatDistance, formatDuration } from '@/utils/distance';\nimport colors from '@/constants/colors';\nimport { useSafeAreaInsets } from 'react-native-safe-area-context';\nimport styles from './[id].styles';\n\nconst ENVIRONMENT_TAG_OPTIONS = [\n  'Forest', 'Urban', 'Beach', 'Mountain', 'Rural', 'Park',\n  'Shaded', 'Sunny', 'Crowded', 'Quiet', 'Paved', 'Trail'\n];\n\nconst DIFFICULTY_OPTIONS = ['Easy', 'Moderate', 'Hard'];\n\nexport default function TrailDetailScreen() {\n  const { id } = useLocalSearchParams();\n  const { user } = useAuth();\n  const { getTrailById, updateTrailName, updateTrailPhoto, updateTrailDetails, getTrailWithUser } = useTrails();\n  const [trail, setTrail] = useState<Trail | undefined>(undefined);\n  const [isLoading, setIsLoading] = useState<boolean>(true);\n  const [isEditingName, setIsEditingName] = useState(false);\n  const [editedName, setEditedName] = useState('');\n  const [isEditingDetails, setIsEditingDetails] = useState(false);\n  const [editedRating, setEditedRating] = useState<number>(0);\n  const [editedReview, setEditedReview] = useState('');\n  const [editedTags, setEditedTags] = useState<string[]>([]);\n  const [editedDifficulty, setEditedDifficulty] = useState<string>('');\n  const [editedNameInDetails, setEditedNameInDetails] = useState('');\n  const [isUploadingPhoto, setIsUploadingPhoto] = useState(false);\n  const fileInputRef = useRef<HTMLInputElement | null>(null);\n  const scrollY = useRef(new Animated.Value(0)).current;\n  const insets = useSafeAreaInsets();\n  // Helper to render native icons on mobile and an emoji fallback on web where some icon libs\n  // can produce text nodes that raise \"Text strings must be rendered within a <Text> component\".\n  const IconOrEmoji = ({ IconComponent, emoji, size = 18, color }: { IconComponent: any; emoji?: string; size?: number; color?: string }) => {\n    if (Platform.OS === 'web') {\n      // Use ThemedText so the emoji/text is correctly wrapped in a <Text> component on web\n      return <Text style={{ fontSize: size, color: color || undefined }}>{emoji || ''}</Text>;\n    }\n    const Icon = IconComponent;\n    return <Icon size={size} color={color} />;\n  };\n  const [isSaved, setIsSaved] = useState(false);\n\n  useEffect(() => {\n    loadTrail();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [id]);\n\n  const loadTrail = async () => {\n    if (typeof id !== 'string') {\n      setIsLoading(false);\n      return;\n    }\n\n    setIsLoading(true);\n    try {\n      const foundTrail = getTrailById(id);\n      if (foundTrail) {\n        setTrail(foundTrail);\n        setEditedName(foundTrail.name || '');\n        setEditedRating(foundTrail.rating || 0);\n        setEditedReview(foundTrail.review || '');\n        setEditedTags(foundTrail.environment_tags || []);\n        setEditedDifficulty(foundTrail.difficulty || '');\n        setEditedNameInDetails(foundTrail.name || '');\n      } else {\n        const loadedTrail = await getTrailWithUser(id);\n        if (loadedTrail) {\n          setTrail(loadedTrail);\n          setEditedName(loadedTrail.name || '');\n          setEditedRating(loadedTrail.rating || 0);\n          setEditedReview(loadedTrail.review || '');\n          setEditedTags(loadedTrail.environment_tags || []);\n          setEditedDifficulty(loadedTrail.difficulty || '');\n          setEditedNameInDetails(loadedTrail.name || '');\n        }\n      }\n    } catch (error) {\n      console.error('Error loading trail:', error);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleSaveName = async () => {\n    if (!trail || !editedName.trim()) {\n      setIsEditingName(false);\n      return;\n    }\n\n    try {\n      await updateTrailName(trail.id, editedName.trim());\n      setTrail({ ...trail, name: editedName.trim() });\n      setIsEditingName(false);\n    } catch {\n      Alert.alert('Error', 'Failed to update trail name. Please try again.');\n    }\n  };\n\n  const handleSaveDetails = async () => {\n    if (!trail) return;\n\n    try {\n      if (editedNameInDetails.trim() !== trail.name) {\n        await updateTrailName(trail.id, editedNameInDetails.trim());\n      }\n      await updateTrailDetails(trail.id, {\n        rating: editedRating > 0 ? editedRating : undefined,\n        review: editedReview.trim() || undefined,\n        environment_tags: editedTags.length > 0 ? editedTags : undefined,\n        difficulty: editedDifficulty || undefined,\n      });\n      setTrail({\n        ...trail,\n        name: editedNameInDetails.trim(),\n        rating: editedRating > 0 ? editedRating : undefined,\n        review: editedReview.trim() || undefined,\n        environment_tags: editedTags.length > 0 ? editedTags : undefined,\n        difficulty: editedDifficulty || undefined,\n      });\n      setEditedName(editedNameInDetails.trim());\n      setIsEditingDetails(false);\n      Alert.alert('Success', 'Trail details updated!');\n    } catch {\n      Alert.alert('Error', 'Failed to update trail details. Please try again.');\n    }\n  };\n\n  const handleGetDirections = () => {\n    if (Platform.OS !== 'web') {\n      Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Medium);\n    }\n\n    if (!trail || (trail.coordinates?.length ?? 0) === 0) {\n      Alert.alert('Error', 'Location not available for this trail');\n      return;\n    }\n\n    const latitude = trail.coordinates[0].latitude;\n    const longitude = trail.coordinates[0].longitude;\n    const label = trail.name || 'Trail Location';\n\n    const scheme = Platform.select({\n      ios: 'maps:',\n      android: 'geo:',\n      default: 'https://www.google.com/maps',\n    });\n\n    const url = Platform.select({\n      ios: `${scheme}?q=${label}&ll=${latitude},${longitude}`,\n      android: `${scheme}${latitude},${longitude}?q=${label}`,\n      default: `${scheme}/search/?api=1&query=${latitude},${longitude}`,\n    });\n\n    Linking.canOpenURL(url as string).then((supported) => {\n      if (supported) {\n        Linking.openURL(url as string);\n      } else {\n        Alert.alert('Error', 'Unable to open maps application');\n      }\n    });\n  };\n\n  const handleCancelEdit = () => {\n    setEditedName(trail?.name || '');\n    setIsEditingName(false);\n  };\n\n  const handleCancelDetailsEdit = () => {\n    setEditedRating(trail?.rating || 0);\n    setEditedReview(trail?.review || '');\n    setEditedTags(trail?.environment_tags || []);\n    setEditedDifficulty(trail?.difficulty || '');\n    setEditedNameInDetails(trail?.name || '');\n    setIsEditingDetails(false);\n  };\n\n  const toggleTag = (tag: string) => {\n    if (Platform.OS !== 'web') {\n      Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Light);\n    }\n    setEditedTags((prev) =>\n      prev.includes(tag) ? prev.filter((t) => t !== tag) : [...prev, tag]\n    );\n  };\n\n  const pickImageWeb = () => {\n    if (Platform.OS === 'web' && fileInputRef.current) {\n      fileInputRef.current.click();\n    }\n  };\n\n  const handleWebFileChange = async (event: any) => {\n    const file = event.target.files?.[0];\n    if (!file || !trail) return;\n\n    if (!file.type.startsWith('image/')) {\n      Alert.alert('Error', 'Please select an image file');\n      return;\n    }\n\n    setIsUploadingPhoto(true);\n    try {\n      const reader = new FileReader();\n      reader.onload = async (e) => {\n        const base64 = e.target?.result as string;\n        await updateTrailPhoto(trail.id, base64);\n        setTrail({ ...trail, photo: base64 });\n        Alert.alert('Success', 'Photo uploaded successfully!');\n        setIsUploadingPhoto(false);\n      };\n      reader.onerror = () => {\n        Alert.alert('Error', 'Failed to read image');\n        setIsUploadingPhoto(false);\n      };\n      reader.readAsDataURL(file);\n    } catch (error) {\n      console.error('Photo upload error:', error);\n      Alert.alert('Error', 'Failed to upload photo');\n      setIsUploadingPhoto(false);\n    }\n  };\n\n  const pickImageMobile = async () => {\n    if (!trail) return;\n\n    try {\n      const permissionResult = await ImagePicker.requestMediaLibraryPermissionsAsync();\n      \n      if (!permissionResult.granted) {\n        Alert.alert('Permission Required', 'Please allow access to your photo library');\n        return;\n      }\n\n      const result = await ImagePicker.launchImageLibraryAsync({\n        mediaTypes: ['images'],\n        allowsEditing: true,\n        aspect: [16, 9],\n        quality: 0.8,\n        base64: true,\n      });\n\n      if (!result.canceled && result.assets[0]) {\n        setIsUploadingPhoto(true);\n        const base64Image = `data:image/jpeg;base64,${result.assets[0].base64}`;\n        await updateTrailPhoto(trail.id, base64Image);\n        setTrail({ ...trail, photo: base64Image });\n        Alert.alert('Success', 'Photo uploaded successfully!');\n        setIsUploadingPhoto(false);\n      }\n    } catch (error) {\n      console.error('Photo upload error:', error);\n      Alert.alert('Error', 'Failed to upload photo');\n      setIsUploadingPhoto(false);\n    }\n  };\n\n  const handlePickImage = () => {\n    if (Platform.OS !== 'web') {\n      Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Light);\n    }\n    if (Platform.OS === 'web') {\n      pickImageWeb();\n    } else {\n      pickImageMobile();\n    }\n  };\n\n  const handleBack = () => {\n    if (Platform.OS !== 'web') {\n      Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Light);\n    }\n    router.back();\n  };\n\n  const handleShare = () => {\n    if (Platform.OS !== 'web') {\n      Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Light);\n    }\n    Alert.alert('Share', 'Share functionality coming soon!');\n  };\n\n  const handleSave = () => {\n    if (Platform.OS !== 'web') {\n      Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Light);\n    }\n    setIsSaved(!isSaved);\n  };\n\n  const handleMore = () => {\n    if (Platform.OS !== 'web') {\n      Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Light);\n    }\n    Alert.alert('Options', 'Mark as completed option coming soon!');\n  };\n\n  if (isLoading) {\n    return (\n      <View style={styles.loadingContainer}>\n        <ActivityIndicator size=\"large\" color={colors.primary} />\n        <Text style={styles.loadingText}>Loading trail...</Text>\n      </View>\n    );\n  }\n\n  if (!trail) {\n    return (\n      <View style={styles.loadingContainer}>\n        <MapPin size={64} color=\"#9ca3af\" />\n        <Text style={styles.loadingText}>Trail not found</Text>\n      </View>\n    );\n  }\n\n  const coords = trail.coordinates ?? [];\n\n  const region = coords.length > 0 ? {\n    latitude: coords[0].latitude,\n    longitude: coords[0].longitude,\n    latitudeDelta: 0.01,\n    longitudeDelta: 0.01,\n  } : undefined;\n\n  const canEdit = trail.user_id === user?.id;\n\n  return (\n    <View style={[\n      styles.container,\n      { paddingTop: insets.top + 70, paddingBottom: Math.max(16, insets.bottom), paddingHorizontal: 16 + (insets.left || 0) },\n    ]}>\n      {Platform.OS === 'web' && (\n        <input\n          ref={fileInputRef as any}\n          type=\"file\"\n          accept=\"image/*\"\n          style={{ display: 'none' }}\n          onChange={handleWebFileChange}\n        />\n      )}\n\n      <View style={[styles.headerButtons, { top: insets.top + 12 }]}>\n        <TouchableOpacity style={styles.headerButton} onPress={handleBack}>\n         <ArrowLeft size={24} />\n        </TouchableOpacity>\n        <View style={styles.headerRightButtons}>\n          <TouchableOpacity style={styles.headerButton} onPress={handleShare}>\n          <Share2 size={22} />\n          </TouchableOpacity>\n          <TouchableOpacity style={styles.headerButton} onPress={handleSave}>\n          <Bookmark size={22} fill={isSaved ? colors.darkGreen : 'none'} />\n          </TouchableOpacity>\n          <TouchableOpacity style={styles.headerButton} onPress={handleMore}>\n          <MoreVertical size={22} />\n          </TouchableOpacity>\n        </View>\n      </View>\n\n      <Animated.ScrollView \n        style={styles.scrollContainer}\n        contentContainerStyle={styles.scrollContent}\n        onScroll={Animated.event(\n          [{ nativeEvent: { contentOffset: { y: scrollY } } }],\n          { useNativeDriver: false }\n        )}\n        scrollEventThrottle={16}\n      >\n        <View style={styles.heroSection}>\n          {trail.photo ? (\n            <View style={styles.heroImageContainer}>\n              <Image\n                source={{ uri: trail.photo }}\n                style={styles.heroImage}\n                contentFit=\"cover\"\n                cachePolicy=\"memory-disk\"\n              />\n              <LinearGradient\n                colors={['rgba(0,0,0,0)', 'rgba(0,0,0,0.3)']}\n                style={styles.heroGradient}\n              />\n              {canEdit && (\n                <TouchableOpacity\n                  style={styles.changePhotoFab}\n                  onPress={handlePickImage}\n                  disabled={isUploadingPhoto}\n                >\n                  {isUploadingPhoto ? (\n                    <ActivityIndicator color={colors.white} size=\"small\" />\n                  ) : (\n                    <Camera size={20} color={colors.white} />\n                  )}\n                </TouchableOpacity>\n              )}\n            </View>\n          ) : canEdit && (\n            <TouchableOpacity\n              style={styles.addPhotoContainer}\n              onPress={handlePickImage}\n              disabled={isUploadingPhoto}\n            >\n              {isUploadingPhoto ? (\n                <ActivityIndicator size=\"large\" color={colors.primary} />\n              ) : (\n                <>\n                  <View style={styles.addPhotoIcon}>\n                    <Camera size={32} color={colors.primary} />\n                  </View>\n                  <Text style={styles.addPhotoText}>Add a photo</Text>\n                  <Text style={styles.addPhotoSubtext}>Make your trail memorable</Text>\n                </>\n              )}\n            </TouchableOpacity>\n          )}\n\n\n        </View>\n\n        <View style={styles.contentWrapper}>\n          <View style={styles.content}>\n          <View style={styles.titleSection}>\n            {canEdit && isEditingName ? (\n              <View style={styles.nameEditContainer}>\n                <TextInput\n                  style={styles.nameInput}\n                  value={editedName}\n                  onChangeText={setEditedName}\n                  placeholder=\"Enter trail name\"\n                  autoFocus\n                  placeholderTextColor=\"#9ca3af\"\n                />\n                <View style={styles.editButtons}>\n                  <TouchableOpacity\n                    style={[styles.iconButton, styles.saveIconButton]}\n                    onPress={handleSaveName}\n                  >\n                    <Check size={18} color=\"#fff\" />\n                  </TouchableOpacity>\n                  <TouchableOpacity\n                    style={[styles.iconButton, styles.cancelIconButton]}\n                    onPress={handleCancelEdit}\n                  >\n                    <X size={18} color={colors.darkGreen} />\n                  </TouchableOpacity>\n                </View>\n              </View>\n            ) : (\n              <View style={styles.titleRow}>\n                <Text style={styles.title}>{trail.name || `Trail ${new Date(trail.date).toLocaleDateString()}`}</Text>\n              </View>\n            )}\n            \n            {trail.city && (\n              <View style={styles.locationRow}>\n                <MapPin size={16} color={colors.lightGreen} />\n                <Text style={styles.location}>{trail.city}, {trail.country || 'Unknown'}</Text>\n              </View>\n            )}\n\n            {trail.rating && !isEditingDetails && (\n              <View style={styles.ratingRow}>\n                {[1, 2, 3, 4, 5].map((star) => (\n                  <Star\n                    key={star}\n                    size={18}\n                    color={star <= trail.rating! ? '#f59e0b' : '#d1d5db'}\n                    fill={star <= trail.rating! ? '#f59e0b' : 'none'}\n                  />\n                ))}\n              </View>\n            )}\n          </View>\n\n          {trail.review && !isEditingDetails && (\n            <View style={styles.reviewCard}>\n              <Text style={styles.reviewText}>{trail.review}</Text>\n            </View>\n          )}\n\n          <View style={styles.statsSection}>\n            <View style={styles.statCard}>\n                <View style={styles.statIconContainer}>\n                <MapPin size={20} color={colors.white} strokeWidth={2.5} />\n              </View>\n              <Text style={styles.statLabel}>Distance</Text>\n              <Text style={styles.statValue}>{formatDistance(trail.distance)}</Text>\n            </View>\n\n            <View style={styles.statCard}>\n                <View style={styles.statIconContainer}>\n                <Clock size={20} color={colors.white} strokeWidth={2.5} />\n              </View>\n              <Text style={styles.statLabel}>Duration</Text>\n              <Text style={styles.statValue}>{formatDuration(trail.duration)}</Text>\n            </View>\n\n            {trail.difficulty && (\n              <View style={styles.statCard}>\n                <View style={styles.statIconContainer}>\n                  <IconOrEmoji IconComponent={TrendingUp} emoji=\"\" size={20} color={colors.white} />\n                </View>\n                <Text style={styles.statLabel}>Difficulty</Text>\n                <Text style={styles.statValue}>{trail.difficulty}</Text>\n              </View>\n            )}\n          </View>\n\n          {trail.environment_tags && trail.environment_tags.length > 0 && !isEditingDetails && (\n            <View style={styles.tagsSection}>\n              <View style={styles.sectionHeader}>\n                <IconOrEmoji IconComponent={Tag} emoji=\"\" size={18} color={colors.darkGreen} />\n                <Text style={styles.sectionTitle}>Environment</Text>\n              </View>\n              <View style={styles.tagsGrid}>\n                {trail.environment_tags.map((tag: string, index: number) => (\n                  <View key={index} style={styles.tagChip}>\n                    <Text style={styles.tagText}>{tag}</Text>\n                  </View>\n                ))}\n              </View>\n            </View>\n          )}\n\n          {canEdit && !isEditingDetails && (\n            <TouchableOpacity\n              style={styles.editDetailsButton}\n              onPress={() => {\n                if (Platform.OS !== 'web') {\n                  Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Light);\n                }\n                setIsEditingDetails(true);\n              }}\n            >\n              <Edit3 size={18} color={colors.primary} />\n              <Text style={styles.editDetailsText}>Edit Trail Details</Text>\n            </TouchableOpacity>\n          )}\n\n          {canEdit && isEditingDetails && (\n            <View style={styles.editSection}>\n              <Text style={styles.editSectionTitle}>Trail Name</Text>\n              <TextInput\n                style={styles.nameInputInDetails}\n                value={editedNameInDetails}\n                onChangeText={setEditedNameInDetails}\n                placeholder=\"Enter trail name\"\n                placeholderTextColor=\"#9ca3af\"\n              />\n\n              <Text style={[styles.editSectionTitle, { marginTop: 24 }]}>Rating</Text>\n              <View style={styles.ratingStars}>\n                {[1, 2, 3, 4, 5].map((star) => (\n                  <TouchableOpacity\n                    key={star}\n                    onPress={() => {\n                      if (Platform.OS !== 'web') {\n                        Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Light);\n                      }\n                      setEditedRating(star);\n                    }}\n                    style={styles.starButton}\n                  >\n                    <Star\n                      size={32}\n                      color={star <= editedRating ? '#f59e0b' : '#d1d5db'}\n                      fill={star <= editedRating ? '#f59e0b' : 'none'}\n                    />\n                  </TouchableOpacity>\n                ))}\n              </View>\n\n              <Text style={[styles.editSectionTitle, { marginTop: 24 }]}>Review</Text>\n              <TextInput\n                style={styles.reviewInput}\n                value={editedReview}\n                onChangeText={setEditedReview}\n                placeholder=\"Share your experience on this trail...\"\n                placeholderTextColor=\"#9ca3af\"\n                multiline\n                numberOfLines={4}\n                textAlignVertical=\"top\"\n              />\n\n              <Text style={[styles.editSectionTitle, { marginTop: 24 }]}>Difficulty</Text>\n              <View style={styles.difficultyOptions}>\n                {DIFFICULTY_OPTIONS.map((difficulty) => (\n                  <TouchableOpacity\n                    key={difficulty}\n                    style={[\n                      styles.difficultyChip,\n                      editedDifficulty === difficulty && styles.difficultyChipSelected,\n                    ]}\n                    onPress={() => {\n                      if (Platform.OS !== 'web') {\n                        Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Light);\n                      }\n                      setEditedDifficulty(difficulty);\n                    }}\n                  >\n                    <Text\n                      style={[\n                        styles.difficultyChipText,\n                        editedDifficulty === difficulty && styles.difficultyChipTextSelected,\n                      ]}\n                    >\n                      {difficulty}\n                    </Text>\n                  </TouchableOpacity>\n                ))}\n              </View>\n\n              <Text style={[styles.editSectionTitle, { marginTop: 24 }]}>Environment Tags</Text>\n              <View style={styles.tagsGrid}>\n                {ENVIRONMENT_TAG_OPTIONS.map((tag) => (\n                  <TouchableOpacity\n                    key={tag}\n                    style={[\n                      styles.editTagChip,\n                      editedTags.includes(tag) && styles.editTagChipSelected,\n                    ]}\n                    onPress={() => toggleTag(tag)}\n                  >\n                    <Text\n                      style={[\n                        styles.editTagChipText,\n                        editedTags.includes(tag) && styles.editTagChipTextSelected,\n                      ]}\n                    >\n                      {tag}\n                    </Text>\n                  </TouchableOpacity>\n                ))}\n              </View>\n\n              <View style={styles.editActionButtons}>\n                <TouchableOpacity\n                  style={[styles.actionButton, styles.cancelActionButton]}\n                  onPress={handleCancelDetailsEdit}\n                >\n                  <X size={20} color={colors.darkGreen} />\n                  <Text style={styles.cancelActionText}>Cancel</Text>\n                </TouchableOpacity>\n                <TouchableOpacity\n                  style={[styles.actionButton, styles.saveActionButton]}\n                  onPress={handleSaveDetails}\n                >\n                  <Check size={20} color=\"#fff\" />\n                  <Text style={styles.saveActionText}>Save</Text>\n                </TouchableOpacity>\n              </View>\n            </View>\n          )}\n\n            <View style={styles.mapSection}>\n            <View style={styles.sectionHeader}>\n              <IconOrEmoji IconComponent={Navigation} emoji=\"\" size={18} color={colors.darkGreen} />\n              <Text style={styles.sectionTitle}>Route Map</Text>\n            </View>\n            <View style={styles.mapContainer}>\n              <TrailMap\n                coordinates={coords}\n                style={styles.map}\n                initialRegion={region || undefined}\n                scrollEnabled={false}\n                zoomEnabled={false}\n              />\n            </View>\n            <TouchableOpacity style={styles.directionsButton} onPress={handleGetDirections}>\n              <Navigation size={18} color=\"#fff\" />\n              <Text style={styles.directionsButtonText}>Get Directions</Text>\n            </TouchableOpacity>\n          </View>\n\n          <View>\n            <Text style={styles.detailsTitle}>Additional Details</Text>\n            \n            {trail.maxElevation !== undefined && (\n              <View style={styles.detailRow}>\n                <View style={styles.detailIcon}>\n                    <IconOrEmoji IconComponent={TrendingUp} emoji=\"\" size={18} color={colors.primary} />\n                  </View>\n                <View style={styles.detailContent}>\n                  <Text style={styles.detailLabel}>Elevation Gain</Text>\n                  <Text style={styles.detailValue}>{trail.maxElevation}m</Text>\n                </View>\n              </View>\n            )}\n\n            {trail.pace && (\n              <View style={styles.detailRow}>\n                <View style={styles.detailIcon}>\n                  <IconOrEmoji IconComponent={Activity} emoji=\"\" size={18} color={colors.primary} />\n                </View>\n                <View style={styles.detailContent}>\n                  <Text style={styles.detailLabel}>Pace</Text>\n                  <Text style={styles.detailValue}>{trail.pace} /km</Text>\n                </View>\n              </View>\n            )}\n\n            {trail.speed && (\n              <View style={styles.detailRow}>\n                <View style={styles.detailIcon}>\n                  <IconOrEmoji IconComponent={Activity} emoji=\"\" size={18} color={colors.primary} />\n                </View>\n                <View style={styles.detailContent}>\n                  <Text style={styles.detailLabel}>Max Speed</Text>\n                  <Text style={styles.detailValue}>{trail.speed.toFixed(1)} km/h</Text>\n                </View>\n              </View>\n            )}\n\n            <View style={styles.detailRow}>\n              <View style={styles.detailIcon}>\n                <IconOrEmoji IconComponent={Calendar} emoji=\"\" size={18} color={colors.primary} />\n              </View>\n              <View style={styles.detailContent}>\n                <Text style={styles.detailLabel}>Date & Time</Text>\n                <Text style={styles.detailValue}>\n                  {new Date(trail.date).toLocaleString('en-US', {\n                    weekday: 'short',\n                    year: 'numeric',\n                    month: 'short',\n                    day: 'numeric',\n                    hour: 'numeric',\n                    minute: '2-digit',\n                  })}\n                </Text>\n              </View>\n            </View>\n          </View>\n          </View>\n        </View>\n      </Animated.ScrollView>\n    </View>\n  );\n}\n","import { useState } from 'react';\n\nimport React from 'react';\nimport { Text, View, TextInput, TouchableOpacity, StyleSheet, KeyboardAvoidingView, Platform, Alert, ActivityIndicator } from 'react-native';\nimport { useRouter } from 'expo-router';\nimport * as Haptics from 'expo-haptics';\nimport { useAuth } from '@/context/AuthContext';\nimport { webauthnRegisterOptions, webauthnRegisterVerify, base64UrlToBuffer, bufferToBase64Url } from '@/lib/api';\nimport { UserPlus } from 'lucide-react-native';\nimport colors from '@/constants/colors';\n\nexport default function SignupScreen() {\n  const router = useRouter();\n  const { requestRegistration, verifyRegistration } = useAuth();\n  const [email, setEmail] = useState<string>('');\n  const [name, setName] = useState<string>('');\n  const [otpCode, setOtpCode] = useState<string>('');\n  const [step, setStep] = useState<'info' | 'otp'>('info');\n  const [isLoading, setIsLoading] = useState<boolean>(false);\n\n  const handleRequestRegistration = async () => {\n    if (!email || !name) {\n      if (Platform.OS !== 'web') {\n        Haptics.notificationAsync(Haptics.NotificationFeedbackType.Error);\n      }\n      Alert.alert('Error', 'Please fill in all fields');\n      return;\n    }\n\n    if (Platform.OS !== 'web') {\n      Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Medium);\n    }\n\n    setIsLoading(true);\n    try {\n      await requestRegistration(email.trim().toLowerCase(), name.trim());\n      if (Platform.OS !== 'web') {\n        Haptics.notificationAsync(Haptics.NotificationFeedbackType.Success);\n      }\n      setStep('otp');\n    } catch (error: any) {\n      if (Platform.OS !== 'web') {\n        Haptics.notificationAsync(Haptics.NotificationFeedbackType.Error);\n      }\n      console.error('Request registration error:', error);\n      Alert.alert('Error', error.message || 'Failed to request registration');\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleVerifyRegistration = async () => {\n    if (!otpCode) {\n      if (Platform.OS !== 'web') {\n        Haptics.notificationAsync(Haptics.NotificationFeedbackType.Error);\n      }\n      Alert.alert('Error', 'Please enter the OTP code');\n      return;\n    }\n\n    if (Platform.OS !== 'web') {\n      Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Medium);\n    }\n\n    setIsLoading(true);\n    try {\n      await verifyRegistration(email.trim().toLowerCase(), otpCode);\n      if (Platform.OS !== 'web') {\n        Haptics.notificationAsync(Haptics.NotificationFeedbackType.Success);\n      }\n      router.replace('/');\n    } catch (error: any) {\n      if (Platform.OS !== 'web') {\n        Haptics.notificationAsync(Haptics.NotificationFeedbackType.Error);\n      }\n      console.error('Verify registration error:', error);\n      Alert.alert('Error', error.message || 'Invalid OTP code');\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  return (\n    <KeyboardAvoidingView\n      style={styles.container}\n      behavior={Platform.OS === 'ios' ? 'padding' : 'height'}\n    >\n      <View style={styles.content}>\n        <View style={styles.header}>\n          <UserPlus size={64} color=\"#5d6b4a\" />\n          <Text style={styles.title}>Create Account</Text>\n          <Text style={styles.subtitle}>Sign up to start tracking your dog walks</Text>\n        </View>\n\n        <View style={styles.form}>\n          {step === 'info' ? (\n            <>\n              <View style={styles.inputContainer}>\n                <Text style={styles.label}>Name</Text>\n                <TextInput\n                  style={styles.input}\n                  placeholder=\"Your Name\"\n                  value={name}\n                  onChangeText={setName}\n                  autoCapitalize=\"words\"\n                  editable={!isLoading}\n                />\n              </View>\n\n              <View style={styles.inputContainer}>\n                <Text style={styles.label}>Email</Text>\n                <TextInput\n                  style={styles.input}\n                  placeholder=\"your@email.com\"\n                  value={email}\n                  onChangeText={setEmail}\n                  autoCapitalize=\"none\"\n                  keyboardType=\"email-address\"\n                  autoComplete=\"email\"\n                  editable={!isLoading}\n                />\n              </View>\n\n              <TouchableOpacity\n                style={[styles.button, isLoading && styles.buttonDisabled]}\n                onPress={handleRequestRegistration}\n                disabled={isLoading}\n              >\n                {isLoading ? (\n                  <ActivityIndicator color=\"#fff\" />\n                ) : (\n                  <Text style={styles.buttonText}>Send OTP</Text>\n                )}\n              </TouchableOpacity>\n\n              {Platform.OS === 'web' && (\n                <TouchableOpacity\n                  style={[styles.button, { marginTop: 8, backgroundColor: '#3b82f6' }]}\n                  onPress={async () => {\n                    if (!email || !name) {\n                      Alert.alert('Error', 'Please enter name and email to register a security key');\n                      return;\n                    }\n                    try {\n                      if (typeof window === 'undefined' || !(window as any).PublicKeyCredential) {\n                        Alert.alert('WebAuthn not supported', 'This browser does not support WebAuthn');\n                        return;\n                      }\n                      const opts: any = await webauthnRegisterOptions(email.trim().toLowerCase(), name.trim());\n                      // Build publicKey object expected by navigator.credentials.create\n                      const rpId = opts.rpId || opts.rp_id || opts.rp?.id;\n                      const userIdStr = opts.userId || opts.user_id || opts.user?.id || String(Date.now());\n                      const userName = opts.userName || opts.user_name || opts.user?.name || email.trim().toLowerCase();\n\n                      const publicKey: any = {\n                        challenge: base64UrlToBuffer(opts.challenge),\n                        rp: {\n                          id: rpId,\n                          name: opts.rpName || opts.rp_name || opts.rp?.name || (typeof window !== 'undefined' ? window.location.hostname : 'Tail Trails'),\n                        },\n                        user: {\n                          id: new TextEncoder().encode(userIdStr),\n                          name: userName,\n                          displayName: name.trim(),\n                        },\n                        pubKeyCredParams: opts.pubKeyCredParams || opts.pub_key_cred_params,\n                        timeout: opts.timeout,\n                      };\n\n                      console.log('WebAuthn register publicKey:', publicKey);\n\n                      // Convert excludeCredentials if present (accept multiple naming conventions)\n                      const exclude = opts.excludeCredentials || opts.exclude_credentials || opts.exclude_credentials_list;\n                      if (exclude && Array.isArray(exclude)) {\n                        publicKey.excludeCredentials = exclude.map((c: any) => ({\n                          id: base64UrlToBuffer(c.id),\n                          type: c.type || 'public-key',\n                        }));\n                      }\n\n                      const cred: any = await (navigator.credentials.create({ publicKey }) as Promise<Credential | null>);\n                      if (!cred) {\n                        Alert.alert('No credential created', 'The authenticator did not create a credential.');\n                        return;\n                      }\n                      const attestation = cred as any;\n                      const clientDataJSON = bufferToBase64Url(attestation.response.clientDataJSON);\n                      const attestationObject = bufferToBase64Url(attestation.response.attestationObject);\n                      const rawId = bufferToBase64Url(attestation.rawId);\n\n                      // Send to backend to verify & store credential using new API shape\n                      await webauthnRegisterVerify({\n                        email: email.trim().toLowerCase(),\n                        id: rawId,\n                        rawId: rawId,\n                        response: {\n                          clientDataJSON: clientDataJSON,\n                          attestationObject: attestationObject,\n                        },\n                        type: 'public-key',\n                        nickname: `${name.trim()}'s key`,\n                      });\n\n                      Alert.alert('Success', 'Security key registered');\n                    } catch (err: any) {\n                      console.error('WebAuthn register error', err);\n                      Alert.alert('WebAuthn Error', err?.message || String(err));\n                    }\n                  }}\n                >\n                  <Text style={styles.buttonText}>Register Security Key</Text>\n                </TouchableOpacity>\n              )}\n            </>\n          ) : (\n            <>\n              <View style={styles.inputContainer}>\n                <Text style={styles.label}>OTP Code</Text>\n                <TextInput\n                  style={styles.input}\n                  placeholder=\"Enter 6-digit code\"\n                  value={otpCode}\n                  onChangeText={setOtpCode}\n                  keyboardType=\"number-pad\"\n                  maxLength={6}\n                  editable={!isLoading}\n                />\n                <Text style={styles.helperText}>Sent to {email}</Text>\n              </View>\n\n              <TouchableOpacity\n                style={[styles.button, isLoading && styles.buttonDisabled]}\n                onPress={handleVerifyRegistration}\n                disabled={isLoading}\n              >\n                {isLoading ? (\n                  <ActivityIndicator color=\"#fff\" />\n                ) : (\n                  <Text style={styles.buttonText}>Verify & Sign Up</Text>\n                )}\n              </TouchableOpacity>\n\n              <TouchableOpacity\n                style={styles.secondaryButton}\n                onPress={() => setStep('info')}\n                disabled={isLoading}\n              >\n                <Text style={styles.secondaryButtonText}>Change Info</Text>\n              </TouchableOpacity>\n            </>\n          )}\n\n          <View style={styles.footer}>\n            <Text style={styles.footerText}>Already have an account? </Text>\n            <TouchableOpacity onPress={() => {\n              if (Platform.OS !== 'web') {\n                Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Light);\n              }\n              router.push('/login');\n            }}>\n              <Text style={styles.linkText}>Sign In</Text>\n            </TouchableOpacity>\n          </View>\n        </View>\n      </View>\n    </KeyboardAvoidingView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: colors.background,\n  },\n  content: {\n    flex: 1,\n    padding: 24,\n    justifyContent: 'center',\n  },\n  header: {\n    alignItems: 'center',\n    marginBottom: 48,\n  },\n  title: {\n    fontSize: 32,\n    fontWeight: '700' as const,\n  color: colors.light.text,\n    marginTop: 16,\n  },\n  subtitle: {\n    fontSize: 16,\n  color: colors.muted,\n    marginTop: 8,\n    textAlign: 'center',\n  },\n  form: {\n    width: '100%',\n  },\n  inputContainer: {\n    marginBottom: 20,\n  },\n  label: {\n    fontSize: 14,\n    fontWeight: '600' as const,\n  color: colors.primary,\n    marginBottom: 8,\n  },\n  input: {\n  backgroundColor: '#fff',\n    borderWidth: 1,\n    borderColor: '#a8ad8e',\n    borderRadius: 12,\n    padding: 16,\n    fontSize: 16,\n    color: '#1a1f0a',\n  },\n  helperText: {\n    fontSize: 12,\n    color: '#6b7280',\n    marginTop: 8,\n  },\n  button: {\n    backgroundColor: '#5d6b4a',\n    borderRadius: 12,\n    padding: 16,\n    alignItems: 'center',\n    marginTop: 12,\n  },\n  buttonDisabled: {\n    opacity: 0.6,\n  },\n  buttonText: {\n    fontSize: 16,\n    fontWeight: '600' as const,\n    color: '#fff',\n  },\n  secondaryButton: {\n    padding: 16,\n    alignItems: 'center',\n    marginTop: 8,\n  },\n  secondaryButtonText: {\n    fontSize: 14,\n    fontWeight: '600' as const,\n    color: '#5d6b4a',\n  },\n  footer: {\n    flexDirection: 'row',\n    justifyContent: 'center',\n    alignItems: 'center',\n    marginTop: 24,\n  },\n  footerText: {\n    fontSize: 14,\n    color: '#6b7280',\n  },\n  linkText: {\n    fontSize: 14,\n    fontWeight: '600' as const,\n    color: '#5d6b4a',\n  },\n});\n","import React, { useState } from 'react';\nimport { Text, View, TextInput, TouchableOpacity, StyleSheet, KeyboardAvoidingView, Platform, Alert, ActivityIndicator } from 'react-native';\nimport { useRouter } from 'expo-router';\nimport * as Haptics from 'expo-haptics';\nimport { useAuth } from '@/context/AuthContext';\nimport { webauthnAuthOptions, webauthnAuthVerify, base64UrlToBuffer, bufferToBase64Url } from '@/lib/api';\nimport { Image } from 'expo-image';\nimport colors from '@/constants/colors';\n\nexport default function LoginScreen() {\n  const router = useRouter();\n  const { requestOtp, verifyOtp } = useAuth();\n  const { signInWithToken } = useAuth();\n  const [email, setEmail] = useState<string>('');\n  const [otpCode, setOtpCode] = useState<string>('');\n  const [step, setStep] = useState<'email' | 'otp'>('email');\n  const [isLoading, setIsLoading] = useState<boolean>(false);\n\n  const handleRequestOtp = async () => {\n    if (!email) {\n      if (Platform.OS !== 'web') {\n        Haptics.notificationAsync(Haptics.NotificationFeedbackType.Error);\n      }\n      Alert.alert('Error', 'Please enter your email');\n      return;\n    }\n\n    if (Platform.OS !== 'web') {\n      Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Medium);\n    }\n\n    setIsLoading(true);\n    try {\n      await requestOtp(email.trim().toLowerCase());\n      if (Platform.OS !== 'web') {\n        Haptics.notificationAsync(Haptics.NotificationFeedbackType.Success);\n      }\n      setStep('otp');\n    } catch (error: any) {\n      if (Platform.OS !== 'web') {\n        Haptics.notificationAsync(Haptics.NotificationFeedbackType.Error);\n      }\n      console.error('Request OTP error:', error);\n      Alert.alert('Error', error.message || 'Failed to request OTP');\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleVerifyOtp = async () => {\n    if (!otpCode) {\n      if (Platform.OS !== 'web') {\n        Haptics.notificationAsync(Haptics.NotificationFeedbackType.Error);\n      }\n      Alert.alert('Error', 'Please enter the OTP code');\n      return;\n    }\n\n    if (Platform.OS !== 'web') {\n      Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Medium);\n    }\n\n    setIsLoading(true);\n    try {\n      await verifyOtp(email.trim().toLowerCase(), otpCode);\n      if (Platform.OS !== 'web') {\n        Haptics.notificationAsync(Haptics.NotificationFeedbackType.Success);\n      }\n      router.replace('/');\n    } catch (error: any) {\n      if (Platform.OS !== 'web') {\n        Haptics.notificationAsync(Haptics.NotificationFeedbackType.Error);\n      }\n      console.error('Verify OTP error:', error);\n      Alert.alert('Error', error.message || 'Invalid OTP code');\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  return (\n    <KeyboardAvoidingView\n      style={styles.container}\n      behavior={Platform.OS === 'ios' ? 'padding' : 'height'}\n    >\n      <View style={styles.content}>\n        <View style={styles.header}>\n          <Image\n            source={{ uri: 'https://pub-e001eb4506b145aa938b5d3badbff6a5.r2.dev/attachments/dae4myluqaizgiwvqbwx1' }}\n            style={styles.logo}\n            contentFit=\"contain\"\n          />\n          <Text style={styles.title}>Welcome Back</Text>\n          <Text style={styles.subtitle}>Sign in to track your dog walks</Text>\n        </View>\n\n        <View style={styles.form}>\n          {step === 'email' ? (\n            <>\n              <View style={styles.inputContainer}>\n                <Text style={styles.label}>Email</Text>\n                <TextInput\n                  style={styles.input}\n                  placeholder=\"your@email.com\"\n                  value={email}\n                  onChangeText={setEmail}\n                  autoCapitalize=\"none\"\n                  keyboardType=\"email-address\"\n                  autoComplete=\"email\"\n                  editable={!isLoading}\n                />\n              </View>\n\n              <TouchableOpacity\n                style={[styles.button, isLoading && styles.buttonDisabled]}\n                onPress={handleRequestOtp}\n                disabled={isLoading}\n              >\n                {isLoading ? (\n                  <ActivityIndicator color=\"#fff\" />\n                ) : (\n                  <Text style={styles.buttonText}>Send OTP</Text>\n                )}\n              </TouchableOpacity>\n\n              {Platform.OS === 'web' && (\n                <TouchableOpacity\n                  style={[styles.button, { marginTop: 8, backgroundColor: '#3b82f6' }]}\n                  onPress={async () => {\n                    if (!email) {\n                      Alert.alert('Error', 'Enter email for WebAuthn sign-in');\n                      return;\n                    }\n                    try {\n                      const opts = await webauthnAuthOptions(email.trim().toLowerCase());\n                      // Convert challenge and allow_credentials id to ArrayBuffers\n                      const publicKey: any = {\n                        ...opts,\n                        challenge: base64UrlToBuffer(opts.challenge),\n                      };\n                      if (opts.allow_credentials) {\n                        publicKey.allowCredentials = opts.allow_credentials.map((c: any) => ({\n                          type: c.type,\n                          id: base64UrlToBuffer(c.id),\n                        }));\n                      }\n\n                      console.log('WebAuthn get publicKey:', publicKey);\n                      const cred: any = await (navigator.credentials.get({ publicKey }) as Promise<Credential>);\n                      // @ts-ignore\n                      const assertion = cred as any;\n                      const authData = bufferToBase64Url(assertion.response.authenticatorData);\n                      const clientDataJSON = bufferToBase64Url(assertion.response.clientDataJSON);\n                      const signature = bufferToBase64Url(assertion.response.signature);\n                      const credentialId = bufferToBase64Url(assertion.rawId);\n\n                      const verifyResp = await webauthnAuthVerify({\n                        email: email.trim().toLowerCase(),\n                        id: credentialId,\n                        rawId: credentialId,\n                        response: {\n                          authenticatorData: authData,\n                          clientDataJSON: clientDataJSON,\n                          signature: signature,\n                        },\n                        type: 'public-key',\n                      });\n\n                      // sign in with token\n                      await signInWithToken(verifyResp);\n                      router.replace('/');\n                    } catch (err: any) {\n                      console.error('WebAuthn sign-in error', err);\n                      Alert.alert('WebAuthn Error', err?.message || String(err));\n                    }\n                  }}\n                >\n                  <Text style={styles.buttonText}>Sign in with Security Key</Text>\n                </TouchableOpacity>\n              )}\n            </>\n          ) : (\n            <>\n              <View style={styles.inputContainer}>\n                <Text style={styles.label}>OTP Code</Text>\n                <TextInput\n                  style={styles.input}\n                  placeholder=\"Enter 6-digit code\"\n                  value={otpCode}\n                  onChangeText={setOtpCode}\n                  keyboardType=\"number-pad\"\n                  maxLength={6}\n                  editable={!isLoading}\n                />\n                <Text style={styles.helperText}>Sent to {email}</Text>\n              </View>\n\n              <TouchableOpacity\n                style={[styles.button, isLoading && styles.buttonDisabled]}\n                onPress={handleVerifyOtp}\n                disabled={isLoading}\n              >\n                {isLoading ? (\n                  <ActivityIndicator color=\"#fff\" />\n                ) : (\n                  <Text style={styles.buttonText}>Verify & Sign In</Text>\n                )}\n              </TouchableOpacity>\n\n              <TouchableOpacity\n                style={styles.secondaryButton}\n                onPress={() => setStep('email')}\n                disabled={isLoading}\n              >\n                <Text style={styles.secondaryButtonText}>Change Email</Text>\n              </TouchableOpacity>\n            </>\n          )}\n\n          <View style={styles.footer}>\n            <Text style={styles.footerText}>Don&apos;t have an account? </Text>\n            <TouchableOpacity onPress={() => {\n              if (Platform.OS !== 'web') {\n                Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Light);\n              }\n              router.push('/signup');\n            }}>\n              <Text style={styles.linkText}>Sign Up</Text>\n            </TouchableOpacity>\n          </View>\n        </View>\n      </View>\n    </KeyboardAvoidingView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: colors.background,\n  },\n  content: {\n    flex: 1,\n    padding: 24,\n    justifyContent: 'center',\n  },\n  header: {\n    alignItems: 'center',\n    marginBottom: 48,\n  },\n  logo: {\n    width: 100,\n    height: 100,\n  },\n  title: {\n    fontSize: 32,\n    fontWeight: '700' as const,\n  color: colors.light.text,\n    marginTop: 16,\n  },\n  subtitle: {\n    fontSize: 16,\n  color: colors.muted,\n    marginTop: 8,\n    textAlign: 'center',\n  },\n  form: {\n    width: '100%',\n  },\n  inputContainer: {\n    marginBottom: 20,\n  },\n  label: {\n    fontSize: 14,\n    fontWeight: '600' as const,\n    color: '#5d6b4a',\n    marginBottom: 8,\n  },\n  input: {\n    backgroundColor: '#fff',\n    borderWidth: 1,\n    borderColor: '#a8ad8e',\n    borderRadius: 12,\n    padding: 16,\n    fontSize: 16,\n    color: '#1a1f0a',\n  },\n  helperText: {\n    fontSize: 12,\n    color: '#6b7280',\n    marginTop: 8,\n  },\n  button: {\n    backgroundColor: '#5d6b4a',\n    borderRadius: 12,\n    padding: 16,\n    alignItems: 'center',\n    marginTop: 12,\n  },\n  buttonDisabled: {\n    opacity: 0.6,\n  },\n  buttonText: {\n    fontSize: 16,\n    fontWeight: '600' as const,\n    color: '#fff',\n  },\n  secondaryButton: {\n    padding: 16,\n    alignItems: 'center',\n    marginTop: 8,\n  },\n  secondaryButtonText: {\n    fontSize: 14,\n    fontWeight: '600' as const,\n    color: '#5d6b4a',\n  },\n  footer: {\n    flexDirection: 'row',\n    justifyContent: 'center',\n    alignItems: 'center',\n    marginTop: 24,\n  },\n  footerText: {\n    fontSize: 14,\n    color: '#6b7280',\n  },\n  linkText: {\n    fontSize: 14,\n    fontWeight: '600' as const,\n    color: '#5d6b4a',\n  },\n});\n","// Minimal shim for react-native-reanimated on web builds.\n// This prevents webpack from throwing \"Module not found\" when optional\n// requires are used inside native-only packages (e.g. react-native-gesture-handler).\n// The shim intentionally provides an empty object; if your app uses\n// reanimated-specific APIs on web this will not implement them.\nmodule.exports = {};\nmodule.exports.default = module.exports;\n","// Local copy of nanoid non-secure implementation to avoid package subpath resolution issues\nconst urlAlphabet =\n  'useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict'\nconst customAlphabet = (alphabet, defaultSize = 21) => {\n  return (size = defaultSize) => {\n    let id = ''\n    let i = size | 0\n    while (i--) {\n      id += alphabet[(Math.random() * alphabet.length) | 0]\n    }\n    return id\n  }\n}\nconst nanoid = (size = 21) => {\n  let id = ''\n  let i = size | 0\n  while (i--) {\n    id += urlAlphabet[(Math.random() * 64) | 0]\n  }\n  return id\n}\nexport { nanoid, customAlphabet }\n","import React, { useState, useCallback, useEffect } from 'react';\n\nimport { useFocusEffect, useRouter } from 'expo-router';\n\nimport { Text, View, ScrollView, TouchableOpacity, Platform, ActivityIndicator, Animated, TextInput, Modal, FlatList } from 'react-native';\nimport { Image } from 'expo-image';\nimport { LinearGradient } from 'expo-linear-gradient';\nimport { useSafeAreaInsets } from 'react-native-safe-area-context';\nimport * as Location from 'expo-location';\nimport * as Haptics from 'expo-haptics';\n\nimport { MapPin, Search, Heart, Umbrella, Bookmark, Star, X, BarChart3, Navigation, Icon, ChevronLeft } from 'lucide-react-native';\nimport colors from '@/constants/colors';\nimport { useTrails } from '@/context/TrailsContext';\nimport { Trail } from '@/types/trail';\nimport { formatDistance } from '@/utils/distance';\nimport TrailMapPreview from '@/components/TrailMapPreview';\n\nimport styles from './explore.styles';\n\n\n\nconst CATEGORIES = [\n  { id: 'nearby', name: 'Nearby', icon: MapPin },\n  { id: 'popular', name: 'Popular', icon: Heart },\n  { id: 'beaches', name: 'Beaches', icon: Umbrella },\n];\n\n\n\nexport default function ExploreScreen() {\n  const router = useRouter();\n  const insets = useSafeAreaInsets();\n  const { loadNearbyTrails, saveTrailBookmark, removeTrailBookmark, isTrailSaved } = useTrails();\n  const [selectedCategory, setSelectedCategory] = useState<string>('nearby');\n  const [nearbyTrails, setNearbyTrails] = useState<Trail[]>([]);\n  const [isLoadingNearby, setIsLoadingNearby] = useState<boolean>(true);\n  const [, setUserCity] = useState<string | undefined>(undefined);\n  const [bookmarkAnimations, setBookmarkAnimations] = useState<Record<string, Animated.Value>>({});\n  const [searchQuery, setSearchQuery] = useState<string>('');\n  const [showSearchModal, setShowSearchModal] = useState<boolean>(false);\n  const [currentLocation, setCurrentLocation] = useState<string>('');\n  const [searchSuggestions, setSearchSuggestions] = useState<{id: string; name: string; location: string; type: string}[]>([]);\n\n  const loadUserLocationAndNearbyTrails = useCallback(async () => {\n    if (Platform.OS === 'web') {\n      setCurrentLocation('Current location');\n      // Try to get a quick browser location; if unavailable, load without coords\n      try {\n        if (navigator && navigator.geolocation) {\n          navigator.geolocation.getCurrentPosition(async (pos) => {\n            try {\n              const trails = await loadNearbyTrails(pos.coords.latitude, pos.coords.longitude);\n              setNearbyTrails(trails);\n            } catch (err) {\n              console.error('Failed to load nearby trails with browser location:', err);\n              const trails = await loadNearbyTrails();\n              setNearbyTrails(trails);\n            } finally {\n              setIsLoadingNearby(false);\n            }\n          }, async () => {\n            const trails = await loadNearbyTrails();\n            setNearbyTrails(trails);\n            setIsLoadingNearby(false);\n          });\n          return;\n        }\n      } catch (err) {\n        console.error('Geolocation not available on web:', err);\n      }\n\n      const trails = await loadNearbyTrails();\n      setNearbyTrails(trails);\n      setIsLoadingNearby(false);\n      return;\n    }\n\n    try {\n      const { status } = await Location.requestForegroundPermissionsAsync();\n      \n      if (status === 'granted') {\n        const location = await Location.getCurrentPositionAsync({\n          accuracy: Location.Accuracy.Balanced,\n        });\n\n        // Skip reverse geocoding to avoid rate limits. We only need lat/lon for nearby search.\n        setUserCity(undefined);\n        setCurrentLocation('Current location');\n        const trails = await loadNearbyTrails(location.coords.latitude, location.coords.longitude);\n        setNearbyTrails(trails);\n      } else {\n        setCurrentLocation('Location unavailable');\n        const trails = await loadNearbyTrails();\n        setNearbyTrails(trails);\n      }\n    } catch (error) {\n      console.error('Error loading location:', error);\n      setCurrentLocation('Location unavailable');\n      const trails = await loadNearbyTrails();\n      setNearbyTrails(trails);\n    } finally {\n      setIsLoadingNearby(false);\n    }\n  }, [loadNearbyTrails]);\n\n  useEffect(() => {\n    loadUserLocationAndNearbyTrails();\n  }, [loadUserLocationAndNearbyTrails]);\n\n  useFocusEffect(\n    useCallback(() => {\n      console.log('Explore tab focused - refreshing nearby trails');\n      loadUserLocationAndNearbyTrails();\n    }, [loadUserLocationAndNearbyTrails])\n  );\n\n  const loadSearchSuggestions = useCallback(() => {\n    const query = searchQuery.toLowerCase();\n    \n    const suggestions = nearbyTrails\n      .filter(trail => {\n        const name = trail.name?.toLowerCase() || '';\n        const city = trail.city?.toLowerCase() || '';\n        const country = trail.country?.toLowerCase() || '';\n        return name.includes(query) || city.includes(query) || country.includes(query);\n      })\n      .map(trail => ({\n        id: trail.id,\n        name: trail.name || `Trail ${new Date(trail.date).toLocaleDateString()}`,\n        location: trail.city ? `${trail.city}, ${trail.country || 'Unknown'}` : 'Location unknown',\n        type: 'trail',\n      }))\n      .slice(0, 6);\n\n    setSearchSuggestions(suggestions);\n  }, [searchQuery, nearbyTrails]);\n\n  useEffect(() => {\n    if (searchQuery.trim()) {\n      loadSearchSuggestions();\n    } else {\n      setSearchSuggestions([]);\n    }\n  }, [searchQuery, loadSearchSuggestions]);\n\n  const handleSearchBarPress = () => {\n    if (Platform.OS !== 'web') {\n      Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Light);\n    }\n    setShowSearchModal(true);\n  };\n\n  const handleCloseSearchModal = () => {\n    if (Platform.OS !== 'web') {\n      Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Light);\n    }\n    setShowSearchModal(false);\n    setSearchQuery('');\n    setSearchSuggestions([]);\n  };\n\n  const handleSuggestionPress = (suggestionId: string) => {\n    if (Platform.OS !== 'web') {\n      Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Light);\n    }\n    setShowSearchModal(false);\n    setSearchQuery('');\n    setSearchSuggestions([]);\n    router.push(`/trail/${suggestionId}`);\n  };\n\n  const handleCurrentLocationPress = () => {\n    if (Platform.OS !== 'web') {\n      Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Light);\n    }\n    setShowSearchModal(false);\n    setSearchQuery('');\n    setSearchSuggestions([]);\n  };\n\n  const getBookmarkAnimation = (trailId: string) => {\n    if (!bookmarkAnimations[trailId]) {\n      const newAnim = new Animated.Value(1);\n      setBookmarkAnimations(prev => ({ ...prev, [trailId]: newAnim }));\n      return newAnim;\n    }\n    return bookmarkAnimations[trailId];\n  };\n\n  const isValidUUID = (id: string): boolean => {\n    const uuidRegex = /^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;\n    return uuidRegex.test(id);\n  };\n\n  const handleBookmarkPress = async (trailId: string, isRealTrail: boolean = false) => {\n    if (!isRealTrail && !isValidUUID(trailId)) {\n      console.log('Cannot bookmark mock trail:', trailId);\n      if (Platform.OS !== 'web') {\n        Haptics.notificationAsync(Haptics.NotificationFeedbackType.Warning);\n      }\n      return;\n    }\n\n    if (Platform.OS !== 'web') {\n      Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Medium);\n    }\n\n    const anim = getBookmarkAnimation(trailId);\n    const isSaved = isTrailSaved(trailId);\n\n    Animated.sequence([\n      Animated.timing(anim, {\n        toValue: 0.6,\n        duration: 100,\n        useNativeDriver: true,\n      }),\n      Animated.spring(anim, {\n        toValue: 1,\n        friction: 3,\n        tension: 100,\n        useNativeDriver: true,\n      }),\n    ]).start();\n\n    try {\n      if (isSaved) {\n        await removeTrailBookmark(trailId);\n      } else {\n        await saveTrailBookmark(trailId);\n        if (Platform.OS !== 'web') {\n          Haptics.notificationAsync(Haptics.NotificationFeedbackType.Success);\n        }\n      }\n    } catch (error) {\n      console.error('Failed to toggle bookmark:', error);\n    }\n  };\n\n  const handleNavigateToTrail = (trailId: string) => {\n    if (Platform.OS !== 'web') {\n      Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Light);\n    }\n    router.push(`/trail/${trailId}`);\n  };\n\n  const handleCategoryPress = (categoryId: string) => {\n    if (Platform.OS !== 'web') {\n      Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Light);\n    }\n    setSelectedCategory(categoryId);\n  };\n\n  const getFilteredTrails = useCallback((trails: Trail[]) => {\n    let filtered = trails;\n\n    if (selectedCategory === 'popular') {\n      filtered = [...filtered].sort((a, b) => (b.rating || 0) - (a.rating || 0));\n    } else if (selectedCategory === 'beaches') {\n      filtered = filtered.filter((trail) => {\n        const tags = trail.environment_tags || [];\n        return tags.some(tag => tag.toLowerCase().includes('beach'));\n      });\n    }\n\n    return filtered;\n  }, [selectedCategory]);\n\n  const filteredTrails = getFilteredTrails(nearbyTrails);\n\n  return (\n    <View style={styles.safeContainer}>\n      <ScrollView \n        style={styles.container} \n        showsVerticalScrollIndicator={false}\n        stickyHeaderIndices={[0]}\n      >\n        <View style={[styles.stickyHeader, { paddingTop: insets.top + 16 }]}>\n          <View style={styles.stickySearchContainer}>\n            <TouchableOpacity \n              style={styles.searchBar}\n              onPress={handleSearchBarPress}\n              activeOpacity={0.7}\n            >\n              <Search size={20} color={colors.muted} />\n              <Text style={styles.searchPlaceholder}>Find trails</Text>\n            </TouchableOpacity>\n            {Platform.OS === 'web' && (\n              <TouchableOpacity \n                style={styles.demoButton}\n                onPress={() => router.push('/trail/demo-trail')}\n              >\n                <Text style={styles.demoButtonText}>Demo</Text>\n              </TouchableOpacity>\n            )}\n          </View>\n\n          <View style={styles.categoriesSection}>\n            <ScrollView\n              horizontal\n              showsHorizontalScrollIndicator={false}\n              contentContainerStyle={styles.categoriesScroll}\n            >\n              {CATEGORIES.map((category) => {\n                const Icon = category.icon;\n                const isSelected = selectedCategory === category.id;\n                \n                return (\n                  <TouchableOpacity\n                    key={category.id}\n                    style={[\n                      styles.categoryButton,\n                      isSelected && styles.categoryButtonActive,\n                    ]}\n                    onPress={() => handleCategoryPress(category.id)}\n                  >\n                    <Icon\n                      size={20}\n                      color={isSelected ? colors.light.tabIconSelected : colors.muted}\n                      strokeWidth={2}\n                    />\n                    <Text\n                      style={[\n                        styles.categoryText,\n                        isSelected && styles.categoryTextActive,\n                      ]}\n                    >\n                      {category.name}\n                    </Text>\n                  </TouchableOpacity>\n                );\n              })}\n            </ScrollView>\n          </View>\n        </View>\n\n      <View style={styles.categoryTrailsSection}>\n        {isLoadingNearby ? (\n          <View style={styles.loadingContainer}>\n            <ActivityIndicator size=\"large\" color={colors.muted} />\n            <Text style={styles.loadingText}>Loading trails...</Text>\n          </View>\n        ) : filteredTrails.length > 0 ? (\n          filteredTrails.map((trail) => {\n            const anim = getBookmarkAnimation(trail.id);\n            const isSaved = isTrailSaved(trail.id);\n            return (\n            <TouchableOpacity\n              key={trail.id}\n              style={styles.largeTrailCard}\n              onPress={() => handleNavigateToTrail(trail.id)}\n            >\n                {trail.photo ? (\n                <Image\n                  source={{ uri: trail.photo }}\n                  style={styles.largeTrailImage}\n                  contentFit=\"cover\"\n                  cachePolicy=\"memory-disk\"\n                />\n              ) : (\n                <TrailMapPreview\n                  coordinates={trail.coordinates}\n                  path={(trail as any).path}\n                  style={styles.largeTrailImage}\n                  startLatitude={(trail as any).startLatitude}\n                  startLongitude={(trail as any).startLongitude}\n                />\n              )}\n              \n              <LinearGradient\n                colors={['rgba(0, 0, 0, 0)', 'rgba(0, 0, 0, 0)', 'rgba(0, 0, 0, 0.25)', 'rgba(0, 0, 0, 0.6)']}\n                locations={[0, 0.3, 0.6, 1]}\n                style={styles.cardGradient}\n              />\n              \n              <TouchableOpacity \n                style={styles.bookmarkButton}\n                onPress={(e) => {\n                  e.stopPropagation();\n                  handleBookmarkPress(trail.id, true);\n                }}\n              >\n                <Animated.View style={{ transform: [{ scale: anim }] }}>\n                  <Bookmark \n                    size={20} \n                    color={isSaved ? '#000' : colors.muted} \n                    fill={isSaved ? '#000' : 'none'}\n                    strokeWidth={2} \n                  />\n                </Animated.View>\n              </TouchableOpacity>\n              \n              <View style={styles.cardOverlayContent}>\n                <Text style={styles.overlayTrailName}>\n                  {trail.name || `Trail ${new Date(trail.date).toLocaleDateString()}`}\n                </Text>\n                <Text style={styles.overlayLocation}>\n                  {trail.city ? `${trail.city}, ${trail.country || 'Unknown'}` : 'Location unknown'}\n                </Text>\n                <View style={styles.overlayBadges}>\n                  {trail.difficulty && (\n                    <View style={styles.badge}>\n                      <BarChart3 size={14} color={colors.paleYellow} strokeWidth={2.5} />\n                      <Text style={styles.badgeText}>{trail.difficulty}</Text>\n                    </View>\n                  )}\n                  <View style={styles.badge}>\n                    <MapPin size={14} color={colors.paleYellow} strokeWidth={2.5} />\n                    <Text style={styles.badgeText}>{formatDistance(trail.distance)}</Text>\n                  </View>\n                  {typeof (trail as any).distance_from_user === 'number' && (\n                    <View style={styles.badge}>\n                      <MapPin size={14} color={colors.paleYellow} strokeWidth={2.5} />\n                      <Text style={styles.badgeText}>{formatDistance((trail as any).distance_from_user)}</Text>\n                    </View>\n                  )}\n                  {trail.rating && (\n                    <View style={styles.badge}>\n                      <Star size={14} color={colors.accent} fill={colors.accent} strokeWidth={2} />\n                      <Text style={styles.badgeText}>{trail.rating.toFixed(1)}</Text>\n                    </View>\n                  )}\n                </View>\n              </View>\n            </TouchableOpacity>\n            );\n          })\n        ) : (\n          <View style={styles.emptyContainer}>\n            <MapPin size={48} color=\"#9ca3af\" />\n            <Text style={styles.emptyText}>\n              No trails found yet. Record a trail to share with others!\n            </Text>\n          </View>\n        )}\n      </View>\n\n        <View style={styles.bottomPadding} />\n      </ScrollView>\n\n      <Modal\n        visible={showSearchModal}\n        animationType=\"slide\"\n        presentationStyle=\"fullScreen\"\n        onRequestClose={handleCloseSearchModal}\n      >\n        <View style={[styles.searchModalContainer, { paddingTop: insets.top }]}>\n          <View style={styles.searchModalHeader}>\n            <TouchableOpacity\n              style={styles.backButton}\n              onPress={handleCloseSearchModal}\n            >\n              <ChevronLeft size={24} color=\"#5d6b4a\" />\n            </TouchableOpacity>\n            <View style={styles.searchModalInputContainer}>\n              <TextInput\n                style={styles.searchModalInput}\n                placeholder=\"Find trails\"\n                placeholderTextColor=\"#9ca3af\"\n                value={searchQuery}\n                onChangeText={setSearchQuery}\n                autoFocus\n                returnKeyType=\"search\"\n              />\n              {searchQuery.length > 0 && (\n                <TouchableOpacity \n                  style={styles.clearButton}\n                  onPress={() => setSearchQuery('')}\n                >\n                  <X size={20} color=\"#64748b\" />\n                </TouchableOpacity>\n              )}\n            </View>\n          </View>\n\n          <View style={styles.searchModalContent}>\n            {searchQuery.trim() === '' && (\n              <TouchableOpacity\n                style={styles.currentLocationItem}\n                onPress={handleCurrentLocationPress}\n              >\n                <View style={styles.locationIconContainer}>\n                  <Navigation size={20} color=\"#5d6b4a\" />\n                </View>\n                <View style={styles.locationTextContainer}>\n                  <Text style={styles.locationTitle}>Current location</Text>\n                  <Text style={styles.locationSubtitle}>{currentLocation}</Text>\n                </View>\n              </TouchableOpacity>\n            )}\n\n            {searchSuggestions.length > 0 && (\n              <FlatList\n                data={searchSuggestions}\n                keyExtractor={(item) => item.id}\n                renderItem={({ item }) => (\n                  <TouchableOpacity\n                    style={styles.suggestionItem}\n                    onPress={() => handleSuggestionPress(item.id)}\n                  >\n                    <View style={styles.suggestionIconContainer}>\n                      <MapPin size={20} color=\"#64748b\" />\n                    </View>\n                    <View style={styles.suggestionTextContainer}>\n                      <Text style={styles.suggestionTitle}>{item.name}</Text>\n                      <Text style={styles.suggestionSubtitle}>{item.location}</Text>\n                    </View>\n                  </TouchableOpacity>\n                )}\n                showsVerticalScrollIndicator={false}\n              />\n            )}\n          </View>\n        </View>\n      </Modal>\n    </View>\n  );\n}\n\n// styles are imported from explore.styles.ts\n","import React, { useState, useEffect, useRef } from 'react';\nimport { Text, View, StyleSheet, TouchableOpacity, TextInput, Image, Alert, ScrollView, Platform, ActivityIndicator } from 'react-native';\n\nimport { useRouter, Stack } from 'expo-router';\n\nimport { useDogs } from '@/context/DogsContext';\nimport * as ImagePicker from 'expo-image-picker';\nimport * as Haptics from 'expo-haptics';\n\nimport { ChevronDown, Camera, Upload } from 'lucide-react-native';\nimport { useSafeAreaInsets } from 'react-native-safe-area-context';\nimport colors from '@/constants/colors';\nimport styles from './dog-basics.styles';\n\nimport { DogSize, DOG_SIZES } from '@/types/dog-profile';\n\nexport default function DogBasicsScreen() {\n  const router = useRouter();\n  const insets = useSafeAreaInsets();\n  const { dogProfile } = useDogs();\n  const [name, setName] = useState<string>('');\n  const [nickname, setNickname] = useState<string>('');\n  const [age, setAge] = useState<string>('');\n  const [size, setSize] = useState<DogSize | null>(null);\n  const [photo, setPhoto] = useState<string | null>(null);\n  const [showSizePicker, setShowSizePicker] = useState<boolean>(false);\n  const [isLoadingImage, setIsLoadingImage] = useState<boolean>(false);\n\n  useEffect(() => {\n    if (dogProfile) {\n      console.log('Loading existing dog profile for editing:', dogProfile);\n      setName(dogProfile.name);\n      setNickname(dogProfile.nickname || '');\n      setAge(dogProfile.age.toString());\n      setSize(dogProfile.size);\n      setPhoto(dogProfile.photo || null);\n    }\n  }, [dogProfile]);\n\n  const pickImage = async () => {\n    if (Platform.OS !== 'web') {\n      Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Light);\n    }\n\n    const { status } = await ImagePicker.requestMediaLibraryPermissionsAsync();\n    if (status !== 'granted') {\n      Alert.alert('Permission needed', 'We need access to your photo library');\n      return;\n    }\n\n    setIsLoadingImage(true);\n    const result = await ImagePicker.launchImageLibraryAsync({\n      mediaTypes: ['images'],\n      allowsEditing: true,\n      aspect: [1, 1],\n      quality: 0.7,\n    });\n\n    setIsLoadingImage(false);\n\n    if (!result.canceled && result.assets[0]) {\n      setPhoto(result.assets[0].uri);\n      if (Platform.OS !== 'web') {\n        Haptics.notificationAsync(Haptics.NotificationFeedbackType.Success);\n      }\n    }\n  };\n\n  const takePhoto = async () => {\n    if (Platform.OS !== 'web') {\n      Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Light);\n    }\n\n    const { status } = await ImagePicker.requestCameraPermissionsAsync();\n    if (status !== 'granted') {\n      Alert.alert('Permission needed', 'We need camera access to take photos');\n      return;\n    }\n\n    setIsLoadingImage(true);\n    const result = await ImagePicker.launchCameraAsync({\n      allowsEditing: true,\n      aspect: [1, 1],\n      quality: 0.7,\n    });\n\n    setIsLoadingImage(false);\n\n    if (!result.canceled && result.assets[0]) {\n      setPhoto(result.assets[0].uri);\n      if (Platform.OS !== 'web') {\n        Haptics.notificationAsync(Haptics.NotificationFeedbackType.Success);\n      }\n    }\n  };\n\n  const handleImagePicker = () => {\n    Alert.alert(\n      'Add Photo',\n      'Choose how you want to add a photo',\n      [\n        { text: 'Take Photo', onPress: takePhoto },\n        { text: 'Choose from Library', onPress: pickImage },\n        { text: 'Cancel', style: 'cancel' },\n      ]\n    );\n  };\n\n  const handleNext = () => {\n    if (!name.trim()) {\n      Alert.alert('Missing Information', 'Please enter your dog\\'s name');\n      return;\n    }\n\n    if (!size) {\n      Alert.alert('Missing Information', 'Please select your dog\\'s size');\n      return;\n    }\n\n    const parsedAge = parseInt(age, 10);\n    if (!age || isNaN(parsedAge) || parsedAge < 0 || parsedAge > 30) {\n      Alert.alert('Invalid Age', 'Please enter a valid age (0-30 years)');\n      return;\n    }\n\n    if (Platform.OS !== 'web') {\n      Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Medium);\n    }\n\n    const navigationMethod = dogProfile ? 'replace' : 'push';\n    router[navigationMethod]({\n      pathname: '/onboarding/dog-personality' as any,\n      params: {\n        name: name.trim(),\n        nickname: nickname.trim(),\n        age: parsedAge.toString(),\n        size,\n        photo: photo || '',\n        isEditing: dogProfile ? 'true' : 'false',\n      },\n    });\n  };\n\n  return (\n    <>\n      <Stack.Screen options={{ headerShown: false }} />\n      <ScrollView style={styles.container} contentContainerStyle={[styles.content, { paddingTop: insets.top + 20 }]}>\n        <View style={styles.header}>\n          <Text style={styles.title}>{dogProfile ? 'Edit dog profile' : 'Tell us about your dog'}</Text>\n          <Text style={styles.subtitle}>{dogProfile ? 'Update your dog\\'s information' : 'Let\\'s start with the basics'}</Text>\n          {!dogProfile && (\n            <View style={styles.progressContainer}>\n              <View style={[styles.progressDot, styles.progressDotActive]} />\n              <View style={styles.progressDot} />\n            </View>\n          )}\n        </View>\n\n        <TouchableOpacity\n          style={styles.photoContainer}\n          onPress={handleImagePicker}\n          disabled={isLoadingImage}\n        >\n          {isLoadingImage ? (\n            <ActivityIndicator size=\"large\" color=\"#FFFE77\" />\n          ) : photo ? (\n            <Image source={{ uri: photo }} style={styles.photo} />\n          ) : (\n            <View style={styles.photoPlaceholder}>\n              <Camera size={32} color=\"#FFFE77\" />\n              <Text style={styles.photoPlaceholderText}>Add Photo</Text>\n            </View>\n          )}\n          {photo && !isLoadingImage && (\n            <View style={styles.photoOverlay}>\n              <Upload size={24} color=\"#1a1f0a\" />\n            </View>\n          )}\n        </TouchableOpacity>\n\n        <View style={styles.formSection}>\n          <Text style={styles.label}>Name *</Text>\n          <TextInput\n            style={styles.input}\n            value={name}\n            onChangeText={setName}\n            placeholder=\"Enter your dog&apos;s name\"\n            placeholderTextColor=\"#5a6040\"\n            autoCapitalize=\"words\"\n            testID=\"dog-name-input\"\n          />\n        </View>\n\n        <View style={styles.formSection}>\n          <Text style={styles.label}>Nickname (Optional)</Text>\n          <TextInput\n            style={styles.input}\n            value={nickname}\n            onChangeText={setNickname}\n            placeholder=\"Enter a nickname\"\n            placeholderTextColor=\"#5a6040\"\n            autoCapitalize=\"words\"\n            testID=\"dog-nickname-input\"\n          />\n        </View>\n\n        <View style={styles.formSection}>\n          <Text style={styles.label}>Size *</Text>\n          <TouchableOpacity\n            style={styles.pickerButton}\n            onPress={() => {\n              if (Platform.OS !== 'web') {\n                Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Light);\n              }\n              setShowSizePicker(!showSizePicker);\n            }}\n            testID=\"size-picker-button\"\n          >\n            <Text style={[styles.pickerButtonText, !size && styles.pickerButtonTextPlaceholder]}>\n              {size || 'Select size'}\n            </Text>\n            <ChevronDown size={20} color=\"#a8ad8e\" />\n          </TouchableOpacity>\n          {showSizePicker && (\n            <View style={styles.pickerOptions}>\n              {DOG_SIZES.map((s) => (\n                <TouchableOpacity\n                  key={s}\n                  style={[styles.pickerOption, size === s && styles.pickerOptionSelected]}\n                  onPress={() => {\n                    if (Platform.OS !== 'web') {\n                      Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Light);\n                    }\n                    setSize(s);\n                    setShowSizePicker(false);\n                  }}\n                  testID={`size-option-${s}`}\n                >\n                  <Text style={[styles.pickerOptionText, size === s && styles.pickerOptionTextSelected]}>\n                    {s}\n                  </Text>\n                </TouchableOpacity>\n              ))}\n            </View>\n          )}\n        </View>\n\n        <View style={styles.formSection}>\n          <Text style={styles.label}>Age (years) *</Text>\n          <TextInput\n            style={styles.input}\n            value={age}\n            onChangeText={setAge}\n            placeholder=\"Enter age\"\n            placeholderTextColor=\"#5a6040\"\n            keyboardType=\"numeric\"\n            testID=\"dog-age-input\"\n          />\n        </View>\n\n        <TouchableOpacity\n          style={[styles.nextButton, { marginBottom: insets.bottom + 20 }]}\n          onPress={handleNext}\n          testID=\"next-button\"\n        >\n          <Text style={styles.nextButtonText}>Next</Text>\n        </TouchableOpacity>\n      </ScrollView>\n    </>\n  );\n}\n\n// styles extracted to app/onboarding/dog-basics.styles.ts\n","import React, { useState, useEffect, useRef, useCallback } from 'react';\nimport { Text, View, StyleSheet, Platform, TouchableOpacity, Alert, ActivityIndicator, Animated, PanResponder, Dimensions, TextInput, Modal, ScrollView } from 'react-native';\n\nimport TrailMap from '@/components/TrailMap';\nimport * as Location from 'expo-location';\nimport * as TaskManager from 'expo-task-manager';\nimport * as Haptics from 'expo-haptics';\n\nimport { useLocalSearchParams, useRouter } from 'expo-router';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\n\nimport { Square, Play, MapPin, Watch, Bell, ChevronUp, Navigation, ChevronDown, Upload } from 'lucide-react-native';\nimport styles from './record.styles';\nimport colors from '@/constants/colors';\nimport { useTrails } from '@/context/TrailsContext';\nimport { useAuth } from '@/context/AuthContext';\n\nimport { Coordinate, Trail } from '@/types/trail';\n\nimport { formatDistance, calculateTotalDistance, formatDuration } from '@/utils/distance';\n\nconst LOCATION_TRACKING_TASK = 'background-location-task';\n\nif (Platform.OS !== 'web') {\n  TaskManager.defineTask(LOCATION_TRACKING_TASK, async ({ data, error }: { data: any; error: any }) => {\n    if (error) {\n      console.error('Background location error:', error);\n      return;\n    }\n    if (data) {\n      const { locations } = data as any;\n      const location = locations[0];\n      \n      if (location) {\n        console.log('Background location update:', location.coords);\n        \n        try {\n          const coordsStr = await AsyncStorage.getItem('recording_coordinates');\n          const coords = coordsStr ? JSON.parse(coordsStr) : [];\n          \n          const newCoord = {\n            latitude: location.coords.latitude,\n            longitude: location.coords.longitude,\n          };\n          \n          coords.push(newCoord);\n          await AsyncStorage.setItem('recording_coordinates', JSON.stringify(coords));\n          \n          if (location.coords.altitude) {\n            const currentElevation = Math.max(0, location.coords.altitude);\n            const maxElevationStr = await AsyncStorage.getItem('recording_max_elevation');\n            const maxElevation = maxElevationStr ? parseFloat(maxElevationStr) : 0;\n            \n            if (currentElevation > maxElevation) {\n              await AsyncStorage.setItem('recording_max_elevation', currentElevation.toString());\n            }\n          }\n          \n          if (location.coords.speed && location.coords.speed > 0) {\n            const currentSpeed = location.coords.speed * 3.6;\n            const maxSpeedStr = await AsyncStorage.getItem('recording_max_speed');\n            const maxSpeed = maxSpeedStr ? parseFloat(maxSpeedStr) : 0;\n            \n            if (currentSpeed > maxSpeed) {\n              await AsyncStorage.setItem('recording_max_speed', currentSpeed.toString());\n            }\n          }\n\n          await AsyncStorage.setItem('recording_last_update', Date.now().toString());\n        } catch (err) {\n          console.error('Error storing location:', err);\n        }\n      }\n    }\n  });\n}\n\nexport default function RecordScreen() {\n  const { saveTrail, getTrailById } = useTrails();\n  const { user } = useAuth();\n  const params = useLocalSearchParams();\n  const router = useRouter();\n  const trailId = typeof params.trailId === 'string' ? params.trailId : undefined;\n  const existingTrail = trailId ? getTrailById(trailId) : undefined;\n  const mapRef = useRef<any>(null);\n\n  const [isRecording, setIsRecording] = useState<boolean>(false);\n  const [coordinates, setCoordinates] = useState<Coordinate[]>([]);\n  const [currentLocation, setCurrentLocation] = useState<Coordinate | null>(null);\n  const [duration, setDuration] = useState<number>(0);\n  const [hasPermission, setHasPermission] = useState<boolean | null>(null);\n  const [isLoadingPermission, setIsLoadingPermission] = useState<boolean>(true);\n  const [startLocation, setStartLocation] = useState<{ city?: string; country?: string } | null>(null);\n  // geocoding removed  we rely on coordinates only\n\n  const locationSubscription = useRef<Location.LocationSubscription | null>(null);\n  const timerRef = useRef<ReturnType<typeof setInterval> | null>(null);\n\n  const bottomSheetHeight = Dimensions.get('window').height * 0.5;\n  const collapsedHeight = 280;\n  const navbarHeight = Platform.OS === 'ios' ? 100 : 92;\n  const bottomSheetAnim = useRef(new Animated.Value(collapsedHeight)).current;\n  const [isExpanded, setIsExpanded] = useState<boolean>(false);\n  const [elevation, setElevation] = useState<number>(0);\n  const [maxElevation, setMaxElevation] = useState<number>(0);\n  const [pace, setPace] = useState<string>('0:00');\n  const [speed, setSpeed] = useState<number>(0);\n  const [maxSpeed, setMaxSpeed] = useState<number>(0);\n  const [showSaveModal, setShowSaveModal] = useState<boolean>(false);\n  const [draftTrail, setDraftTrail] = useState<Partial<Trail> | null>(null);\n  // fields for the save form\n  const [formName, setFormName] = useState<string>('');\n  const [formDescription, setFormDescription] = useState<string>('');\n  const [formPhoto, setFormPhoto] = useState<string | undefined>(undefined);\n  const [formTags, setFormTags] = useState<string[]>([]);\n  const [formDifficulty, setFormDifficulty] = useState<string | undefined>(undefined);\n\n  useEffect(() => {\n    if (Platform.OS !== 'web') {\n      requestPermissions();\n      loadRecordingState();\n      \n      const interval = setInterval(() => {\n        loadRecordingState();\n      }, 1000);\n      \n      return () => {\n        clearInterval(interval);\n        if (locationSubscription.current) {\n          locationSubscription.current.remove();\n        }\n        if (timerRef.current) {\n          clearInterval(timerRef.current);\n        }\n      };\n    } else {\n      setIsLoadingPermission(false);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  const loadRecordingState = async () => {\n    try {\n      const coordsStr = await AsyncStorage.getItem('recording_coordinates');\n      if (coordsStr) {\n        const coords = JSON.parse(coordsStr);\n        setCoordinates(coords);\n      }\n      \n      const maxElevationStr = await AsyncStorage.getItem('recording_max_elevation');\n      if (maxElevationStr) {\n        setMaxElevation(parseFloat(maxElevationStr));\n      }\n      \n      const maxSpeedStr = await AsyncStorage.getItem('recording_max_speed');\n      if (maxSpeedStr) {\n        setMaxSpeed(parseFloat(maxSpeedStr));\n      }\n\n      if (isRecording) {\n        const startTimeStr = await AsyncStorage.getItem('recording_start_time');\n        if (startTimeStr) {\n          const startTime = parseInt(startTimeStr);\n          const elapsed = Math.floor((Date.now() - startTime) / 1000);\n          setDuration(elapsed);\n        }\n      }\n    } catch (error) {\n      console.error('Error loading recording state:', error);\n    }\n  };\n\n  const requestPermissions = async () => {\n    try {\n      console.log('Requesting location permissions...');\n      \n      const { status: foregroundStatus } = await Location.requestForegroundPermissionsAsync();\n      console.log('Foreground permission status:', foregroundStatus);\n      \n      if (foregroundStatus === 'granted') {\n        try {\n          const { status: backgroundStatus } = await Location.requestBackgroundPermissionsAsync();\n          console.log('Background permission status:', backgroundStatus);\n          \n          if (backgroundStatus !== 'granted') {\n            Alert.alert(\n              'Background Location Required',\n              'To continue recording your trail when the screen is locked, please enable \"Allow all the time\" in location settings.',\n              [{ text: 'OK' }]\n            );\n          }\n        } catch (bgError: any) {\n          console.warn('Background permission error (non-critical):', bgError.message);\n        }\n        \n        setHasPermission(true);\n        \n        try {\n          const location = await Location.getCurrentPositionAsync({\n            accuracy: Location.Accuracy.Balanced,\n          });\n          const coord = {\n            latitude: location.coords.latitude,\n            longitude: location.coords.longitude,\n          };\n          setCurrentLocation(coord);\n          console.log('Initial location:', coord);\n        } catch (locError: any) {\n          console.warn('Error getting initial location:', locError.message);\n        }\n      } else {\n        setHasPermission(false);\n        Alert.alert(\n          'Permission Required',\n          'Location permission is required to track your walks.',\n          [{ text: 'OK' }]\n        );\n      }\n    } catch (error: any) {\n      console.error('Permission error:', error);\n      const errorMessage = error.message || 'Failed to get location permission';\n      \n      if (errorMessage.includes('NSLocation') || errorMessage.includes('Info.plist')) {\n        Alert.alert(\n          'Configuration Error',\n          'This app needs to be built with a custom development build to use location tracking. Expo Go doesn\\'t support background location tracking.\\n\\nPlease contact support or build a custom development client.',\n          [{ text: 'OK' }]\n        );\n      } else {\n        Alert.alert('Error', errorMessage);\n      }\n      \n      setHasPermission(false);\n    } finally {\n      setIsLoadingPermission(false);\n    }\n  };\n\n  // removed getReverseGeocode to avoid geocoding rate limits; we don't need city/country\n\n  const startRecording = async () => {\n    if (Platform.OS !== 'web') {\n      Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Heavy);\n    }\n    console.log('Starting recording...');\n    setIsRecording(true);\n    setCoordinates([]);\n    setDuration(0);\n    setMaxElevation(0);\n    setMaxSpeed(0);\n\n    try {\n      const startTime = Date.now();\n      await AsyncStorage.setItem('recording_start_time', startTime.toString());\n      await AsyncStorage.removeItem('recording_coordinates');\n      await AsyncStorage.removeItem('recording_max_elevation');\n      await AsyncStorage.removeItem('recording_max_speed');\n      await AsyncStorage.removeItem('recording_last_update');\n      \n      const location = await Location.getCurrentPositionAsync({\n        accuracy: Location.Accuracy.Balanced,\n      });\n      \n      // do not perform reverse geocoding  only keep coordinates\n      setStartLocation(null);\n\n      const initialCoord = {\n        latitude: location.coords.latitude,\n        longitude: location.coords.longitude,\n      };\n      await AsyncStorage.setItem('recording_coordinates', JSON.stringify([initialCoord]));\n      setCoordinates([initialCoord]);\n      setCurrentLocation(initialCoord);\n\n      try {\n        await Location.startLocationUpdatesAsync(LOCATION_TRACKING_TASK, {\n          accuracy: Location.Accuracy.BestForNavigation,\n          distanceInterval: 3,\n          timeInterval: 1000,\n          foregroundService: {\n            notificationTitle: 'Recording Trail',\n            notificationBody: 'TailTrails is tracking your walk',\n            notificationColor: '#2563eb',\n          },\n          pausesUpdatesAutomatically: false,\n          showsBackgroundLocationIndicator: true,\n        });\n        console.log('Background location tracking started successfully');\n      } catch (bgLocationError: any) {\n        console.warn('Background location not available:', bgLocationError.message);\n        if (bgLocationError.message?.includes('Background location') || bgLocationError.message?.includes('UIBackgroundModes')) {\n          Alert.alert(\n            'Background Tracking Unavailable',\n            'Background location tracking requires a custom development build. The app will continue recording in foreground mode only. Please keep the app open while recording.',\n            [{ text: 'OK' }]\n          );\n        }\n      }\n\n      locationSubscription.current = await Location.watchPositionAsync(\n        {\n          accuracy: Location.Accuracy.BestForNavigation,\n          distanceInterval: 3,\n          timeInterval: 1000,\n        },\n        async (location) => {\n          const coord = {\n            latitude: location.coords.latitude,\n            longitude: location.coords.longitude,\n          };\n          console.log('Foreground position update:', coord, 'Accuracy:', location.coords.accuracy);\n          setCurrentLocation(coord);\n          \n          setCoordinates(prev => {\n            const newCoords = [...prev, coord];\n            console.log('Total coordinates:', newCoords.length, 'Distance:', calculateTotalDistance(newCoords), 'm');\n            AsyncStorage.setItem('recording_coordinates', JSON.stringify(newCoords)).catch(err => {\n              console.error('Error saving coordinates:', err);\n            });\n            return newCoords;\n          });\n          \n          if (location.coords.altitude) {\n            const currentElevation = Math.max(0, location.coords.altitude);\n            setElevation(currentElevation);\n            if (currentElevation > maxElevation) {\n              setMaxElevation(currentElevation);\n              await AsyncStorage.setItem('recording_max_elevation', currentElevation.toString());\n            }\n          }\n          \n          if (location.coords.speed && location.coords.speed > 0) {\n            const currentSpeed = location.coords.speed * 3.6;\n            setSpeed(currentSpeed);\n            if (currentSpeed > maxSpeed) {\n              setMaxSpeed(currentSpeed);\n              await AsyncStorage.setItem('recording_max_speed', currentSpeed.toString());\n            }\n          }\n        }\n      );\n\n      timerRef.current = setInterval(async () => {\n        try {\n          const startTimeStr = await AsyncStorage.getItem('recording_start_time');\n          if (startTimeStr) {\n            const startTime = parseInt(startTimeStr);\n            const elapsed = Math.floor((Date.now() - startTime) / 1000);\n            setDuration(elapsed);\n          }\n        } catch (error) {\n          console.error('Error calculating duration:', error);\n        }\n      }, 1000);\n    } catch (error: any) {\n      console.error('Recording error:', error);\n      let errorMessage = 'Failed to start recording. Please try again.';\n      \n      if (error.message?.includes('rate limit')) {\n        errorMessage = 'Please wait a moment before starting a new recording. Location service is temporarily limited.';\n      } else if (error.message?.includes('Background location') || error.message?.includes('UIBackgroundModes')) {\n        errorMessage = 'Background location tracking requires a custom development build. Please build the app with EAS or use foreground-only mode.';\n      }\n      \n      Alert.alert('Error', errorMessage);\n      setIsRecording(false);\n    }\n  };\n\n  useEffect(() => {\n    if (duration > 0) {\n      const distance = calculateTotalDistance(coordinates);\n      const distanceKm = distance / 1000;\n      const durationMin = duration / 60;\n      \n      if (distanceKm > 0) {\n        const paceMinPerKm = durationMin / distanceKm;\n        const minutes = Math.floor(paceMinPerKm);\n        const seconds = Math.round((paceMinPerKm - minutes) * 60);\n        setPace(`${minutes}:${seconds.toString().padStart(2, '0')}`);\n      }\n    }\n  }, [duration, coordinates]);\n\n  const initialHeight = useRef<number>(0);\n\n  const panResponder = useRef(\n    PanResponder.create({\n      onStartShouldSetPanResponder: () => true,\n      onMoveShouldSetPanResponder: (_, gestureState) => {\n        return Math.abs(gestureState.dy) > 5;\n      },\n      onPanResponderGrant: () => {\n        initialHeight.current = (bottomSheetAnim as any)._value;\n      },\n      onPanResponderMove: (_, gestureState) => {\n        const newValue = initialHeight.current - gestureState.dy;\n        \n        if (newValue >= collapsedHeight && newValue <= bottomSheetHeight) {\n          bottomSheetAnim.setValue(newValue);\n        }\n      },\n      onPanResponderRelease: (_, gestureState) => {\n        if (Platform.OS !== 'web') {\n          Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Light);\n        }\n        \n        const threshold = (bottomSheetHeight + collapsedHeight) / 2;\n        const currentValue = (bottomSheetAnim as any)._value;\n        \n        if (gestureState.dy < -50) {\n          expandBottomSheet();\n        } else if (gestureState.dy > 50) {\n          collapseBottomSheet();\n        } else if (currentValue > threshold) {\n          expandBottomSheet();\n        } else {\n          collapseBottomSheet();\n        }\n      },\n    })\n  ).current;\n\n  const expandBottomSheet = () => {\n    setIsExpanded(true);\n    Animated.spring(bottomSheetAnim, {\n      toValue: bottomSheetHeight,\n      useNativeDriver: false,\n      tension: 50,\n      friction: 8,\n    }).start();\n  };\n\n  const collapseBottomSheet = () => {\n    setIsExpanded(false);\n    Animated.spring(bottomSheetAnim, {\n      toValue: collapsedHeight,\n      useNativeDriver: false,\n      tension: 50,\n      friction: 8,\n    }).start();\n  };\n\n  const toggleBottomSheet = () => {\n    if (Platform.OS !== 'web') {\n      Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Light);\n    }\n    if (isExpanded) {\n      collapseBottomSheet();\n    } else {\n      expandBottomSheet();\n    }\n  };\n\n  const stopRecording = async () => {\n    if (Platform.OS !== 'web') {\n      Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Heavy);\n    }\n    console.log('Stopping recording...');\n    \n    try {\n      const hasTask = await TaskManager.isTaskRegisteredAsync(LOCATION_TRACKING_TASK);\n      if (hasTask) {\n        await Location.stopLocationUpdatesAsync(LOCATION_TRACKING_TASK);\n      }\n    } catch (error) {\n      console.error('Error stopping background location:', error);\n    }\n    \n    if (locationSubscription.current) {\n      locationSubscription.current.remove();\n      locationSubscription.current = null;\n    }\n\n    if (timerRef.current) {\n      clearInterval(timerRef.current);\n      timerRef.current = null;\n    }\n\n    const coordsStr = await AsyncStorage.getItem('recording_coordinates');\n    const finalCoords = coordsStr ? JSON.parse(coordsStr) : coordinates;\n    \n    const maxElevationStr = await AsyncStorage.getItem('recording_max_elevation');\n    const finalMaxElevation = maxElevationStr ? parseFloat(maxElevationStr) : maxElevation;\n    \n    const maxSpeedStr = await AsyncStorage.getItem('recording_max_speed');\n    const finalMaxSpeed = maxSpeedStr ? parseFloat(maxSpeedStr) : maxSpeed;\n\n    const startTimeStr = await AsyncStorage.getItem('recording_start_time');\n    const finalDuration = startTimeStr ? Math.floor((Date.now() - parseInt(startTimeStr)) / 1000) : duration;\n\n    if (finalCoords.length < 2) {\n      Alert.alert('No Trail Data', 'Not enough data to save this trail. Try walking a bit more!');\n      setIsRecording(false);\n      setCoordinates([]);\n      setDuration(0);\n      await AsyncStorage.removeItem('recording_coordinates');\n      await AsyncStorage.removeItem('recording_max_elevation');\n      await AsyncStorage.removeItem('recording_max_speed');\n      await AsyncStorage.removeItem('recording_start_time');\n      await AsyncStorage.removeItem('recording_last_update');\n      return;\n    }\n\n    const distance = calculateTotalDistance(finalCoords);\n    \n    const distanceKm = distance / 1000;\n    const durationMin = finalDuration / 60;\n    let finalPace = '0:00';\n    if (distanceKm > 0) {\n      const paceMinPerKm = durationMin / distanceKm;\n      const minutes = Math.floor(paceMinPerKm);\n      const seconds = Math.round((paceMinPerKm - minutes) * 60);\n      finalPace = `${minutes}:${seconds.toString().padStart(2, '0')}`;\n    }\n    \n    const trail: Trail = {\n      id: Date.now().toString(),\n      date: Date.now(),\n      distance,\n      duration: finalDuration,\n      coordinates: finalCoords,\n      city: startLocation?.city,\n      country: startLocation?.country,\n      pace: finalPace,\n      speed: finalMaxSpeed,\n      maxElevation: finalMaxElevation,\n    };\n    // Instead of POSTing immediately, open save modal with draft data\n    setDraftTrail(trail);\n    setFormName(trail.name || '');\n    setFormDescription((trail as any).description || '');\n    setFormPhoto((trail as any).photo || undefined);\n    setFormTags((trail as any).tags || []);\n    setFormDifficulty((trail as any).difficulty || undefined);\n    setShowSaveModal(true);\n    return;\n  };\n\n  const submitSave = async () => {\n    if (!draftTrail) return;\n    const toSave: Trail = {\n      ...(draftTrail as Trail),\n      name: formName || (draftTrail as any).name || 'Untitled Trail',\n      description: formDescription,\n      photo: formPhoto,\n      tags: formTags,\n      difficulty: formDifficulty,\n    };\n\n    try {\n      await saveTrail(toSave);\n      if (Platform.OS !== 'web') {\n        Haptics.notificationAsync(Haptics.NotificationFeedbackType.Success);\n      }\n      setShowSaveModal(false);\n      setDraftTrail(null);\n      setIsRecording(false);\n      setCoordinates([]);\n      setDuration(0);\n      setStartLocation(null);\n      setElevation(0);\n      setMaxElevation(0);\n      setPace('0:00');\n      setSpeed(0);\n      setMaxSpeed(0);\n\n      await AsyncStorage.removeItem('recording_coordinates');\n      await AsyncStorage.removeItem('recording_max_elevation');\n      await AsyncStorage.removeItem('recording_max_speed');\n      await AsyncStorage.removeItem('recording_start_time');\n      await AsyncStorage.removeItem('recording_last_update');\n\n      const savedId = (toSave as any).id || null;\n      if (savedId) router.push(`/trail/${savedId}`);\n      else Alert.alert('Success', 'Trail saved successfully!');\n    } catch (err) {\n      console.error('Save failed', err);\n      Alert.alert('Error', 'Failed to save trail');\n    }\n  };\n\n  const cancelSave = () => {\n    setShowSaveModal(false);\n    setDraftTrail(null);\n  };\n\n\n  if (isLoadingPermission && Platform.OS !== 'web') {\n    return (\n      <View style={styles.loadingContainer}>\n        <ActivityIndicator size=\"large\" color={colors.primary} />\n        <Text style={styles.loadingText}>Checking permissions...</Text>\n      </View>\n    );\n  }\n\n  // if (Platform.OS === 'web') {\n  //   return (\n  //     <View style={styles.webContainer}>\n  //       <MapPin size={64} color=\"#666\" />\n  //       <Text style={styles.webText}>GPS walk tracking is only available on mobile.</Text>\n  //     </View>\n  //   );\n  // }\n\n  if (!hasPermission) {\n    return (\n      <View style={styles.permissionContainer}>\n        <MapPin size={64} color=\"#666\" />\n        <Text style={styles.permissionTitle}>Location Permission Required</Text>\n        <Text style={styles.permissionText}>\n          This app needs access to your location to track your dog walks.\n        </Text>\n        <TouchableOpacity \n          style={styles.permissionButton} \n          onPress={() => {\n            if (Platform.OS !== 'web') {\n              Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Medium);\n            }\n            requestPermissions();\n          }}\n        >\n          <Text style={styles.permissionButtonText}>Grant Permission</Text>\n        </TouchableOpacity>\n      </View>\n    );\n  }\n\n  const distance = calculateTotalDistance(coordinates);\n  \n  const progress = existingTrail && isRecording && coordinates.length > 0 && existingTrail.coordinates.length > 0\n    ? Math.min((distance / existingTrail.distance) * 100, 100)\n    : 0;\n  \n  const showProgress = !!existingTrail;\n\n  const recenterMap = async () => {\n    if (Platform.OS !== 'web') {\n      Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Light);\n    }\n    if (mapRef.current) {\n      try {\n        const location = await Location.getCurrentPositionAsync({\n          accuracy: Location.Accuracy.Balanced,\n        });\n        const coord = {\n          latitude: location.coords.latitude,\n          longitude: location.coords.longitude,\n        };\n        setCurrentLocation(coord);\n        mapRef.current.animateToRegion({\n          latitude: coord.latitude,\n          longitude: coord.longitude,\n          latitudeDelta: 0.01,\n          longitudeDelta: 0.01,\n        }, 500);\n      } catch (error) {\n        console.error('Error getting current location:', error);\n        if (currentLocation) {\n          mapRef.current.animateToRegion({\n            latitude: currentLocation.latitude,\n            longitude: currentLocation.longitude,\n            latitudeDelta: 0.01,\n            longitudeDelta: 0.01,\n          }, 500);\n        }\n      }\n    }\n  };\n\n  return (\n    <View style={styles.container}>\n      {currentLocation && (\n        <TrailMap\n          ref={mapRef}\n          coordinates={coordinates}\n          style={styles.map}\n          initialRegion={{\n            latitude: currentLocation.latitude,\n            longitude: currentLocation.longitude,\n            latitudeDelta: 0.01,\n            longitudeDelta: 0.01,\n          }}\n          showsUserLocation\n          followsUserLocation={isRecording}\n          showsMyLocationButton={false}\n        />\n      )}\n\n      <TouchableOpacity\n        style={styles.recenterButton}\n        onPress={recenterMap}\n        activeOpacity={0.8}\n      >\n        <Navigation size={24} color={colors.primary} />\n      </TouchableOpacity>\n\n      <Animated.View\n        style={[\n          styles.bottomSheet,\n          {\n            height: Animated.add(bottomSheetAnim, navbarHeight),\n            bottom: 0,\n          },\n        ]}\n      >\n        <View {...panResponder.panHandlers} style={styles.handleBar}>\n          <TouchableOpacity\n            style={styles.handleContainer}\n            onPress={toggleBottomSheet}\n            activeOpacity={0.7}\n          >\n            <View style={styles.handle} />\n            {isExpanded ? (\n              <ChevronDown size={20} color=\"#9ca3af\" />\n            ) : (\n              <ChevronUp size={20} color=\"#9ca3af\" />\n            )}\n          </TouchableOpacity>\n        </View>\n\n        <View style={styles.bottomSheetContent}>\n          <View style={styles.statsGrid}>\n            <View style={styles.statItem}>\n              <Text style={styles.statItemLabel}>Time</Text>\n              <Text style={styles.statItemValue}>{formatDuration(duration)}</Text>\n            </View>\n            <View style={styles.statItem}>\n              <Text style={styles.statItemLabel}>Distance</Text>\n              <Text style={styles.statItemValue}>{formatDistance(distance)}</Text>\n            </View>\n            <View style={styles.statItem}>\n              <Text style={styles.statItemLabel}>Elevation</Text>\n              <Text style={styles.statItemValue}>{elevation.toFixed(0)}m</Text>\n            </View>\n            <View style={styles.statItem}>\n              <Text style={styles.statItemLabel}>Pace</Text>\n              <Text style={styles.statItemValue}>{pace}/km</Text>\n            </View>\n            <View style={styles.statItem}>\n              <Text style={styles.statItemLabel}>Speed</Text>\n              <Text style={styles.statItemValue}>{speed.toFixed(1)} km/h</Text>\n            </View>\n            {showProgress && (\n              <View style={styles.statItem}>\n                <Text style={styles.statItemLabel}>Progress</Text>\n                <Text style={styles.statItemValue}>{progress.toFixed(0)}%</Text>\n              </View>\n            )}\n          </View>\n\n          <TouchableOpacity\n            style={[\n              styles.recordButton,\n              isRecording && styles.recordButtonActive,\n            ]}\n            onPress={isRecording ? stopRecording : startRecording}\n            activeOpacity={0.8}\n          >\n            {isRecording ? (\n              <>\n                <Square size={24} color=\"#fff\" fill=\"#fff\" />\n                <Text style={styles.recordButtonText}>Stop & Save</Text>\n              </>\n            ) : (\n              <>\n                <Play size={24} color=\"#fff\" fill=\"#fff\" />\n                <Text style={styles.recordButtonText}>Start Trail</Text>\n              </>\n            )}\n          </TouchableOpacity>\n\n          {isExpanded && (\n            <View style={styles.expandedContent}>\n              <View style={styles.divider} />\n              \n              <TouchableOpacity\n                style={styles.optionRow}\n                onPress={() => {\n                  if (Platform.OS !== 'web') {\n                    Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Light);\n                  }\n                  Alert.alert('Apple Watch', 'Connect your Apple Watch to sync workout data.');\n                }}\n                activeOpacity={0.7}\n              >\n                <View style={styles.optionIconContainer}>\n                  <Watch size={24} color=\"#5d6b4a\" />\n                </View>\n                <View style={styles.optionTextContainer}>\n                  <Text style={styles.optionTitle}>Apple Watch</Text>\n                  <Text style={styles.optionSubtitle}>Not connected</Text>\n                </View>\n                <View style={styles.optionBadge}>\n                  <Text style={styles.optionBadgeText}>Connect</Text>\n                </View>\n              </TouchableOpacity>\n\n              <TouchableOpacity\n                style={styles.optionRow}\n                onPress={() => {\n                  if (Platform.OS !== 'web') {\n                    Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Light);\n                  }\n                  Alert.alert('Alerts', 'Configure alerts for distance milestones and pace notifications.');\n                }}\n                activeOpacity={0.7}\n              >\n                <View style={styles.optionIconContainer}>\n                  <Bell size={24} color=\"#5d6b4a\" />\n                </View>\n                <View style={styles.optionTextContainer}>\n                  <Text style={styles.optionTitle}>Alerts</Text>\n                  <Text style={styles.optionSubtitle}>Distance & pace notifications</Text>\n                </View>\n                <View style={[styles.optionBadge, styles.optionBadgeActive]}>\n                  <Text style={[styles.optionBadgeText, styles.optionBadgeTextActive]}>Active</Text>\n                </View>\n              </TouchableOpacity>\n            </View>\n          )}\n        </View>\n      </Animated.View>\n      <Modal\n        visible={showSaveModal}\n        animationType=\"slide\"\n        transparent={true}\n        onRequestClose={cancelSave}\n      >\n        <View style={styles.modalOverlay}>\n          <View style={styles.modalContainer}>\n            <ScrollView contentContainerStyle={styles.modalContent}>\n              <Text style={styles.modalTitle}>Save Trail</Text>\n              <TextInput\n                placeholder=\"Trail name\"\n                value={formName}\n                onChangeText={setFormName}\n                style={styles.input}\n              />\n              <TextInput\n                placeholder=\"Description\"\n                value={formDescription}\n                onChangeText={setFormDescription}\n                style={[styles.input, { height: 100 }]}\n                multiline\n              />\n              <TextInput\n                placeholder=\"Photo URL (optional)\"\n                value={formPhoto}\n                onChangeText={setFormPhoto}\n                style={styles.input}\n              />\n\n              <View style={{ flexDirection: 'row', gap: 8, marginTop: 8 }}>\n                <TouchableOpacity style={styles.modalButton} onPress={cancelSave}>\n                  <Text style={styles.modalButtonText}>Cancel</Text>\n                </TouchableOpacity>\n                <TouchableOpacity style={[styles.modalButton, styles.modalButtonPrimary]} onPress={submitSave}>\n                  <Text style={[styles.modalButtonText, { color: '#fff' }]}>Save Trail</Text>\n                </TouchableOpacity>\n              </View>\n            </ScrollView>\n          </View>\n        </View>\n      </Modal>\n    </View>\n  );\n}\n\n// styles are imported from record.styles.ts\n","import { StyleSheet } from 'react-native';\nimport colors from '@/constants/colors';\n\nexport default StyleSheet.create({\n  container: {\n    width: '100%',\n    paddingHorizontal: 0,\n    paddingTop: 0,\n    alignItems: 'center',\n  },\n  tabBar: {\n    flexDirection: 'row',\n    backgroundColor: colors.tabBarBg,\n    borderRadius: 0,\n    paddingVertical: 8,\n    paddingHorizontal: 8,\n    justifyContent: 'space-around',\n    alignItems: 'center',\n    shadowColor: '#000',\n    shadowOffset: { width: 0, height: 4 },\n    shadowOpacity: 0.3,\n    shadowRadius: 8,\n    elevation: 8,\n    width: '100%',\n    gap: 6,\n  },\n  tabButton: {\n    height: 44,\n    borderRadius: 22,\n    overflow: 'hidden',\n    justifyContent: 'center',\n    alignItems: 'center',\n  },\n  tabTouchable: {\n    flex: 1,\n    width: '100%',\n    justifyContent: 'center',\n    alignItems: 'center',\n  },\n  tabContent: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'center',\n    gap: 8,\n    paddingHorizontal: 0,\n  },\n  iconWrapper: {\n    width: 22,\n    height: 22,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  label: {\n    color: colors.accent,\n    fontSize: 13,\n    fontWeight: '600',\n  },\n});\n","import React, { useEffect, useRef } from 'react';\nimport { TouchableOpacity, View, StyleSheet, Animated, Text, Platform } from 'react-native';\nimport type { BottomTabBarProps } from '@react-navigation/bottom-tabs';\nimport { useSafeAreaInsets } from 'react-native-safe-area-context';\nimport * as Haptics from 'expo-haptics';\nimport styles from './AnimatedTabBar.styles';\nimport colors from '@/constants/colors';\n\n\nconsole.log('[init] components/AnimatedTabBar.tsx loaded');\n\nexport function AnimatedTabBar({ state, descriptors, navigation }: BottomTabBarProps) {\n  const insets = useSafeAreaInsets();\n  const animatedValues = useRef(\n    state.routes.map(() => new Animated.Value(0))\n  ).current;\n\n  useEffect(() => {\n    // Debug: log current navigation state to detect unexpected extra tabs\n    console.log('AnimatedTabBar state.index:', state.index);\n    console.log('AnimatedTabBar routes:', state.routes.map(r => ({ name: r.name, key: r.key })));\n    console.log('AnimatedTabBar descriptors keys:', Object.keys(descriptors));\n\n    state.routes.forEach((route, index) => {\n      Animated.timing(animatedValues[index], {\n        toValue: state.index === index ? 1 : 0,\n        duration: 300,\n        useNativeDriver: false,\n      }).start();\n    });\n  }, [state.index, state.routes, animatedValues]);\n\n  // Put the safe-area padding on the tabBar itself so its background\n  // extends to the bottom of the screen and there is no white gap.\n  const tabBarPaddingBottom = Math.max(insets.bottom, Platform.OS === 'android' ? 12 : 8);\n\n  return (\n    <View style={styles.container}>\n      <View style={[styles.tabBar, { paddingBottom: tabBarPaddingBottom }]}>\n        {/**\n         * Render only routes that expose tab bar options (title/label/icon).\n         * File-based routing sometimes injects extra routes; this guard\n         * prevents rendering unexpected tabs while we diagnose the cause.\n         */}\n        {state.routes\n          .filter(route => {\n            const opts = descriptors[route.key]?.options;\n            return !!(opts && (opts.tabBarLabel || opts.title || opts.tabBarIcon));\n          })\n          .map((route, index) => {\n          const { options } = descriptors[route.key];\n          const label = options.tabBarLabel !== undefined\n            ? options.tabBarLabel\n            : options.title !== undefined\n            ? options.title\n            : route.name;\n\n          const isFocused = state.index === index;\n\n          const onPress = () => {\n            if (Platform.OS !== 'web') {\n              Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Light);\n            }\n\n            const event = navigation.emit({\n              type: 'tabPress',\n              target: route.key,\n              canPreventDefault: true,\n            });\n\n            if (!isFocused && !event.defaultPrevented) {\n              navigation.navigate(route.name);\n            }\n          };\n\n          const animatedValue = animatedValues[index];\n\n          const containerWidth = animatedValue.interpolate({\n            inputRange: [0, 1],\n            outputRange: [44, 100],\n          });\n\n          const backgroundColor = animatedValue.interpolate({\n            inputRange: [0, 1],\n            outputRange: ['rgba(40, 46, 16, 0.6)', 'rgba(40, 46, 16, 0.9)'],\n          });\n\n          const textOpacity = animatedValue.interpolate({\n            inputRange: [0, 0.5, 1],\n            outputRange: [0, 0, 1],\n          });\n\n          const iconColor = isFocused ? colors.accent : colors.muted || colors.light.tabIconDefault;\n\n          return (\n            <Animated.View\n              key={route.key}\n              style={[\n                styles.tabButton,\n                {\n                  width: containerWidth,\n                  backgroundColor,\n                },\n              ]}\n            >\n              <TouchableOpacity\n                accessibilityRole=\"button\"\n                accessibilityState={isFocused ? { selected: true } : {}}\n                accessibilityLabel={options.tabBarAccessibilityLabel}\n                onPress={onPress}\n                style={styles.tabTouchable}\n              >\n                <View style={styles.tabContent}>\n                  <View style={styles.iconWrapper}>\n                    {options.tabBarIcon && options.tabBarIcon({ \n                      focused: isFocused, \n                      color: iconColor, \n                      size: 22 \n                    })}\n                  </View>\n                  <Animated.View style={{ opacity: textOpacity }}>\n                    {isFocused && (\n                      <Text style={styles.label}>{String(label)}</Text>\n                    )}\n                  </Animated.View>\n                </View>\n              </TouchableOpacity>\n            </Animated.View>\n          );\n        })}\n      </View>\n    </View>\n  );\n}\n","import { Tabs } from 'expo-router';\n\nimport { Navigation, MapPin, User } from 'lucide-react-native';\nimport { AnimatedTabBar } from '@/components/AnimatedTabBar';\nimport colors from '@/constants/colors';\n\nexport default function TabLayout() {\n  return (\n    <Tabs\n      tabBar={(props) => <AnimatedTabBar {...props} />}\n      screenOptions={{\n        headerShown: false,\n        tabBarActiveTintColor: colors.light.tabIconSelected,\n        tabBarInactiveTintColor: colors.light.tabIconDefault,\n      }}\n    >\n      <Tabs.Screen\n        name=\"explore\"\n        options={{\n          title: 'Explore',\n          tabBarIcon: ({ color, size }) => <MapPin size={size} color={color} />,\n        }}\n      />\n      <Tabs.Screen\n        name=\"record\"\n        options={{\n          title: 'Record',\n          tabBarIcon: ({ color, size }) => <Navigation size={size} color={color} />,\n        }}\n      />\n      <Tabs.Screen\n        name=\"profile\"\n        options={{\n          title: 'Profile',\n          tabBarIcon: ({ color, size }) => <User size={size} color={color} />,\n        }}\n      />\n    </Tabs>\n  );\n}\n","import { Redirect } from 'expo-router';\n\nexport default function Index() {\n  return <Redirect href=\"/(tabs)/explore\" />;\n}\n","\nimport React from 'react';\nimport { Text, View, StyleSheet, ScrollView, TouchableOpacity } from 'react-native';\n\nimport { Stack } from 'expo-router';\nimport TrailMap from '@/components/TrailMap';\n\nimport { Clock, MapPin, Navigation, ArrowLeft, TrendingUp } from 'lucide-react-native';\nimport colors from '@/constants/colors';\n\nimport { formatDistance, formatDuration } from '@/utils/distance';\nimport { useRouter } from 'expo-router';\n\nconst DEMO_TRAIL = {\n  id: 'demo-trail',\n  name: 'Scenic Coastal Walk',\n  distance: 5210,\n  duration: 3600,\n  \n  coordinates: [\n    { latitude: 50.81999932593175, longitude: -0.1443926504884132 },\n    { latitude: 50.81982005377856, longitude: -0.14389605957015306 },\n    { latitude: 50.8195735534442, longitude: -0.14290287773496857 },\n    { latitude: 50.81976403108945, longitude: -0.14245949298612004 },\n    { latitude: 50.819651985510006, longitude: -0.1415904588798469 },\n    { latitude: 50.819360665744455, longitude: -0.141129338740825 },\n    { latitude: 50.81955114425804, longitude: -0.14054407087405707 },\n    { latitude: 50.8194278935438, longitude: -0.1397814491065219 },\n    { latitude: 50.819282233189426, longitude: -0.1389301503892284 },\n    { latitude: 50.819696803774036, longitude: -0.13903656272921694 },\n    { latitude: 50.81999932593175, longitude: -0.13919618123853184 },\n    { latitude: 50.82010016621547, longitude: -0.13853997181101363 },\n    { latitude: 50.82041389015009, longitude: -0.138220734792327 },\n    { latitude: 50.82055954697452, longitude: -0.13852223642078343 },\n    { latitude: 50.82086206354296, longitude: -0.13829167635185513 },\n  ],\n  city: 'Brighton',\n  country: 'UK',\n  difficulty: 'Easy',\n  pace: '11:32',\n  maxElevation: 45,\n};\n\nexport default function DemoTrailScreen() {\n  const router = useRouter();\n\n  return (\n    <View style={styles.container}>\n      <Stack.Screen \n        options={{\n          title: 'Demo Trail',\n          headerShown: false,\n        }} \n      />\n      \n      <ScrollView style={styles.scrollView}>\n        <View style={styles.header}>\n          <TouchableOpacity \n            style={styles.backButton}\n            onPress={() => router.back()}\n          >\n            <ArrowLeft size={24} color=\"#fff\" />\n          </TouchableOpacity>\n          <View style={styles.headerContent}>\n            <Text style={styles.title}>{DEMO_TRAIL.name}</Text>\n            <View style={styles.locationRow}>\n              <MapPin size={16} color=\"#fff\" />\n              <Text style={styles.locationText}>{DEMO_TRAIL.city}, {DEMO_TRAIL.country}</Text>\n            </View>\n          </View>\n        </View>\n\n        <View style={styles.mapContainer}>\n          <TrailMap\n            coordinates={DEMO_TRAIL.coordinates}\n            style={styles.map}\n            scrollEnabled={true}\n            zoomEnabled={true}\n          />\n        </View>\n\n        <View style={styles.statsContainer}>\n          <View style={styles.statItem}>\n            <Navigation size={20} color={colors.primary} />\n            <Text style={styles.statValue}>{formatDistance(DEMO_TRAIL.distance)}</Text>\n            <Text style={styles.statLabel}>Distance</Text>\n          </View>\n          <View style={styles.statItem}>\n            <Clock size={20} color={colors.primary} />\n            <Text style={styles.statValue}>{formatDuration(DEMO_TRAIL.duration)}</Text>\n            <Text style={styles.statLabel}>Time</Text>\n          </View>\n          <View style={styles.statItem}>\n            <TrendingUp size={20} color={colors.primary} />\n            <Text style={styles.statValue}>{DEMO_TRAIL.maxElevation}m</Text>\n            <Text style={styles.statLabel}>Elevation</Text>\n          </View>\n        </View>\n\n        <View style={styles.section}>\n          <Text style={styles.sectionTitle}>About this trail</Text>\n          <Text style={styles.description}>\n            This is a beautiful coastal walk along the Brighton seafront. \n            Perfect for a morning stroll with your dog. The path is paved and \n            offers stunning views of the English Channel.\n          </Text>\n        </View>\n      </ScrollView>\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: colors.background,\n  },\n  scrollView: {\n    flex: 1,\n  },\n  header: {\n    height: 200,\n    backgroundColor: colors.primary,\n    justifyContent: 'flex-end',\n    padding: 20,\n  },\n  backButton: {\n    position: 'absolute',\n    top: 50,\n    left: 20,\n    zIndex: 10,\n  },\n  headerContent: {\n    marginBottom: 10,\n  },\n  title: {\n    fontSize: 28,\n    fontWeight: 'bold',\n    color: '#fff',\n    marginBottom: 5,\n  },\n  locationRow: {\n    flexDirection: 'row',\n    alignItems: 'center',\n  },\n  locationText: {\n    color: '#fff',\n    marginLeft: 5,\n    fontSize: 16,\n  },\n  mapContainer: {\n    height: 300,\n    width: '100%',\n  },\n  map: {\n    flex: 1,\n  },\n  statsContainer: {\n    flexDirection: 'row',\n    justifyContent: 'space-around',\n    padding: 20,\n  backgroundColor: colors.surface,\n  borderBottomWidth: 1,\n  borderBottomColor: colors.border,\n  },\n  statItem: {\n    alignItems: 'center',\n  },\n  statValue: {\n    fontSize: 18,\n    fontWeight: 'bold',\n    marginTop: 5,\n    color: '#333',\n  },\n  statLabel: {\n    fontSize: 12,\n    color: '#666',\n    marginTop: 2,\n  },\n  section: {\n    padding: 20,\n  },\n  sectionTitle: {\n    fontSize: 20,\n    fontWeight: 'bold',\n    marginBottom: 10,\n    color: '#333',\n  },\n  description: {\n    fontSize: 16,\n    lineHeight: 24,\n    color: '#666',\n  },\n});\n","// On web, allow a runtime global (injected by index.html or hosting) to override process.env.\ndeclare const global: any;\nconst runtimeUrl = typeof window !== 'undefined' ? (window as any).__EXPO_PUBLIC_API_URL__ : undefined;\nexport const API_URL = runtimeUrl || process.env.EXPO_PUBLIC_API_URL || 'http://localhost:8080';\n\n// Helpful at runtime to know which endpoint is being used.\nconsole.log('Current API URL:', API_URL);\n// Helpers for base64url <-> ArrayBuffer conversions used by WebAuthn flows on web\nexport function base64UrlToBuffer(base64Url: string): Uint8Array {\n\tconst padding = '='.repeat((4 - (base64Url.length % 4)) % 4);\n\tconst base64 = (base64Url + padding).replace(/-/g, '+').replace(/_/g, '/');\n\tconst raw = typeof atob === 'function' ? atob(base64) : Buffer.from(base64, 'base64').toString('binary');\n\tconst rawLength = raw.length;\n\tconst array = new Uint8Array(rawLength);\n\tfor (let i = 0; i < rawLength; ++i) {\n\t\tarray[i] = raw.charCodeAt(i);\n\t}\n\treturn array;\n}\n\nexport function bufferToBase64Url(buffer: ArrayBuffer | Uint8Array): string {\n\tconst bytes = buffer instanceof Uint8Array ? buffer : new Uint8Array(buffer);\n\tlet binary = '';\n\tfor (let i = 0; i < bytes.byteLength; i++) {\n\t\tbinary += String.fromCharCode(bytes[i]);\n\t}\n\tconst b64 = typeof btoa === 'function' ? btoa(binary) : Buffer.from(binary, 'binary').toString('base64');\n\treturn b64.replace(/\\+/g, '-').replace(/\\//g, '_').replace(/=+$/, '');\n}\n\n// Frontend helpers to call WebAuthn-related backend endpoints\nexport async function webauthnRegisterOptions(email: string, name?: string) {\n\tconst res = await fetch(`${API_URL}/webauthn/register/options`, {\n\t\tmethod: 'POST',\n\t\theaders: { 'Content-Type': 'application/json' },\n\t\tbody: JSON.stringify({ email, name }),\n\t});\n\tif (!res.ok) {\n\t\tconst err = await res.json().catch(() => ({}));\n\t\tthrow new Error(err.detail || 'Failed to get registration options');\n\t}\n\treturn res.json();\n}\n\nexport async function webauthnRegisterVerify(payload: Record<string, any>) {\n\tconst res = await fetch(`${API_URL}/webauthn/register/verify`, {\n\t\tmethod: 'POST',\n\t\theaders: { 'Content-Type': 'application/json' },\n\t\tbody: JSON.stringify(payload),\n\t});\n\tif (!res.ok) {\n\t\tconst err = await res.json().catch(() => ({}));\n\t\tthrow new Error(err.detail || 'Failed to verify registration');\n\t}\n\treturn res.json();\n}\n\nexport async function webauthnAuthOptions(email: string) {\n\tconst res = await fetch(`${API_URL}/webauthn/auth/options`, {\n\t\tmethod: 'POST',\n\t\theaders: { 'Content-Type': 'application/json' },\n\t\tbody: JSON.stringify({ email }),\n\t});\n\tif (!res.ok) {\n\t\tconst err = await res.json().catch(() => ({}));\n\t\tthrow new Error(err.detail || 'Failed to get auth options');\n\t}\n\treturn res.json();\n}\n\nexport async function webauthnAuthVerify(payload: Record<string, any>) {\n\tconst res = await fetch(`${API_URL}/webauthn/auth/verify`, {\n\t\tmethod: 'POST',\n\t\theaders: { 'Content-Type': 'application/json' },\n\t\tbody: JSON.stringify(payload),\n\t});\n\tif (!res.ok) {\n\t\tconst err = await res.json().catch(() => ({}));\n\t\tthrow new Error(err.detail || 'Failed to verify authentication');\n\t}\n\treturn res.json();\n}","import React, { useState, useEffect } from 'react';\nimport { Text, View, TouchableOpacity, ScrollView, Platform, Alert, ActivityIndicator } from 'react-native';\nimport { useRouter, Stack, useLocalSearchParams } from 'expo-router';\nimport * as Haptics from 'expo-haptics';\nimport { ChevronLeft } from 'lucide-react-native';\nimport { useSafeAreaInsets } from 'react-native-safe-area-context';\nimport styles from './dog-personality.styles';\nimport { RECALL_RELIABILITY_OPTIONS, PERSONALITY_TAGS, RecallReliability } from '@/types/dog-profile';\nimport { useAuth } from '@/context/AuthContext';\nimport { useDogs } from '@/context/DogsContext';\n\nexport default function DogPersonalityScreen() {\n  const router = useRouter();\n  const params = useLocalSearchParams<{\n    name: string;\n    nickname?: string;\n    age: string;\n    size: string;\n    photo?: string;\n    isEditing?: string;\n  }>();\n  const { user } = useAuth();\n  const { dogProfile, refreshDogProfile, createDogProfile, updateDogProfile } = useDogs();\n  const insets = useSafeAreaInsets();\n  const [selectedTags, setSelectedTags] = useState<string[]>([]);\n  const [recallReliability, setRecallReliability] = useState<RecallReliability>('Fair');\n  const [isSaving, setIsSaving] = useState<boolean>(false);\n  const isEditing = params.isEditing === 'true';\n\n  useEffect(() => {\n    if (dogProfile && isEditing) {\n      console.log('Loading existing personality tags for editing:', dogProfile.personality_tags);\n      setSelectedTags(dogProfile.personality_tags || []);\n      setRecallReliability(dogProfile.recall_reliability || 'Fair');\n    }\n  }, [dogProfile, isEditing]);\n\n  const toggleTag = (tag: string) => {\n    if (Platform.OS !== 'web') {\n      Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Light);\n    }\n\n    setSelectedTags((prev) =>\n      prev.includes(tag) ? prev.filter((t) => t !== tag) : [...prev, tag]\n    );\n  };\n\n  const handleFinish = async () => {\n    if (!user) {\n      Alert.alert('Error', 'You must be logged in to create a dog profile');\n      return;\n    }\n\n    if (Platform.OS !== 'web') {\n      Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Medium);\n    }\n\n    setIsSaving(true);\n\n    try {\n      console.log(isEditing ? 'Updating dog profile for user:' : 'Creating dog profile for user:', user.id);\n\n      const profileData = {\n        user_id: user.id,\n        name: params.name,\n        nickname: params.nickname || undefined,\n        size: params.size as any,\n        age: parseInt(params.age, 10),\n        photo: params.photo || undefined,\n        personality_tags: selectedTags,\n        recall_reliability: recallReliability,\n      };\n\n      console.log('Dog profile data:', profileData);\n\n      if (isEditing && dogProfile?.id) {\n        await updateDogProfile({ ...profileData, id: dogProfile.id });\n      } else {\n        await createDogProfile(profileData);\n      }\n\n      if (Platform.OS !== 'web') {\n        Haptics.notificationAsync(Haptics.NotificationFeedbackType.Success);\n      }\n\n      if (isEditing) {\n        router.replace('/(tabs)/profile');\n      } else {\n        router.replace('/(tabs)/explore');\n      }\n    } catch (error: any) {\n      console.error('Error saving dog profile:', error);\n      Alert.alert('Error', error.message || 'Failed to save dog profile');\n      setIsSaving(false);\n    }\n\n  };\n\n  return (\n    <>\n      <Stack.Screen options={{ headerShown: false }} />\n      <View style={[styles.container, { paddingTop: insets.top + 20 }]}> \n        <ScrollView style={styles.scrollView} contentContainerStyle={styles.content}>\n          <View style={styles.header}>\n            <Text style={styles.title}>Personality & Behaviour</Text>\n            <Text style={styles.subtitle}>Choose the tags that best describe your dog</Text>\n            {!isEditing && (\n              <View style={styles.progressContainer}>\n                <View style={styles.progressDot} />\n                <View style={[styles.progressDot, styles.progressDotActive]} />\n              </View>\n            )}\n          </View>\n\n          <View style={styles.tagsContainer}>\n            {PERSONALITY_TAGS.map((tag) => (\n              <TouchableOpacity\n                key={tag}\n                style={[\n                  styles.tag,\n                  selectedTags.includes(tag) && styles.tagSelected,\n                ]}\n                onPress={() => toggleTag(tag)}\n                testID={`tag-${tag}`}\n              >\n                <Text\n                  style={[\n                    styles.tagText,\n                    selectedTags.includes(tag) && styles.tagTextSelected,\n                  ]}\n                >\n                  {tag}\n                </Text>\n              </TouchableOpacity>\n            ))}\n          </View>\n\n          <View style={styles.sectionHeader}>\n            <Text style={styles.sectionTitle}>Health & Safety</Text>\n          </View>\n\n          <View style={styles.section}>\n            <Text style={styles.label}>Recall Reliability</Text>\n            <Text style={styles.helperText}>How reliably does your dog return when called?</Text>\n            <View style={styles.recallContainer}>\n              {RECALL_RELIABILITY_OPTIONS.map((option) => (\n                <TouchableOpacity\n                  key={option}\n                  style={[\n                    styles.recallOption,\n                    recallReliability === option && styles.recallOptionSelected,\n                  ]}\n                  onPress={() => {\n                    if (Platform.OS !== 'web') {\n                      Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Light);\n                    }\n                    setRecallReliability(option);\n                  }}\n                  testID={`recall-${option}`}\n                >\n                  <Text\n                    style={[\n                      styles.recallText,\n                      recallReliability === option && styles.recallTextSelected,\n                    ]}\n                  >\n                    {option}\n                  </Text>\n                </TouchableOpacity>\n              ))}\n            </View>\n          </View>\n        </ScrollView>\n\n        <View style={[styles.footer, { paddingBottom: insets.bottom + 20 }]}>\n          <TouchableOpacity\n            style={styles.backButton}\n            onPress={() => router.back()}\n            disabled={isSaving}\n            testID=\"back-button\"\n          >\n            <ChevronLeft size={24} color=\"#FFFE77\" />\n            <Text style={styles.backButtonText}>Back</Text>\n          </TouchableOpacity>\n\n          <TouchableOpacity\n            style={[styles.finishButton, isSaving && styles.finishButtonDisabled]}\n            onPress={handleFinish}\n            disabled={isSaving}\n            testID=\"finish-button\"\n          >\n            {isSaving ? (\n              <ActivityIndicator color=\"#1a1f0a\" />\n            ) : (\n              <Text style={styles.finishButtonText}>{isEditing ? 'Save' : 'Finish'}</Text>\n            )}\n          </TouchableOpacity>\n        </View>\n      </View>\n    </>\n  );\n}\n","import React, { useEffect, useCallback, useState, useMemo } from 'react';\nimport createContextHook from '@nkzw/create-context-hook';\nimport { useAuth } from '@/context/AuthContext';\nimport { Trail } from '@/types/trail';\nimport { API_URL } from '@/lib/api';\n\nexport const [TrailsContext, useTrails] = createContextHook(() => {\n  const { user, session } = useAuth();\n  const [trails, setTrails] = useState<Trail[]>([]);\n  const [savedTrails, setSavedTrails] = useState<Trail[]>([]);\n  const [isLoading, setIsLoading] = useState<boolean>(true);\n  const [isSavedLoading, setIsSavedLoading] = useState<boolean>(true);\n\n  const loadTrails = useCallback(async () => {\n    if (!user || !session) {\n      // even unauthenticated users can fetch public trails\n      try {\n        const resp = await fetch(`${API_URL}/trail`);\n        if (resp.ok) {\n          const data = await resp.json();\n          setTrails(data || []);\n        } else {\n          console.error('Failed to load trails (public):', resp.status);\n          setTrails([]);\n        }\n      } catch (err) {\n        console.error('Failed to load trails:', err);\n        setTrails([]);\n      } finally {\n        setIsLoading(false);\n      }\n      return;\n    }\n\n    try {\n      console.log('Loading trails for user:', user.id);\n      const resp = await fetch(`${API_URL}/trail`, {\n        headers: {\n          'Authorization': `Bearer ${session?.accessToken}`,\n        },\n      });\n      if (resp.ok) {\n        const data = await resp.json();\n        setTrails(data || []);\n      } else {\n        console.error('Failed to load trails:', resp.status);\n        setTrails([]);\n      }\n    } catch (error) {\n      console.error('Failed to load trails:', error);\n    } finally {\n      setIsLoading(false);\n    }\n  }, [user, session]);\n\n  const loadSavedTrails = useCallback(async () => {\n    // The API currently exposes /trail/me for the current user's trails.\n    if (!session?.accessToken) {\n      setSavedTrails([]);\n      setIsSavedLoading(false);\n      return;\n    }\n\n    try {\n      console.log('Loading my trails for user:', user?.id);\n      const resp = await fetch(`${API_URL}/trail/me`, {\n        headers: {\n          'Authorization': `Bearer ${session?.accessToken}`,\n        },\n      });\n      if (resp.ok) {\n        const data = await resp.json();\n        setSavedTrails(data || []);\n      } else {\n        console.error('Failed to load my trails:', resp.status);\n        setSavedTrails([]);\n      }\n    } catch (error) {\n      console.error('Failed to load saved trails:', error);\n      setSavedTrails([]);\n    } finally {\n      setIsSavedLoading(false);\n    }\n  }, [user, session]);\n\n  useEffect(() => {\n    loadTrails();\n    loadSavedTrails();\n  }, [loadTrails, loadSavedTrails]);\n\n  const saveTrail = useCallback(async (trail: Trail) => {\n    if (!user) {\n      console.error('No user logged in');\n      throw new Error('Must be logged in to save trails');\n    }\n    if (!session?.accessToken) {\n      console.error('No session/access token available');\n      throw new Error('Must be logged in to save trails');\n    }\n    try {\n      console.log('Saving trail for user via API:', user.id);\n\n      // Prepare a path array (lon, lat) expected by backend\n      const coordsToPath = (coords: { latitude: number; longitude: number }[] | undefined) => {\n        if (!coords || coords.length === 0) return [] as number[][];\n        return coords.map(c => [c.longitude, c.latitude]);\n      };\n\n      const body: any = {\n        name: trail.name,\n        distance: trail.distance,\n        duration: trail.duration,\n        path: coordsToPath((trail as any).coordinates),\n        photo: (trail as any).photo,\n        city: trail.city,\n        country: trail.country,\n        description: (trail as any).description,\n        tags: (trail as any).tags,\n        elevation: (trail as any).elevation,\n        surface_type: (trail as any).surfaceType,\n        difficulty: (trail as any).difficulty,\n        location: (trail as any).location,\n        pace: trail.pace,\n        speed: trail.speed,\n        max_elevation: trail.maxElevation,\n        rating: trail.rating,\n        review: trail.review,\n        environment_tags: (trail as any).environment_tags,\n      };\n\n      const accessToken = session.accessToken;\n      const resp = await fetch(`${API_URL}/trail/me`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${accessToken}`,\n        },\n        body: JSON.stringify(body),\n      });\n\n      if (!resp.ok) {\n        const err = await resp.text();\n        console.error('Failed to save trail via API:', resp.status, err);\n        throw new Error('Failed to save trail');\n      }\n\n      const data = await resp.json();\n      // Assume API returns created trail that matches our Trail type\n      setTrails((prev: Trail[]) => [data, ...prev]);\n      return data as Trail;\n    } catch (error) {\n      console.error('Failed to save trail:', error);\n      throw error;\n    }\n  }, [user, session]);\n\n  const deleteTrail = useCallback(async (id: string) => {\n    try {\n      console.log('Deleting trail via API:', id);\n      if (!session?.accessToken) throw new Error('Not authenticated');\n      const resp = await fetch(`${API_URL}/trail/${id}`, {\n        method: 'DELETE',\n        headers: { 'Authorization': `Bearer ${session.accessToken}` },\n      });\n      if (resp.status === 204) {\n        setTrails((prev: Trail[]) => prev.filter((t: Trail) => t.id !== id));\n      } else {\n        const body = await resp.text();\n        console.error('Failed to delete trail:', resp.status, body);\n        throw new Error('Failed to delete trail');\n      }\n    } catch (error) {\n      console.error('Failed to delete trail:', error);\n      throw error;\n    }\n  }, [session]);\n\n  const getTrailById = useCallback((id: string): Trail | undefined => {\n    const found = trails.find((t: Trail) => t.id === id);\n    if (found) return found;\n\n    // If not in state, try fetching from API synchronously is not possible here  keep demo fallback\n    if (id === 'demo-trail') {\n      return {\n        id: 'demo-trail',\n        name: 'Scenic Coastal Walk',\n        distance: 5.2,\n        duration: 3600,\n        coordinates: [\n          { latitude: 50.81999932593175, longitude: -0.1443926504884132 },\n          { latitude: 50.81982005377856, longitude: -0.14389605957015306 },\n          { latitude: 50.8195735534442, longitude: -0.14290287773496857 },\n          { latitude: 50.81976403108945, longitude: -0.14245949298612004 },\n          { latitude: 50.819651985510006, longitude: -0.1415904588798469 },\n          { latitude: 50.819360665744455, longitude: -0.141129338740825 },\n          { latitude: 50.81955114425804, longitude: -0.14054407087405707 },\n          { latitude: 50.8194278935438, longitude: -0.1397814491065219 },\n          { latitude: 50.819282233189426, longitude: -0.1389301503892284 },\n          { latitude: 50.819696803774036, longitude: -0.13903656272921694 },\n          { latitude: 50.81999932593175, longitude: -0.13919618123853184 },\n          { latitude: 50.82010016621547, longitude: -0.13853997181101363 },\n          { latitude: 50.82041389015009, longitude: -0.138220734792327 },\n          { latitude: 50.82055954697452, longitude: -0.13852223642078343 },\n          { latitude: 50.82086206354296, longitude: -0.13829167635185513 },\n        ],\n        city: 'Brighton',\n        country: 'UK',\n        difficulty: 'Easy',\n        pace: '11:32',\n        maxElevation: 45,\n        date: Date.now(),\n        environment_tags: ['Beach', 'Sunny', 'Paved'],\n        rating: 4.5,\n        review: 'A beautiful walk along the seafront. Very dog friendly!',\n      };\n    }\n    return undefined;\n  }, [trails]);\n\n  const loadNearbyTrails = useCallback(async (latitude?: number, longitude?: number, distanceKm: number = 10) => {\n    try {\n      console.log('Loading nearby trails:', { latitude, longitude, distanceKm });\n\n      // If latitude/longitude provided and we have a session, call the backend nearby endpoint\n      if (typeof latitude === 'number' && typeof longitude === 'number' && session?.accessToken) {\n        try {\n          const resp = await fetch(\n            `${API_URL}/trail/nearby?latitude=${encodeURIComponent(latitude)}&longitude=${encodeURIComponent(longitude)}&distance_km=${encodeURIComponent(distanceKm)}`,\n            {\n              headers: { 'Authorization': `Bearer ${session.accessToken}` },\n            }\n          );\n          if (resp.ok) {\n            const data = await resp.json();\n            return data as Trail[];\n          }\n\n          if (resp.status === 404) {\n            // No nearby trails found  return empty list\n            console.warn('Nearby trails endpoint returned 404 (no trails)');\n            return [];\n          }\n\n          console.error('Failed to load nearby trails from API:', resp.status);\n          return [];\n        } catch (err) {\n          console.error('Error calling nearby trails API:', err);\n          return [];\n        }\n      }\n\n      // If we don't have coords or session (unauthenticated), return empty array\n      return [];\n    } catch (error) {\n      console.error('Failed to load nearby trails:', error);\n      return [];\n    }\n  }, [session]);\n\n  const updateTrailName = useCallback(async (id: string, name: string) => {\n    try {\n      console.log('Updating trail name via API:', id, name);\n      if (!session?.accessToken) throw new Error('Not authenticated');\n      const resp = await fetch(`${API_URL}/trail/${id}`, {\n        method: 'PUT',\n        headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${session?.accessToken}` },\n        body: JSON.stringify({ name }),\n      });\n      if (!resp.ok) {\n        const txt = await resp.text();\n        throw new Error(txt || 'Failed to update');\n      }\n      const updated = await resp.json();\n      setTrails((prev: Trail[]) => prev.map((t: Trail) => (t.id === id ? updated : t)));\n    } catch (error) {\n      console.error('Failed to update trail name:', error);\n      throw error;\n    }\n  }, [session]);\n\n  const updateTrailPhoto = useCallback(async (id: string, photo: string) => {\n    try {\n      console.log('Updating trail photo via API:', id);\n      if (!session?.accessToken) throw new Error('Not authenticated');\n      const resp = await fetch(`${API_URL}/trail/${id}`, {\n        method: 'PUT',\n        headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${session?.accessToken}` },\n        body: JSON.stringify({ photo }),\n      });\n      if (!resp.ok) {\n        const txt = await resp.text();\n        throw new Error(txt || 'Failed to update photo');\n      }\n      const updated = await resp.json();\n      setTrails((prev: Trail[]) => prev.map((t: Trail) => (t.id === id ? updated : t)));\n    } catch (error) {\n      console.error('Failed to update trail photo:', error);\n      throw error;\n    }\n  }, [session]);\n\n  const updateTrailDetails = useCallback(async (id: string, updates: {\n    rating?: number;\n    review?: string;\n    environment_tags?: string[];\n    difficulty?: string;\n  }) => {\n    try {\n      console.log('Updating trail details via API:', id, updates);\n      if (!session?.accessToken) throw new Error('Not authenticated');\n      const resp = await fetch(`${API_URL}/trail/${id}`, {\n        method: 'PUT',\n        headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${session?.accessToken}` },\n        body: JSON.stringify(updates),\n      });\n      if (!resp.ok) {\n        const txt = await resp.text();\n        throw new Error(txt || 'Failed to update details');\n      }\n      const updated = await resp.json();\n      setTrails((prev: Trail[]) => prev.map((t: Trail) => (t.id === id ? updated : t)));\n    } catch (error) {\n      console.error('Failed to update trail details:', error);\n      throw error;\n    }\n  }, []);\n\n  const getTrailWithUser = useCallback(async (id: string) => {\n    try {\n      console.log('Loading trail with user data via API:', id);\n      const resp = await fetch(`${API_URL}/trail/${id}`);\n      if (!resp.ok) {\n        console.error('Failed to fetch trail:', resp.status);\n        return undefined;\n      }\n      const data = await resp.json();\n      return data as Trail;\n    } catch (error) {\n      console.error('Failed to load trail with user:', error);\n      return undefined;\n    }\n  }, []);\n\n  const saveTrailBookmark = useCallback(async (trailId: string) => {\n    if (!user) {\n      console.error('No user logged in');\n      throw new Error('Must be logged in to save trails');\n    }\n\n    try {\n      console.log('Saving trail bookmark:', trailId);\n      // TODO: Implement bookmark with your backend\n      const trail = trails.find((t: Trail) => t.id === trailId);\n      if (trail) {\n        setSavedTrails((prev: Trail[]) => [trail, ...prev]);\n      }\n    } catch (error) {\n      console.error('Failed to save trail bookmark:', error);\n      throw error;\n    }\n  }, [user, trails]);\n\n  const removeTrailBookmark = useCallback(async (trailId: string) => {\n    if (!user) {\n      console.error('No user logged in');\n      throw new Error('Must be logged in to remove saved trails');\n    }\n\n    try {\n      console.log('Removing trail bookmark:', trailId);\n      // TODO: Implement remove bookmark with your backend\n      setSavedTrails((prev: Trail[]) => prev.filter((t: Trail) => t.id !== trailId));\n    } catch (error) {\n      console.error('Failed to remove trail bookmark:', error);\n      throw error;\n    }\n  }, [user]);\n\n  const isTrailSaved = useCallback((trailId: string): boolean => {\n    return savedTrails.some((t: Trail) => t.id === trailId);\n  }, [savedTrails]);\n\n\n  return useMemo(() => ({\n    trails,\n    savedTrails,\n    isLoading,\n    isSavedLoading,\n    saveTrail,\n    deleteTrail,\n    getTrailById,\n    updateTrailName,\n    updateTrailPhoto,\n    updateTrailDetails,\n    loadNearbyTrails,\n    saveTrailBookmark,\n    removeTrailBookmark,\n    isTrailSaved,\n    getTrailWithUser,\n  }), [trails, savedTrails, isLoading, isSavedLoading, saveTrail, deleteTrail, getTrailById, updateTrailName, updateTrailPhoto, updateTrailDetails, loadNearbyTrails, saveTrailBookmark, removeTrailBookmark, isTrailSaved, getTrailWithUser]);\n});\n\n","import { StyleSheet } from 'react-native';\nimport colors from '@/constants/colors';\n\nexport default StyleSheet.create({\n  container: {\n    backgroundColor: colors.surface,\n    overflow: 'hidden',\n  },\n});\n","import React, { useEffect, forwardRef, useRef, useImperativeHandle } from 'react';\n\nimport { View } from 'react-native';\nimport styles from './TrailMap.styles';\nimport * as maplibregl from 'maplibre-gl';\nimport 'maplibre-gl/dist/maplibre-gl.css';\n\ninterface TrailMapProps {\n  coordinates: { latitude: number; longitude: number }[];\n  style?: any;\n  scrollEnabled?: boolean;\n  zoomEnabled?: boolean;\n  showsUserLocation?: boolean;\n  followsUserLocation?: boolean;\n  showsMyLocationButton?: boolean;\n  initialRegion?: {\n    latitude: number;\n    longitude: number;\n    latitudeDelta: number;\n    longitudeDelta: number;\n  };\n}\n\nconst TrailMap = forwardRef<any, TrailMapProps>(({ \n  coordinates, \n  style, \n  initialRegion,\n  scrollEnabled = true,\n  zoomEnabled = true,\n}, ref) => {\n  const mapContainerRef = useRef<HTMLDivElement | null>(null);\n  const mapRef = useRef<maplibregl.Map | null>(null);\n\n  useImperativeHandle(ref, () => ({\n    animateToRegion: (region: any, duration: number = 500) => {\n      if (mapRef.current) {\n        mapRef.current.easeTo({\n          center: [region.longitude, region.latitude],\n          zoom: 14, // Approximate zoom for the delta\n          duration: duration,\n        });\n      }\n    },\n    fitToCoordinates: (coords: any[], options: any = {}) => {\n      if (mapRef.current && coords.length > 0) {\n        const bounds = new maplibregl.LngLatBounds();\n        coords.forEach(c => bounds.extend([c.longitude, c.latitude]));\n        mapRef.current.fitBounds(bounds, { padding: options.edgePadding || 20 });\n      }\n    }\n  }));\n\n  useEffect(() => {\n    if (!mapContainerRef.current) return;\n\n    const center: [number, number] = initialRegion \n      ? [initialRegion.longitude, initialRegion.latitude]\n      : coordinates.length > 0 \n        ? [coordinates[0].longitude, coordinates[0].latitude]\n        : [0, 0];\n\n    const zoom = initialRegion ? 14 : 12;\n\n    const map = new maplibregl.Map({\n      container: mapContainerRef.current,\n      style: 'https://basemaps.cartocdn.com/gl/positron-gl-style/style.json', // Basic open style\n      center: center,\n      zoom: zoom,\n      interactive: scrollEnabled && zoomEnabled,\n    });\n\n    mapRef.current = map;\n\n    map.on('load', () => {\n      if (coordinates.length > 1) {\n        map.addSource('route', {\n          'type': 'geojson',\n          'data': {\n            'type': 'Feature',\n            'properties': {},\n            'geometry': {\n              'type': 'LineString',\n              'coordinates': coordinates.map(c => [c.longitude, c.latitude])\n            }\n          }\n        });\n\n        map.addLayer({\n          'id': 'route',\n          'type': 'line',\n          'source': 'route',\n          'layout': {\n            'line-join': 'round',\n            'line-cap': 'round'\n          },\n          'paint': {\n            'line-color': '#5d6b4a',\n            'line-width': 4\n          }\n        });\n\n        // Fit bounds to coordinates\n        const bounds = new maplibregl.LngLatBounds();\n        coordinates.forEach(c => bounds.extend([c.longitude, c.latitude]));\n        map.fitBounds(bounds, { padding: 20 });\n      }\n    });\n\n    return () => {\n      map.remove();\n    };\n  }, [coordinates, initialRegion, scrollEnabled, zoomEnabled]);\n\n  return (\n    <View style={[style, styles.container]}>\n      <div \n        ref={mapContainerRef} \n        style={{ width: '100%', height: '100%' }} \n      />\n    </View>\n  );\n});\n\n// styles imported from TrailMap.styles.ts\n\nexport default TrailMap;\n","import { StyleSheet } from 'react-native';\nimport colors from '@/constants/colors';\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: colors.background,\n  },\n  content: {\n    padding: 24,\n  },\n  header: {\n    marginBottom: 32,\n    alignItems: 'center',\n  },\n  title: {\n    fontSize: 28,\n    fontWeight: '700' as const,\n    color: colors.accent,\n    marginBottom: 8,\n    textAlign: 'center',\n  },\n  subtitle: {\n    fontSize: 16,\n    color: colors.lightGreen,\n    textAlign: 'center',\n    marginBottom: 24,\n  },\n  progressContainer: {\n    flexDirection: 'row',\n    gap: 8,\n  },\n  progressDot: {\n    width: 8,\n    height: 8,\n    borderRadius: 4,\n    backgroundColor: '#3d4520',\n  },\n  progressDotActive: {\n    backgroundColor: colors.accent,\n  },\n  photoContainer: {\n    width: 140,\n    height: 140,\n    borderRadius: 70,\n    alignSelf: 'center',\n    marginBottom: 32,\n    overflow: 'hidden',\n  },\n  photo: {\n    width: '100%',\n    height: '100%',\n  },\n  photoPlaceholder: {\n    width: '100%',\n    height: '100%',\n    backgroundColor: colors.mediumGreen,\n    justifyContent: 'center',\n    alignItems: 'center',\n    gap: 8,\n  },\n  photoPlaceholderText: {\n    fontSize: 14,\n    color: colors.lightGreen,\n    fontWeight: '500' as const,\n  },\n  photoOverlay: {\n    position: 'absolute',\n    bottom: 0,\n    right: 0,\n    width: 40,\n    height: 40,\n    borderRadius: 20,\n    backgroundColor: colors.accent,\n    justifyContent: 'center',\n    alignItems: 'center',\n  },\n  formSection: {\n    marginBottom: 24,\n  },\n  label: {\n    fontSize: 15,\n    fontWeight: '600' as const,\n    color: colors.accent,\n    marginBottom: 8,\n  },\n  input: {\n    backgroundColor: colors.background,\n    borderRadius: 12,\n    padding: 16,\n    fontSize: 16,\n    color: colors.accent,\n    borderWidth: 1,\n    borderColor: '#3d4520',\n  },\n  pickerButton: {\n    backgroundColor: colors.background,\n    borderRadius: 12,\n    padding: 16,\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n    borderWidth: 1,\n    borderColor: '#3d4520',\n  },\n  pickerButtonText: {\n    fontSize: 16,\n    color: colors.accent,\n  },\n  pickerButtonTextPlaceholder: {\n    color: '#5a6040',\n  },\n  pickerOptions: {\n    backgroundColor: '#282E10',\n    borderRadius: 12,\n    marginTop: 8,\n    borderWidth: 1,\n    borderColor: '#3d4520',\n    overflow: 'hidden',\n  },\n  pickerOption: {\n    padding: 16,\n    borderBottomWidth: 1,\n    borderBottomColor: '#1a1f0a',\n  },\n  pickerOptionSelected: {\n    backgroundColor: 'rgba(255, 254, 119, 0.15)',\n  },\n  pickerOptionText: {\n    fontSize: 16,\n    color: colors.lightGreen,\n  },\n  pickerOptionTextSelected: {\n    color: colors.accent,\n    fontWeight: '600' as const,\n  },\n  nextButton: {\n    backgroundColor: colors.accent,\n    borderRadius: 12,\n    padding: 18,\n    alignItems: 'center',\n    marginTop: 16,\n  },\n  nextButtonText: {\n    fontSize: 17,\n    fontWeight: '600' as const,\n    color: colors.darkGreen,\n  },\n});\n\nexport default styles;\n","import React, { createContext, useContext, useEffect, useState } from 'react';\nimport colors, { setTheme } from '@/constants/colors';\nimport { Appearance } from 'react-native';\n\ntype Theme = 'light' | 'dark' | null;\n\nconst ThemeContext = createContext<{ theme: Theme; setThemeMode: (t: Theme) => void }>({ theme: null, setThemeMode: () => {} });\n\nexport const ThemeProvider: React.FC<{ children: React.ReactNode }> = ({ children }) => {\n  const system = Appearance.getColorScheme();\n  const [theme, setThemeState] = useState<Theme>(system === 'light' ? 'light' : 'dark');\n\n  useEffect(() => {\n    // initialize colors module\n    setTheme(theme);\n  }, [theme]);\n\n  const setThemeMode = (t: Theme) => {\n    if (t === null) {\n      const sys = Appearance.getColorScheme();\n      setTheme(sys === 'dark' ? 'dark' : 'light');\n      setThemeState(sys === 'dark' ? 'dark' : 'light');\n    } else {\n      setTheme(t);\n      setThemeState(t);\n    }\n  };\n\n  return (\n    <ThemeContext.Provider value={{ theme, setThemeMode }}>\n      {children}\n    </ThemeContext.Provider>\n  );\n};\n\nexport const useTheme = () => useContext(ThemeContext);\n\nexport default ThemeContext;\n","import { QueryClient, QueryClientProvider } from \"@tanstack/react-query\";\n\nimport { useRouter, Stack, useSegments } from \"expo-router\";\nimport * as SplashScreen from \"expo-splash-screen\";\n\nimport React, { useEffect } from \"react\";\nimport { View, ActivityIndicator, StyleSheet } from \"react-native\";\nimport { GestureHandlerRootView } from \"react-native-gesture-handler\";\n\nimport { AuthContext, useAuth } from '@/context/AuthContext';\nimport { AccountContext } from '@/context/AccountContext';\nimport { TrailsContext } from '@/context/TrailsContext';\n\nimport { DogsContext, useDogs } from '@/context/DogsContext';\nimport { ThemeProvider } from '@/context/ThemeContext';\n\n// Prevent the splash screen from auto-hiding before asset loading is complete.\nSplashScreen.preventAutoHideAsync();\n\nconst queryClient = new QueryClient();\n\nfunction RootLayoutNav() {\n  const { isAuthenticated, isLoading } = useAuth();\n  const { hasDogProfile, isDogProfileLoading } = useDogs();\n  const segments = useSegments();\n  const router = useRouter();\n\n  useEffect(() => {\n    // Wait until auth and dog profile loading are settled before making navigation decisions.\n    if (isLoading) return;\n\n    // If dog profiles are still loading, don't redirect yet. We only redirect when loading is finished\n    // to avoid jumping to onboarding before data arrives.\n    if (isDogProfileLoading) {\n      console.log('Navigation: waiting for dog profiles to finish loading');\n      return;\n    }\n\n    const inAuthGroup = segments[0] === '(tabs)';\n    const inLoginOrSignup = segments[0] === 'login' || segments[0] === 'signup';\n    const inOnboarding = segments[0] === 'onboarding';\n    \n    console.log('Navigation check:', { isAuthenticated, hasDogProfile, segments: segments[0] });\n\n    if (!isAuthenticated && (inAuthGroup || inOnboarding)) {\n      console.log('Redirecting to login: user not authenticated');\n      router.replace('/login');\n    } else if (isAuthenticated && !hasDogProfile && !inOnboarding) {\n      // Only redirect to onboarding after we've confirmed there are no dog profiles.\n      console.log('Redirecting to onboarding: no dog profile');\n      router.replace('/onboarding/dog-basics');\n    } else if (isAuthenticated && hasDogProfile && inLoginOrSignup) {\n      console.log('Redirecting to explore: user authenticated with dog profile');\n      router.replace('/(tabs)/explore');\n    }\n  }, [isAuthenticated, hasDogProfile, segments, isLoading, isDogProfileLoading, router]);\n\n  if (isLoading) {\n    return (\n      <View style={{ flex: 1, justifyContent: 'center', alignItems: 'center' }}>\n        <ActivityIndicator size=\"large\" color=\"#2563eb\" />\n      </View>\n    );\n  }\n\n  return (\n    <Stack screenOptions={{ headerBackTitle: \"Back\" }}>\n      <Stack.Screen name=\"login\" options={{ headerShown: false }} />\n      <Stack.Screen name=\"signup\" options={{ headerShown: false }} />\n      <Stack.Screen name=\"(tabs)\" options={{ headerShown: false }} />\n      <Stack.Screen name=\"trail/[id]\" options={{ headerShown: false }} />\n    </Stack>\n  );\n}\n\nexport default function RootLayout() {\n  useEffect(() => {\n    SplashScreen.hideAsync();\n  }, []);\n\n  return (\n    <QueryClientProvider client={queryClient}>\n      <AuthContext>\n        <AccountContext>\n          <ThemeProvider>\n            <DogsContext>\n              <TrailsContext>\n                <GestureHandlerRootView style={styles.container}>\n                  <RootLayoutNav />\n                </GestureHandlerRootView>\n              </TrailsContext>\n            </DogsContext>\n          </ThemeProvider>\n        </AccountContext>\n      </AuthContext>\n    </QueryClientProvider>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n});\n","import React, { useState, useCallback, useEffect } from 'react';\nimport { useFocusEffect, useRouter } from 'expo-router';\nimport { Text, View, StyleSheet, ScrollView, TouchableOpacity, Platform, ActivityIndicator, Animated, TextInput, Modal, FlatList } from 'react-native';\nimport { Image } from 'expo-image';\nimport { LinearGradient } from 'expo-linear-gradient';\nimport { useSafeAreaInsets } from 'react-native-safe-area-context';\nimport * as Haptics from 'expo-haptics';\n\nimport { MapPin, Search, Heart, Umbrella, Bookmark, Star, X, BarChart3, Navigation, ChevronLeft, ChevronUp, ChevronDown, Icon } from 'lucide-react-native';\nimport colors from '@/constants/colors';\nimport * as maplibregl from 'maplibre-gl';\n\nimport { Trail } from '@/types/trail';\nimport styles from './explore.styles';\nimport { formatDistance } from '@/utils/distance';\nimport TrailMapPreview from '@/components/TrailMapPreview';\nimport { useTrails } from '@/context/TrailsContext';\n\n\nconst CATEGORIES = [\n  { id: 'nearby', name: 'Nearby', icon: MapPin },\n  { id: 'popular', name: 'Popular', icon: Heart },\n  { id: 'beaches', name: 'Beaches', icon: Umbrella },\n];\n\n\nexport default function ExploreWebScreen() {\n  const router = useRouter();\n  const insets = useSafeAreaInsets();\n  const { loadNearbyTrails, saveTrailBookmark, removeTrailBookmark, isTrailSaved } = useTrails();\n  const [selectedCategory, setSelectedCategory] = useState<string>('nearby');\n  const [nearbyTrails, setNearbyTrails] = useState<Trail[]>([]);\n  const [isLoadingNearby, setIsLoadingNearby] = useState<boolean>(true);\n  const [, setUserCity] = useState<string | undefined>(undefined);\n  const [bookmarkAnimations, setBookmarkAnimations] = useState<Record<string, Animated.Value>>({});\n  const [searchQuery, setSearchQuery] = useState<string>('');\n  const [showSearchModal, setShowSearchModal] = useState<boolean>(false);\n  const [currentLocation, setCurrentLocation] = useState<string>('');\n  const [searchSuggestions, setSearchSuggestions] = useState<{id: string; name: string; location: string; type: string}[]>([]);\n  const [showPicker, setShowPicker] = useState<boolean>(false);\n\n  const loadUserLocationAndNearbyTrails = useCallback(async () => {\n    // On web, try to request browser location; fallback to no-coords call\n    setCurrentLocation('Current location');\n    try {\n      if (navigator && navigator.geolocation) {\n        navigator.geolocation.getCurrentPosition(async (pos) => {\n          try {\n            const trails = await loadNearbyTrails(pos.coords.latitude, pos.coords.longitude);\n            setNearbyTrails(trails);\n          } catch (err) {\n            console.error('Failed to load nearby trails with browser location:', err);\n            const trails = await loadNearbyTrails();\n            setNearbyTrails(trails);\n          } finally {\n            setIsLoadingNearby(false);\n          }\n        }, async () => {\n          const trails = await loadNearbyTrails();\n          setNearbyTrails(trails);\n          setIsLoadingNearby(false);\n        });\n        return;\n      }\n\n      const trails = await loadNearbyTrails();\n      setNearbyTrails(trails);\n    } catch (error) {\n      console.error('Failed to load nearby trails (web):', error);\n      setNearbyTrails([]);\n    } finally {\n      setIsLoadingNearby(false);\n    }\n  }, [loadNearbyTrails]);\n\n  useEffect(() => {\n    loadUserLocationAndNearbyTrails();\n  }, [loadUserLocationAndNearbyTrails]);\n\n  useFocusEffect(\n    useCallback(() => {\n      console.log('Explore tab focused - refreshing nearby trails (web)');\n      loadUserLocationAndNearbyTrails();\n    }, [loadUserLocationAndNearbyTrails])\n  );\n\n  const loadSearchSuggestions = useCallback(() => {\n    const query = searchQuery.toLowerCase();\n    const suggestions = nearbyTrails\n      .filter(trail => {\n        const name = trail.name?.toLowerCase() || '';\n        const city = trail.city?.toLowerCase() || '';\n        const country = trail.country?.toLowerCase() || '';\n        return name.includes(query) || city.includes(query) || country.includes(query);\n      })\n      .map(trail => ({\n        id: trail.id,\n        name: trail.name || `Trail ${new Date(trail.date).toLocaleDateString()}`,\n        location: trail.city ? `${trail.city}, ${trail.country || 'Unknown'}` : 'Location unknown',\n        type: 'trail',\n      }))\n      .slice(0, 6);\n\n    setSearchSuggestions(suggestions);\n  }, [searchQuery, nearbyTrails]);\n\n  useEffect(() => {\n    if (searchQuery.trim()) {\n      loadSearchSuggestions();\n    } else {\n      setSearchSuggestions([]);\n    }\n  }, [searchQuery, loadSearchSuggestions]);\n\n  const handleSearchBarPress = () => {\n    if (Platform.OS !== 'web') {\n      Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Light);\n    }\n    setShowSearchModal(true);\n  };\n\n  const handleCloseSearchModal = () => {\n    if (Platform.OS !== 'web') {\n      Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Light);\n    }\n    setShowSearchModal(false);\n    setSearchQuery('');\n    setSearchSuggestions([]);\n  };\n\n  const handleSuggestionPress = (suggestionId: string) => {\n    if (Platform.OS !== 'web') {\n      Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Light);\n    }\n    setShowSearchModal(false);\n    setSearchQuery('');\n    setSearchSuggestions([]);\n    router.push(`/trail/${suggestionId}`);\n  };\n\n  const handleCurrentLocationPress = () => {\n    if (Platform.OS !== 'web') {\n      Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Light);\n    }\n    setShowSearchModal(false);\n    setSearchQuery('');\n    setSearchSuggestions([]);\n  };\n\n  const getBookmarkAnimation = (trailId: string) => {\n    if (!bookmarkAnimations[trailId]) {\n      const newAnim = new Animated.Value(1);\n      setBookmarkAnimations(prev => ({ ...prev, [trailId]: newAnim }));\n      return newAnim;\n    }\n    return bookmarkAnimations[trailId];\n  };\n\n  const isValidUUID = (id: string): boolean => {\n    const uuidRegex = /^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;\n    return uuidRegex.test(id);\n  };\n\n  const handleBookmarkPress = async (trailId: string, isRealTrail: boolean = false) => {\n    if (!isRealTrail && !isValidUUID(trailId)) {\n      console.log('Cannot bookmark mock trail:', trailId);\n      if (Platform.OS !== 'web') {\n        Haptics.notificationAsync(Haptics.NotificationFeedbackType.Warning);\n      }\n      return;\n    }\n\n    if (Platform.OS !== 'web') {\n      Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Medium);\n    }\n\n    const anim = getBookmarkAnimation(trailId);\n    const isSaved = isTrailSaved(trailId);\n\n    Animated.sequence([\n      Animated.timing(anim, {\n        toValue: 0.6,\n        duration: 100,\n        useNativeDriver: true,\n      }),\n      Animated.spring(anim, {\n        toValue: 1,\n        friction: 3,\n        tension: 100,\n        useNativeDriver: true,\n      }),\n    ]).start();\n\n    try {\n      if (isSaved) {\n        await removeTrailBookmark(trailId);\n      } else {\n        await saveTrailBookmark(trailId);\n        if (Platform.OS !== 'web') {\n          Haptics.notificationAsync(Haptics.NotificationFeedbackType.Success);\n        }\n      }\n    } catch (error) {\n      console.error('Failed to toggle bookmark:', error);\n    }\n  };\n\n  const handleNavigateToTrail = (trailId: string) => {\n    if (Platform.OS !== 'web') {\n      Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Light);\n    }\n    router.push(`/trail/${trailId}`);\n  };\n\n  const handleCategoryPress = (categoryId: string) => {\n    if (Platform.OS !== 'web') {\n      Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Light);\n    }\n    setSelectedCategory(categoryId);\n  };\n\n  const getFilteredTrails = useCallback((trails: Trail[]) => {\n    let filtered = trails;\n\n    if (selectedCategory === 'popular') {\n      filtered = [...filtered].sort((a, b) => (b.rating || 0) - (a.rating || 0));\n    } else if (selectedCategory === 'beaches') {\n      filtered = filtered.filter((trail) => {\n        const tags = trail.environment_tags || [];\n        return tags.some(tag => tag.toLowerCase().includes('beach'));\n      });\n    }\n\n    return filtered;\n  }, [selectedCategory]);\n\n  // Map / picker state for web\n  const mapContainerRef = React.useRef<HTMLDivElement | null>(null);\n  const mapRef = React.useRef<maplibregl.Map | null>(null);\n  const [selectedCoords, setSelectedCoords] = useState<{ latitude: number; longitude: number } | null>(null);\n  const [distanceKm, setDistanceKm] = useState<number>(10);\n  const [containerReady, setContainerReady] = useState<boolean>(false);\n\n  // use a ref callback to detect when the div is mounted\n  const setMapContainer = (el: HTMLDivElement | null) => {\n    mapContainerRef.current = el;\n    setContainerReady(!!el);\n  };\n\n  useEffect(() => {\n    if (!containerReady || !mapContainerRef.current || !showPicker) return;\n\n    // prevent double-init\n    if (mapRef.current) return;\n\n    const defaultCenter: [number, number] = selectedCoords ? [selectedCoords.longitude, selectedCoords.latitude] : [0, 0];\n\n    const map = new maplibregl.Map({\n      container: mapContainerRef.current,\n      style: 'https://basemaps.cartocdn.com/gl/positron-gl-style/style.json',\n      center: defaultCenter,\n      zoom: selectedCoords ? 10 : 1,\n    });\n    mapRef.current = map;\n\n    map.on('load', () => {\n      // Add a point source for picker marker\n      if (!map.getSource('picker')) {\n        map.addSource('picker', { type: 'geojson', data: { type: 'FeatureCollection', features: [] } });\n        map.addLayer({\n          id: 'picker-layer',\n          type: 'circle',\n          source: 'picker',\n          paint: { 'circle-radius': 8, 'circle-color': '#2563eb', 'circle-stroke-color': '#fff', 'circle-stroke-width': 2 }\n        });\n      }\n    });\n\n    map.on('click', (e: any) => {\n      const lat = e.lngLat.lat;\n      const lng = e.lngLat.lng;\n      setSelectedCoords({ latitude: lat, longitude: lng });\n      const src = map.getSource('picker') as maplibregl.GeoJSONSource | undefined;\n      if (src) {\n        src.setData({ type: 'FeatureCollection', features: [{ type: 'Feature', geometry: { type: 'Point', coordinates: [lng, lat] } }] } as any);\n      }\n      map.flyTo({ center: [lng, lat], zoom: 12 });\n    });\n\n    return () => {\n      try {\n        map.remove();\n      } catch (e) {\n        // ignore\n      }\n      mapRef.current = null;\n    };\n  }, [containerReady, showPicker, selectedCoords]);\n\n  const handleSearchNearby = async () => {\n    setIsLoadingNearby(true);\n    try {\n      if (selectedCoords) {\n        const trails = await loadNearbyTrails(selectedCoords.latitude, selectedCoords.longitude, distanceKm);\n        setNearbyTrails(trails);\n      } else if (navigator && navigator.geolocation) {\n        navigator.geolocation.getCurrentPosition(async (pos) => {\n          const trails = await loadNearbyTrails(pos.coords.latitude, pos.coords.longitude, distanceKm);\n          setNearbyTrails(trails);\n        }, async () => {\n          const trails = await loadNearbyTrails(undefined, undefined, distanceKm);\n          setNearbyTrails(trails);\n        });\n      } else {\n        const trails = await loadNearbyTrails(undefined, undefined, distanceKm);\n        setNearbyTrails(trails);\n      }\n    } catch (err) {\n      console.error('Search nearby failed:', err);\n    } finally {\n      setIsLoadingNearby(false);\n    }\n  };\n\n  const filteredTrails = getFilteredTrails(nearbyTrails);\n\n  return (\n    <View style={styles.safeContainer}>\n      <ScrollView \n        style={styles.container} \n        showsVerticalScrollIndicator={false}\n        stickyHeaderIndices={[0]}\n      >\n        <View style={[styles.stickyHeader, { paddingTop: insets.top + 16 }]}>\n          <View style={styles.stickySearchContainer}>\n            <TouchableOpacity \n              style={styles.searchBar}\n              onPress={handleSearchBarPress}\n              activeOpacity={0.7}\n            >\n              <Search size={20} color={colors.muted} />\n              <Text style={styles.searchPlaceholder}>Find trails</Text>\n            </TouchableOpacity>\n            {Platform.OS === 'web' && (\n              <TouchableOpacity \n                style={styles.demoButton}\n                onPress={() => router.push('/trail/demo-trail')}\n              >\n                <Text style={styles.demoButtonText}>Demo</Text>\n              </TouchableOpacity>\n            )}\n          </View>\n\n          <View style={styles.categoriesSection}>\n            <ScrollView\n              horizontal\n              showsHorizontalScrollIndicator={false}\n              contentContainerStyle={styles.categoriesScroll}\n            >\n              {CATEGORIES.map((category) => {\n                const Icon = category.icon;\n                const isSelected = selectedCategory === category.id;\n                \n                return (\n                  <TouchableOpacity\n                    key={category.id}\n                    style={[\n                      styles.categoryButton,\n                      isSelected && styles.categoryButtonActive,\n                    ]}\n                    onPress={() => handleCategoryPress(category.id)}\n                  >\n                    <Icon\n                      size={20}\n                      color={isSelected ? '#fff' : '#9ca3af'}\n                      strokeWidth={2}\n                    />\n                    <Text\n                      style={[\n                        styles.categoryText,\n                        isSelected && styles.categoryTextActive,\n                      ]}\n                    >\n                      {category.name}\n                    </Text>\n                  </TouchableOpacity>\n                );\n              })}\n            </ScrollView>\n          </View>\n        </View>\n\n        {/* Web-specific map picker and distance selector (hideable) */}\n        <View style={{ paddingHorizontal: 16, paddingVertical: 8 }}>\n          <TouchableOpacity onPress={() => setShowPicker((s) => !s)} style={{ flexDirection: 'row', alignItems: 'center', justifyContent: 'space-between', marginBottom: 8 }}>\n            <Text style={{ fontSize: 14, fontWeight: '600' }}>Location & Distance</Text>\n            {showPicker ? <ChevronUp size={20} color=\"#5d6b4a\" /> : <ChevronDown size={20} color=\"#5d6b4a\" />}\n          </TouchableOpacity>\n\n          {showPicker ? (\n            <>\n              <Text style={{ fontSize: 14, fontWeight: '600', marginBottom: 8 }}>Pick a location on the map or use your current location</Text>\n              <div ref={setMapContainer as any} style={{ width: '100%', height: 220, borderRadius: 12, overflow: 'hidden', marginBottom: 8 }} />\n              <View style={{ flexDirection: 'row', alignItems: 'center', gap: 12 }}>\n                <View style={{ flexDirection: 'row', gap: 8 }}>\n                  {[5, 10, 25, 50].map((d) => (\n                    <TouchableOpacity\n                      key={d}\n                      style={{ paddingHorizontal: 12, paddingVertical: 8, borderRadius: 8, backgroundColor: distanceKm === d ? '#5d6b4a' : '#fff', borderWidth: 1, borderColor: '#e5e7eb' }}\n                      onPress={() => setDistanceKm(d)}\n                    >\n                      <Text style={{ color: distanceKm === d ? '#fff' : '#282E10', fontWeight: '600' }}>{d} km</Text>\n                    </TouchableOpacity>\n                  ))}\n                </View>\n                <TouchableOpacity onPress={handleSearchNearby} style={{ marginLeft: 'auto', paddingHorizontal: 16, paddingVertical: 10, backgroundColor: '#64748b', borderRadius: 10 }}>\n                  <Text style={{ color: '#fff', fontWeight: '700' }}>Search Nearby</Text>\n                </TouchableOpacity>\n              </View>\n            </>\n          ) : (\n            <View style={{ flexDirection: 'row', alignItems: 'center', gap: 12 }}>\n              <Text style={{ color: '#64748b' }}>{selectedCoords ? `${selectedCoords.latitude.toFixed(4)}, ${selectedCoords.longitude.toFixed(4)}` : 'Using current location'}</Text>\n              <Text style={{ color: '#64748b' }}>{distanceKm} km</Text>\n              <TouchableOpacity onPress={handleSearchNearby} style={{ marginLeft: 'auto', paddingHorizontal: 12, paddingVertical: 8, backgroundColor: '#64748b', borderRadius: 8 }}>\n                <Text style={{ color: '#fff', fontWeight: '700' }}>Search</Text>\n              </TouchableOpacity>\n            </View>\n          )}\n        </View>\n\n      <View style={styles.categoryTrailsSection}>\n        {isLoadingNearby ? (\n          <View style={styles.loadingContainer}>\n            <ActivityIndicator size=\"large\" color=\"#2563eb\" />\n            <Text style={styles.loadingText}>Loading trails...</Text>\n          </View>\n          ) : (filteredTrails && filteredTrails.length > 0) ? (\n            filteredTrails.map((trail) => {\n            const anim = getBookmarkAnimation(trail.id);\n            const isSaved = isTrailSaved(trail.id);\n            return (\n            <TouchableOpacity\n              key={trail.id}\n              style={styles.largeTrailCard}\n              onPress={() => handleNavigateToTrail(trail.id)}\n            >\n              {trail.photo ? (\n                <Image\n                  source={{ uri: trail.photo }}\n                  style={styles.largeTrailImage}\n                  contentFit=\"cover\"\n                  cachePolicy=\"memory-disk\"\n                />\n              ) : (\n                <TrailMapPreview\n                  coordinates={trail.coordinates}\n                  path={(trail as any).path}\n                  style={styles.largeTrailImage}\n                  startLatitude={(trail as any).startLatitude}\n                  startLongitude={(trail as any).startLongitude}\n                />\n              )}\n              \n              <LinearGradient\n                colors={['rgba(0, 0, 0, 0)', 'rgba(0, 0, 0, 0)', 'rgba(0, 0, 0, 0.25)', 'rgba(0, 0, 0, 0.6)']}\n                locations={[0, 0.3, 0.6, 1]}\n                style={styles.cardGradient}\n              />\n              \n              <TouchableOpacity \n                style={styles.bookmarkButton}\n                onPress={(e) => {\n                  e.stopPropagation();\n                  handleBookmarkPress(trail.id, true);\n                }}\n              >\n                <Animated.View style={{ transform: [{ scale: anim }] }}>\n                  <Bookmark \n                    size={20} \n                    color={isSaved ? \"#000\" : \"#64748b\"} \n                    fill={isSaved ? \"#000\" : \"none\"}\n                    strokeWidth={2} \n                  />\n                </Animated.View>\n              </TouchableOpacity>\n              \n              <View style={styles.cardOverlayContent}>\n                <Text style={styles.overlayTrailName}>\n                  {trail.name || `Trail ${new Date(trail.date).toLocaleDateString()}`}\n                </Text>\n                <Text style={styles.overlayLocation}>\n                  {trail.city ? `${trail.city}, ${trail.country || 'Unknown'}` : 'Location unknown'}\n                </Text>\n                <View style={styles.overlayBadges}>\n                  {trail.difficulty && (\n                    <View style={styles.badge}>\n                      <BarChart3 size={14} color=\"#d4d4a0\" strokeWidth={2.5} />\n                      <Text style={styles.badgeText}>{trail.difficulty}</Text>\n                    </View>\n                  )}\n                  <View style={styles.badge}>\n                    <MapPin size={14} color=\"#d4d4a0\" strokeWidth={2.5} />\n                    <Text style={styles.badgeText}>{formatDistance(trail.distance)}</Text>\n                  </View>\n                  {typeof (trail as any).distance_from_user === 'number' && (\n                    <View style={styles.badge}>\n                      <MapPin size={14} color=\"#d4d4a0\" strokeWidth={2.5} />\n                      <Text style={styles.badgeText}>{formatDistance((trail as any).distance_from_user)}</Text>\n                    </View>\n                  )}\n                  {trail.rating && (\n                    <View style={styles.badge}>\n                      <Star size={14} color=\"#fbbf24\" fill=\"#fbbf24\" strokeWidth={2} />\n                      <Text style={styles.badgeText}>{trail.rating.toFixed(1)}</Text>\n                    </View>\n                  )}\n                </View>\n              </View>\n            </TouchableOpacity>\n            );\n          })\n        ) : (\n          <View style={styles.emptyContainer}>\n            <MapPin size={48} color=\"#9ca3af\" />\n            <Text style={styles.emptyText}>\n              No trails found nearby. Try a wider search or record a trail to share with others.\n            </Text>\n          </View>\n        )}\n      </View>\n\n        <View style={styles.bottomPadding} />\n      </ScrollView>\n\n      <Modal\n        visible={showSearchModal}\n        animationType=\"slide\"\n        presentationStyle=\"fullScreen\"\n        onRequestClose={handleCloseSearchModal}\n      >\n        <View style={[styles.searchModalContainer, { paddingTop: insets.top }]}>\n          <View style={styles.searchModalHeader}>\n            <TouchableOpacity\n              style={styles.backButton}\n              onPress={handleCloseSearchModal}\n            >\n              <ChevronLeft size={24} color=\"#5d6b4a\" />\n            </TouchableOpacity>\n            <View style={styles.searchModalInputContainer}>\n              <TextInput\n                style={styles.searchModalInput}\n                placeholder=\"Find trails\"\n                placeholderTextColor=\"#9ca3af\"\n                value={searchQuery}\n                onChangeText={setSearchQuery}\n                autoFocus\n                returnKeyType=\"search\"\n              />\n              {searchQuery.length > 0 && (\n                <TouchableOpacity \n                  style={styles.clearButton}\n                  onPress={() => setSearchQuery('')}\n                >\n                  <X size={20} color=\"#64748b\" />\n                </TouchableOpacity>\n              )}\n            </View>\n          </View>\n\n          <View style={styles.searchModalContent}>\n            {searchQuery.trim() === '' && (\n              <TouchableOpacity\n                style={styles.currentLocationItem}\n                onPress={handleCurrentLocationPress}\n              >\n                <View style={styles.locationIconContainer}>\n                  <Navigation size={20} color=\"#5d6b4a\" />\n                </View>\n                <View style={styles.locationTextContainer}>\n                  <Text style={styles.locationTitle}>Current location</Text>\n                  <Text style={styles.locationSubtitle}>{currentLocation}</Text>\n                </View>\n              </TouchableOpacity>\n            )}\n\n            {searchSuggestions.length > 0 && (\n              <FlatList\n                data={searchSuggestions}\n                keyExtractor={(item) => item.id}\n                renderItem={({ item }) => (\n                  <TouchableOpacity\n                    style={styles.suggestionItem}\n                    onPress={() => handleSuggestionPress(item.id)}\n                  >\n                    <View style={styles.suggestionIconContainer}>\n                      <MapPin size={20} color=\"#64748b\" />\n                    </View>\n                    <View style={styles.suggestionTextContainer}>\n                      <Text style={styles.suggestionTitle}>{item.name}</Text>\n                      <Text style={styles.suggestionSubtitle}>{item.location}</Text>\n                    </View>\n                  </TouchableOpacity>\n                )}\n                showsVerticalScrollIndicator={false}\n              />\n            )}\n          </View>\n        </View>\n      </Modal>\n    </View>\n  );\n}\n\n// styles are imported from explore.styles.ts\n","import React from 'react';\nimport {\n  View,\n  StyleSheet,\n  TouchableOpacity,\n  Alert,\n  ActivityIndicator,\n  ScrollView,\n  Platform,\n  TextInput,\n  Modal,\n  Animated,\n  Text,\n} from 'react-native';\nimport { Image } from 'expo-image';\nimport * as Haptics from 'expo-haptics';\nimport * as ImagePicker from 'expo-image-picker';\nimport { useAuth } from '@/context/AuthContext';\nimport { useAccount } from '@/context/AccountContext';\nimport { useDogs } from '@/context/DogsContext';\nimport { useTrails } from '@/context/TrailsContext';\n\nimport { Mail, LogOut, Dog, Camera, X, MapPin, Star, BarChart3, Bookmark } from 'lucide-react-native';\nimport colors from '@/constants/colors';\nimport { useSafeAreaInsets } from 'react-native-safe-area-context';\nimport styles from './profile.styles';\nimport { useRouter } from 'expo-router';\nimport { formatDistance } from '@/utils/distance';\nimport { LinearGradient } from 'expo-linear-gradient';\nimport TrailMapPreview from '@/components/TrailMapPreview';\n// Use bundler require for local asset so Metro/Expo can resolve it reliably\nconst Icon = require('../../assets/images/icon.png');\n\ntype ProfileTab = 'created' | 'saved' | 'reviews';\n\nexport default function ProfileScreen() {\n  const { user, signOut } = useAuth();\n  const { userProfile, updateAccount, isLoading: isAccountLoading } = useAccount();\n  const { dogProfile, isDogProfileLoading } = useDogs();\n  const { trails, savedTrails, isLoading: isTrailsLoading, saveTrailBookmark, removeTrailBookmark, isTrailSaved } = useTrails();\n  const [isLoading, setIsLoading] = React.useState<boolean>(false);\n  const [showEditModal, setShowEditModal] = React.useState<boolean>(false);\n  const [editedName, setEditedName] = React.useState<string>('');\n  const [editedPhoto, setEditedPhoto] = React.useState<string | number>('');\n  const [isSaving, setIsSaving] = React.useState<boolean>(false);\n  const [selectedTab, setSelectedTab] = React.useState<ProfileTab>('created');\n  const [bookmarkAnimations, setBookmarkAnimations] = React.useState<Record<string, Animated.Value>>({});\n  const insets = useSafeAreaInsets();\n  const router = useRouter();\n\n  React.useEffect(() => {\n    const defaultName = userProfile?.name || user?.email?.split('@')[0] || '';\n    // Use profile photo if available, otherwise use bundled app icon as default\n    const defaultPhoto = userProfile?.photo || Icon;\n    setEditedName(defaultName);\n    setEditedPhoto(defaultPhoto);\n  }, [user, userProfile]);\n\n  const totalWalks = trails.length;\n  const totalTime = trails.reduce((acc, trail) => acc + (trail.duration || 0), 0);\n  const totalDistance = trails.reduce((acc, trail) => acc + trail.distance, 0);\n\n  const formatTime = (seconds: number): string => {\n    const hours = Math.floor(seconds / 3600);\n    const minutes = Math.floor((seconds % 3600) / 60);\n    if (hours > 0) {\n      return `${hours}.${Math.floor(minutes / 6)}h`;\n    }\n    return `${minutes}m`;\n  };\n\n  const handleTabPress = (tab: ProfileTab) => {\n    if (Platform.OS !== 'web') {\n      Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Light);\n    }\n    setSelectedTab(tab);\n  };\n\n  const handleNavigateToTrail = (trailId: string) => {\n    if (Platform.OS !== 'web') {\n      Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Light);\n    }\n    router.push(`/trail/${trailId}`);\n  };\n\n  const getBookmarkAnimation = (trailId: string) => {\n    if (!bookmarkAnimations[trailId]) {\n      const newAnim = new Animated.Value(1);\n      setBookmarkAnimations(prev => ({ ...prev, [trailId]: newAnim }));\n      return newAnim;\n    }\n    return bookmarkAnimations[trailId];\n  };\n\n  const handleBookmarkPress = async (trailId: string) => {\n    if (Platform.OS !== 'web') {\n      Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Medium);\n    }\n\n    const anim = getBookmarkAnimation(trailId);\n    const isSaved = isTrailSaved(trailId);\n\n    Animated.sequence([\n      Animated.timing(anim, {\n        toValue: 0.6,\n        duration: 100,\n        useNativeDriver: true,\n      }),\n      Animated.spring(anim, {\n        toValue: 1,\n        friction: 3,\n        tension: 100,\n        useNativeDriver: true,\n      }),\n    ]).start();\n\n    try {\n      if (isSaved) {\n        await removeTrailBookmark(trailId);\n      } else {\n        await saveTrailBookmark(trailId);\n        if (Platform.OS !== 'web') {\n          Haptics.notificationAsync(Haptics.NotificationFeedbackType.Success);\n        }\n      }\n    } catch (error) {\n      console.error('Failed to toggle bookmark:', error);\n    }\n  };\n\n  const handleSignOut = async () => {\n    if (Platform.OS !== 'web') {\n      Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Medium);\n    }\n    Alert.alert(\n      'Sign Out',\n      'Are you sure you want to sign out?',\n      [\n        { text: 'Cancel', style: 'cancel' },\n        {\n          text: 'Sign Out',\n          style: 'destructive',\n          onPress: async () => {\n            if (Platform.OS !== 'web') {\n              Haptics.notificationAsync(Haptics.NotificationFeedbackType.Success);\n            }\n            setIsLoading(true);\n            try {\n              await signOut();\n            } catch (error: any) {\n              if (Platform.OS !== 'web') {\n                Haptics.notificationAsync(Haptics.NotificationFeedbackType.Error);\n              }\n              Alert.alert('Error', error.message || 'Failed to sign out');\n            } finally {\n              setIsLoading(false);\n            }\n          },\n        },\n      ]\n    );\n  };\n\n  const handleEditDogProfile = () => {\n    if (Platform.OS !== 'web') {\n      Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Light);\n    }\n    router.push('/onboarding/dog-basics');\n  };\n\n  const handleOpenEditModal = () => {\n    if (Platform.OS !== 'web') {\n      Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Light);\n    }\n    setShowEditModal(true);\n  };\n\n  const handleCloseEditModal = () => {\n    if (Platform.OS !== 'web') {\n      Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Light);\n    }\n    setShowEditModal(false);\n    const defaultName = userProfile?.name || user?.email?.split('@')[0] || '';\n    const defaultPhoto = userProfile?.photo || Icon;\n    setEditedName(defaultName);\n    setEditedPhoto(defaultPhoto);\n  };\n\n  const handlePickImage = async () => {\n    if (Platform.OS !== 'web') {\n      Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Light);\n    }\n\n    const { status } = await ImagePicker.requestMediaLibraryPermissionsAsync();\n    \n    if (status !== 'granted') {\n      Alert.alert('Permission needed', 'Please allow access to your photo library');\n      return;\n    }\n\n    const result = await ImagePicker.launchImageLibraryAsync({\n      mediaTypes: ['images'],\n      allowsEditing: true,\n      aspect: [1, 1],\n      quality: 0.8,\n    });\n\n    if (!result.canceled && result.assets[0]) {\n      setEditedPhoto(result.assets[0].uri);\n    }\n  };\n\n  const handleSaveProfile = async () => {\n    if (Platform.OS !== 'web') {\n      Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Medium);\n    }\n\n    if (!editedName.trim()) {\n      Alert.alert('Error', 'Name cannot be empty');\n      return;\n    }\n\n    setIsSaving(true);\n    try {\n      await updateAccount({\n        name: editedName.trim(),\n        // Only send photo if it's a string (uploaded/remote URL). Bundled assets are numbers and shouldn't be sent.\n        photo: typeof editedPhoto === 'string' && editedPhoto ? editedPhoto : undefined,\n      });\n      \n      if (Platform.OS !== 'web') {\n        Haptics.notificationAsync(Haptics.NotificationFeedbackType.Success);\n      }\n      \n      setShowEditModal(false);\n      Alert.alert('Success', 'Profile updated successfully!');\n    } catch (error: any) {\n      console.error('Failed to save profile:', error);\n      if (Platform.OS !== 'web') {\n        Haptics.notificationAsync(Haptics.NotificationFeedbackType.Error);\n      }\n      Alert.alert('Error', error?.message || 'Failed to update profile');\n    } finally {\n      setIsSaving(false);\n    }\n  };\n\n  const getDisplayedTrails = () => {\n    if (selectedTab === 'created') return trails;\n    if (selectedTab === 'saved') return savedTrails;\n    return [];\n  };\n\n  const displayedTrails = getDisplayedTrails();\n\n  return (\n    <View style={styles.container}>\n      <ScrollView style={styles.scrollContainer} contentContainerStyle={[styles.content, { paddingTop: insets.top + 16, paddingBottom: insets.bottom + 20 }]}>\n      <View style={styles.userSection}>\n        <View style={styles.userHeader}>\n          <TouchableOpacity style={styles.userAvatar} onPress={handleOpenEditModal}>\n            {editedPhoto ? (\n              <Image\n                source={editedPhoto}\n                style={styles.userAvatarImage}\n                contentFit=\"cover\"\n                cachePolicy=\"memory-disk\"\n              />\n            ) : (\n              <View style={styles.initialAvatar}>\n                <Text style={styles.initialAvatarText}>{(editedName || userProfile?.name || user?.email || 'A').charAt(0).toUpperCase()}</Text>\n              </View>\n            )}\n          </TouchableOpacity>\n          <View style={styles.userInfo}>\n            <Text style={styles.userName}>{userProfile?.name || editedName || 'Account Holder'}</Text>\n            <View style={styles.userEmailRow}>\n              <Mail size={14} color={colors.primary} />\n              <Text style={styles.userEmail}>{user?.email || 'Not available'}</Text>\n            </View>\n          </View>\n        </View>\n      </View>\n\n      {isDogProfileLoading ? (\n        <View style={styles.dogCardContainer}>\n          <View style={styles.loadingDogCard}>\n            <ActivityIndicator size=\"large\" color={colors.paleYellow} />\n          </View>\n        </View>\n      ) : dogProfile ? (\n        <View style={styles.dogCardContainer}>\n          <TouchableOpacity style={styles.dogCard} onPress={handleEditDogProfile}>\n            <View style={styles.dogPhotoContainer}>\n              {dogProfile.photo ? (\n                <Image\n                  source={dogProfile.photo}\n                  style={styles.dogPhoto}\n                  contentFit=\"cover\"\n                  cachePolicy=\"memory-disk\"\n                />\n              ) : (\n                <View style={[styles.dogPhoto, styles.dogPhotoPlaceholder]}>\n                  <Dog size={40} color={colors.muted} />\n                </View>\n              )}\n            </View>\n            \n            <Text style={styles.dogName}>{dogProfile.name}</Text>\n            {dogProfile.nickname && (\n              <Text style={styles.dogNickname}>\n                {dogProfile.nickname}\n              </Text>\n            )}\n            {!dogProfile.nickname && <View style={styles.nicknameSpacing} />}\n\n            <View style={styles.statsRow}>\n              <View style={styles.statItem}>\n                <Text style={styles.statValue}>{totalWalks}</Text>\n                <Text style={styles.statLabel}>Walks</Text>\n              </View>\n              <View style={styles.statItem}>\n                <Text style={styles.statValue}>{formatTime(totalTime)}</Text>\n                <Text style={styles.statLabel}>Total Time</Text>\n              </View>\n              <View style={styles.statItem}>\n                <Text style={styles.statValue}>{formatDistance(totalDistance)}</Text>\n                <Text style={styles.statLabel}>Total Dist.</Text>\n              </View>\n            </View>\n\n            <View style={styles.dogInfoRow}>\n              <View style={styles.dogInfoBadge}>\n                <Text style={styles.dogInfoText}>{dogProfile.age} years</Text>\n              </View>\n              <View style={styles.dogInfoBadge}>\n                <Text style={styles.dogInfoText}>Size {dogProfile.size}</Text>\n              </View>\n            </View>\n          </TouchableOpacity>\n        </View>\n      ) : (\n        <View style={styles.dogCardContainer}>\n          <View style={styles.noDogCard}>\n            <Dog size={48} color={colors.muted} />\n            <Text style={styles.noDogText}>No dog profile yet</Text>\n            <TouchableOpacity\n              style={styles.addDogButton}\n              onPress={handleEditDogProfile}\n            >\n              <Text style={styles.addDogButtonText}>Add Dog Profile</Text>\n            </TouchableOpacity>\n          </View>\n        </View>\n      )}\n\n      <View style={styles.tabsContainer}>\n        <TouchableOpacity\n          style={[styles.tab, selectedTab === 'created' && styles.tabActive]}\n          onPress={() => handleTabPress('created')}\n        >\n          <Text style={[styles.tabCount, selectedTab === 'created' && styles.tabCountActive]}>{trails.length}</Text>\n          <Text style={[styles.tabText, selectedTab === 'created' && styles.tabTextActive]}>Created</Text>\n        </TouchableOpacity>\n        <TouchableOpacity\n          style={[styles.tab, selectedTab === 'saved' && styles.tabActive]}\n          onPress={() => handleTabPress('saved')}\n        >\n          <Text style={[styles.tabCount, selectedTab === 'saved' && styles.tabCountActive]}>{savedTrails.length}</Text>\n          <Text style={[styles.tabText, selectedTab === 'saved' && styles.tabTextActive]}>Saved</Text>\n        </TouchableOpacity>\n        <TouchableOpacity\n          style={[styles.tab, selectedTab === 'reviews' && styles.tabActive]}\n          onPress={() => handleTabPress('reviews')}\n        >\n          <Text style={[styles.tabCount, selectedTab === 'reviews' && styles.tabCountActive]}>0</Text>\n          <Text style={[styles.tabText, selectedTab === 'reviews' && styles.tabTextActive]}>Reviews</Text>\n        </TouchableOpacity>\n      </View>\n\n      <View style={styles.trailsSection}>\n        {isTrailsLoading ? (\n          <View style={styles.loadingContainer}>\n            <ActivityIndicator size=\"large\" color={colors.primary} />\n          </View>\n        ) : displayedTrails.length > 0 ? (\n          displayedTrails.map((trail) => {\n            const anim = getBookmarkAnimation(trail.id);\n            const isSaved = isTrailSaved(trail.id);\n            return (\n            <TouchableOpacity\n              key={trail.id}\n              style={styles.trailCard}\n              onPress={() => handleNavigateToTrail(trail.id)}\n            >\n              {trail.photo ? (\n                <Image source={{ uri: trail.photo }} style={styles.trailImage} />\n              ) : (\n                <TrailMapPreview\n                  coordinates={trail.coordinates}\n                  path={(trail as any).path}\n                  style={styles.trailImage}\n                  startLatitude={(trail as any).startLatitude}\n                  startLongitude={(trail as any).startLongitude}\n                />\n              )}\n              \n              <LinearGradient\n                colors={['rgba(0, 0, 0, 0)', 'rgba(0, 0, 0, 0)', 'rgba(0, 0, 0, 0.25)', 'rgba(0, 0, 0, 0.6)']}\n                locations={[0, 0.3, 0.6, 1]}\n                style={styles.trailGradient}\n              />\n              \n              <TouchableOpacity \n                style={styles.bookmarkButton}\n                onPress={(e) => {\n                  e.stopPropagation();\n                  handleBookmarkPress(trail.id);\n                }}\n              >\n                <Animated.View style={{ transform: [{ scale: anim }] }}>\n                  <Bookmark \n                    size={20} \n                    color={isSaved ? \"#000\" : colors.muted} \n                    fill={isSaved ? \"#000\" : \"none\"}\n                    strokeWidth={2} \n                  />\n                </Animated.View>\n              </TouchableOpacity>\n              \n              <View style={styles.trailContent}>\n                <Text style={styles.trailName}>\n                  {trail.name || `Trail ${new Date(trail.date).toLocaleDateString()}`}\n                </Text>\n                <Text style={styles.trailLocation}>\n                  {trail.city ? `${trail.city}, ${trail.country || 'Unknown'}` : 'Location unknown'}\n                </Text>\n                <View style={styles.trailBadges}>\n                  {trail.difficulty && (\n                    <View style={styles.trailBadge}>\n                      <BarChart3 size={14} color={colors.paleYellow} strokeWidth={2.5} />\n                      <Text style={styles.trailBadgeText}>{trail.difficulty}</Text>\n                    </View>\n                  )}\n                  <View style={styles.trailBadge}>\n                    <MapPin size={14} color={colors.paleYellow} strokeWidth={2.5} />\n                    <Text style={styles.trailBadgeText}>{formatDistance(trail.distance)}</Text>\n                  </View>\n                  {trail.rating && (\n                    <View style={styles.trailBadge}>\n                      <Star size={14} color={colors.accent} fill={colors.accent} strokeWidth={2} />\n                      <Text style={styles.trailBadgeText}>{trail.rating.toFixed(1)}</Text>\n                    </View>\n                  )}\n                </View>\n              </View>\n            </TouchableOpacity>\n            );\n          })\n        ) : (\n          <View style={styles.emptyContainer}>\n            <MapPin size={48} color={colors.light.tabIconDefault} />\n            <Text style={styles.emptyText}>\n              {selectedTab === 'created' \n                ? 'No trails created yet'\n                : selectedTab === 'saved'\n                ? 'No trails saved yet'\n                : 'No reviews yet'}\n            </Text>\n          </View>\n        )}\n      </View>\n\n      <TouchableOpacity\n        style={[styles.signOutButton, isLoading && styles.signOutButtonDisabled]}\n        onPress={handleSignOut}\n        disabled={isLoading}\n      >\n        {isLoading ? (\n          <ActivityIndicator color={colors.light.tabIconSelected} />\n        ) : (\n          <>\n            <LogOut size={20} color={colors.light.tabIconSelected} />\n            <Text style={styles.signOutText}>Sign Out</Text>\n          </>\n        )}\n      </TouchableOpacity>\n\n      <Modal\n        visible={showEditModal}\n        animationType=\"slide\"\n        presentationStyle=\"pageSheet\"\n        onRequestClose={handleCloseEditModal}\n      >\n        <View style={styles.modalContainer}>\n          <View style={[styles.modalHeader, { paddingTop: insets.top + 20 }]}>\n            <Text style={styles.modalTitle}>Edit Profile</Text>\n            <TouchableOpacity\n              style={styles.closeButton}\n              onPress={handleCloseEditModal}\n            >\n              <X size={24} color={colors.primary} />\n            </TouchableOpacity>\n          </View>\n\n          <ScrollView style={styles.modalContent}>\n            <View style={styles.photoSection}>\n              <TouchableOpacity\n                style={styles.photoContainer}\n                onPress={handlePickImage}\n              >\n                {editedPhoto ? (\n                  <Image\n                    source={editedPhoto}\n                    style={styles.editPhoto}\n                    contentFit=\"cover\"\n                    cachePolicy=\"memory-disk\"\n                  />\n                ) : (\n                  <View style={[styles.editPhoto, styles.initialAvatar] }>\n                    <Text style={styles.initialAvatarText}>{(editedName || userProfile?.name || user?.email || 'A').charAt(0).toUpperCase()}</Text>\n                  </View>\n                )}\n                <View style={styles.cameraOverlay}>\n                  <Camera size={24} color={colors.light.tabIconSelected} />\n                </View>\n              </TouchableOpacity>\n              <Text style={styles.photoHint}>Tap to change photo</Text>\n            </View>\n\n            <View style={styles.inputSection}>\n              <Text style={styles.inputLabel}>Name</Text>\n              <TextInput\n                style={styles.input}\n                value={editedName}\n                onChangeText={setEditedName}\n                placeholder=\"Enter your name\"\n                placeholderTextColor={colors.light.tabIconDefault}\n              />\n            </View>\n\n            <View style={styles.inputSection}>\n              <Text style={styles.inputLabel}>Email</Text>\n              <View style={styles.disabledInput}>\n                <Text style={styles.disabledInputText}>{user?.email}</Text>\n              </View>\n              <Text style={styles.inputHint}>Email cannot be changed</Text>\n            </View>\n          </ScrollView>\n\n          <View style={[styles.modalFooter, { paddingBottom: insets.bottom + 20 }]}>\n            <TouchableOpacity\n              style={[styles.saveButton, isSaving && styles.saveButtonDisabled]}\n              onPress={handleSaveProfile}\n              disabled={isSaving}\n            >\n              {isSaving ? (\n                <ActivityIndicator color={colors.light.tabIconSelected} />\n              ) : (\n                <Text style={styles.saveButtonText}>Save Changes</Text>\n              )}\n            </TouchableOpacity>\n          </View>\n        </View>\n      </Modal>\n    </ScrollView>\n    </View>\n  );\n}\n\n// styles are imported from profile.styles.ts\n","import { StyleSheet } from 'react-native';\nimport colors from '@/constants/colors';\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: colors.black,\n  },\n  scrollView: {\n    flex: 1,\n  },\n  content: {\n    padding: 24,\n  },\n  header: {\n    marginBottom: 32,\n    alignItems: 'center',\n  },\n  title: {\n    fontSize: 28,\n    fontWeight: '700' as const,\n    color: colors.accent,\n    marginBottom: 8,\n    textAlign: 'center',\n  },\n  subtitle: {\n    fontSize: 16,\n    color: colors.lightGreen,\n    textAlign: 'center',\n    marginBottom: 24,\n  },\n  progressContainer: {\n    flexDirection: 'row',\n    gap: 8,\n  },\n  progressDot: {\n    width: 8,\n    height: 8,\n    borderRadius: 4,\n    backgroundColor: '#3d4520',\n  },\n  progressDotActive: {\n    backgroundColor: colors.accent,\n  },\n  tagsContainer: {\n    flexDirection: 'row',\n    flexWrap: 'wrap',\n    gap: 12,\n  },\n  tag: {\n    paddingHorizontal: 20,\n    paddingVertical: 12,\n    borderRadius: 24,\n    backgroundColor: '#282E10',\n    borderWidth: 1.5,\n    borderColor: '#3d4520',\n  },\n  tagSelected: {\n    backgroundColor: 'rgba(255, 254, 119, 0.15)',\n    borderColor: colors.accent,\n  },\n  tagText: {\n    fontSize: 15,\n    fontWeight: '500' as const,\n    color: colors.lightGreen,\n  },\n  tagTextSelected: {\n    color: colors.accent,\n    fontWeight: '600' as const,\n  },\n  sectionHeader: {\n    marginTop: 32,\n    marginBottom: 16,\n  },\n  sectionTitle: {\n    fontSize: 24,\n    fontWeight: '700' as const,\n    color: colors.accent,\n  },\n  section: {\n    marginBottom: 24,\n  },\n  label: {\n    fontSize: 17,\n    fontWeight: '600' as const,\n    color: colors.accent,\n    marginBottom: 4,\n  },\n  helperText: {\n    fontSize: 14,\n    color: colors.lightGreen,\n    marginBottom: 12,\n  },\n  recallContainer: {\n    flexDirection: 'row',\n    gap: 8,\n  },\n  recallOption: {\n    flex: 1,\n    paddingVertical: 12,\n    paddingHorizontal: 16,\n    borderRadius: 12,\n    backgroundColor: '#282E10',\n    borderWidth: 1.5,\n    borderColor: '#3d4520',\n    alignItems: 'center',\n  },\n  recallOptionSelected: {\n    backgroundColor: 'rgba(255, 254, 119, 0.15)',\n    borderColor: colors.accent,\n  },\n  recallText: {\n    fontSize: 14,\n    fontWeight: '500' as const,\n    color: colors.lightGreen,\n  },\n  recallTextSelected: {\n    color: colors.accent,\n    fontWeight: '600' as const,\n  },\n  footer: {\n    flexDirection: 'row',\n    gap: 12,\n    paddingHorizontal: 24,\n    paddingTop: 20,\n    borderTopWidth: 1,\n    borderTopColor: '#3d4520',\n    backgroundColor: '#282E10',\n  },\n  backButton: {\n    flex: 1,\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'center',\n    gap: 8,\n    backgroundColor: 'transparent',\n    borderRadius: 12,\n    padding: 18,\n    borderWidth: 1.5,\n    borderColor: colors.accent,\n  },\n  backButtonText: {\n    fontSize: 17,\n    fontWeight: '600' as const,\n    color: colors.accent,\n  },\n  finishButton: {\n    flex: 1,\n    backgroundColor: colors.accent,\n    borderRadius: 12,\n    padding: 18,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  finishButtonDisabled: {\n    opacity: 0.6,\n  },\n  finishButtonText: {\n    fontSize: 17,\n    fontWeight: '600' as const,\n    color: '#1a1f0a',\n  },\n});\n\nexport default styles;\n","import { StyleSheet } from 'react-native';\nimport colors from '@/constants/colors';\n\nexport default StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: colors.background,\n  },\n  scrollContainer: {\n    flex: 1,\n  },\n  content: {\n    paddingHorizontal: 16,\n  },\n  userSection: {\n    marginBottom: 24,\n  },\n  userHeader: {\n    flexDirection: 'row',\n    alignItems: 'center',\n  },\n  userAvatar: {\n    width: 48,\n    height: 48,\n    borderRadius: 24,\n    overflow: 'hidden',\n    backgroundColor: colors.lightGreen,\n    borderWidth: 2,\n    borderColor: colors.primary,\n  },\n  userAvatarImage: {\n    width: '100%',\n    height: '100%',\n  },\n  userInfo: {\n    marginLeft: 12,\n    flex: 1,\n  },\n  userName: {\n    fontSize: 20,\n    fontWeight: '700' as const,\n    color: colors.darkGreen,\n    marginBottom: 2,\n  },\n  userEmailRow: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: 6,\n  },\n  userEmail: {\n    fontSize: 14,\n    color: colors.primary,\n    opacity: 0.8,\n  },\n  dogCardContainer: {\n    marginBottom: 24,\n  },\n  dogCard: {\n    backgroundColor: colors.background,\n    borderRadius: 24,\n    padding: 24,\n    alignItems: 'center',\n    borderWidth: 1,\n    borderColor: colors.primary,\n  },\n  dogPhotoContainer: {\n    marginBottom: 16,\n  },\n  dogPhoto: {\n    width: 100,\n    height: 100,\n    borderRadius: 50,\n    backgroundColor: colors.mediumGreen,\n    borderWidth: 3,\n    borderColor: colors.paleYellow,\n  },\n  dogPhotoPlaceholder: {\n    justifyContent: 'center',\n    alignItems: 'center',\n  },\n  dogName: {\n    fontSize: 22,\n    fontWeight: '700' as const,\n    color: '#fff',\n    marginBottom: 4,\n  },\n  dogNickname: {\n    fontSize: 14,\n    color: colors.paleYellow,\n    opacity: 0.9,\n    marginBottom: 16,\n  },\n  nicknameSpacing: {\n    height: 16,\n  },\n  statsRow: {\n    flexDirection: 'row',\n    justifyContent: 'space-around',\n    width: '100%',\n    marginBottom: 20,\n  },\n  statItem: {\n    alignItems: 'center',\n  },\n  statValue: {\n    fontSize: 24,\n    fontWeight: '700' as const,\n    color: '#fff',\n    marginBottom: 4,\n  },\n  statLabel: {\n    fontSize: 13,\n    color: colors.paleYellow,\n    opacity: 0.8,\n  },\n  dogInfoRow: {\n    flexDirection: 'row',\n    gap: 12,\n  },\n  dogInfoBadge: {\n    backgroundColor: 'rgba(255, 255, 255, 0.2)',\n    paddingHorizontal: 16,\n    paddingVertical: 8,\n    borderRadius: 16,\n  },\n  dogInfoText: {\n    fontSize: 14,\n    color: '#fff',\n    fontWeight: '500' as const,\n  },\n  loadingDogCard: {\n    backgroundColor: colors.darkGreen,\n    borderRadius: 24,\n    padding: 48,\n    alignItems: 'center',\n    justifyContent: 'center',\n    borderWidth: 1,\n    borderColor: colors.primary,\n  },\n  noDogCard: {\n    backgroundColor: colors.darkGreen,\n    borderRadius: 24,\n    padding: 32,\n    alignItems: 'center',\n    gap: 12,\n    borderWidth: 1,\n    borderColor: colors.primary,\n  },\n  noDogText: {\n    fontSize: 16,\n    color: colors.paleYellow,\n    opacity: 0.9,\n    textAlign: 'center',\n  },\n  addDogButton: {\n    backgroundColor: colors.primary,\n    paddingHorizontal: 20,\n    paddingVertical: 12,\n    borderRadius: 12,\n    marginTop: 8,\n  },\n  addDogButtonText: {\n    fontSize: 15,\n    fontWeight: '600' as const,\n    color: '#fff',\n  },\n  tabsContainer: {\n    flexDirection: 'row',\n    marginBottom: 20,\n    gap: 12,\n  },\n  tab: {\n    flex: 1,\n  backgroundColor: '#fff',\n    paddingVertical: 16,\n    paddingHorizontal: 16,\n    borderRadius: 16,\n    alignItems: 'center',\n    borderWidth: 0,\n  },\n  tabActive: {\n    backgroundColor: '#5d6b4a',\n  },\n  tabText: {\n    fontSize: 14,\n    fontWeight: '600' as const,\n    color: '#9ca3af',\n  },\n  tabTextActive: {\n    color: '#fff',\n  },\n  tabCount: {\n    fontSize: 24,\n    fontWeight: '700' as const,\n    color: colors.darkGreen,\n    marginBottom: 4,\n  },\n  tabCountActive: {\n    color: '#fff',\n  },\n  trailsSection: {\n    marginBottom: 24,\n  },\n  trailCard: {\n    backgroundColor: '#fff',\n    borderRadius: 24,\n    overflow: 'hidden',\n    marginBottom: 20,\n    shadowColor: '#000',\n    shadowOffset: { width: 0, height: 4 },\n    shadowOpacity: 0.1,\n    shadowRadius: 16,\n    elevation: 4,\n    position: 'relative',\n  },\n  trailImage: {\n    width: '100%',\n    height: 260,\n    backgroundColor: colors.surface,\n  },\n  trailGradient: {\n    position: 'absolute',\n    top: 0,\n    bottom: 0,\n    left: 0,\n    right: 0,\n  },\n  trailContent: {\n    position: 'absolute',\n    bottom: 0,\n    left: 0,\n    right: 0,\n    padding: 18,\n    paddingBottom: 20,\n  },\n  trailName: {\n    fontSize: 28,\n    fontWeight: '700' as const,\n    color: '#fff',\n    marginBottom: 6,\n    lineHeight: 34,\n    textShadowColor: 'rgba(0, 0, 0, 0.3)',\n    textShadowOffset: { width: 0, height: 1 },\n    textShadowRadius: 4,\n  },\n  trailLocation: {\n    fontSize: 16,\n    color: '#fff',\n    marginBottom: 16,\n    opacity: 0.95,\n    textShadowColor: 'rgba(0, 0, 0, 0.3)',\n    textShadowOffset: { width: 0, height: 1 },\n    textShadowRadius: 4,\n  },\n  trailBadges: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: 12,\n    flexWrap: 'wrap' as const,\n  },\n  trailBadge: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    backgroundColor: 'rgba(40, 40, 40, 0.8)',\n    paddingHorizontal: 14,\n    paddingVertical: 8,\n    borderRadius: 20,\n    gap: 6,\n  },\n  trailBadgeText: {\n    fontSize: 14,\n    fontWeight: '600' as const,\n    color: '#fff',\n    textTransform: 'capitalize' as const,\n  },\n  bookmarkButton: {\n    position: 'absolute',\n    top: 20,\n    right: 20,\n    width: 44,\n    height: 44,\n    borderRadius: 22,\n    backgroundColor: 'rgba(255, 255, 255, 0.95)',\n    justifyContent: 'center',\n    alignItems: 'center',\n    shadowColor: '#000',\n    shadowOffset: { width: 0, height: 2 },\n    shadowOpacity: 0.1,\n    shadowRadius: 8,\n    elevation: 4,\n    zIndex: 10,\n  },\n  loadingContainer: {\n    paddingVertical: 60,\n    alignItems: 'center',\n  },\n  emptyContainer: {\n    paddingVertical: 60,\n    alignItems: 'center',\n    gap: 16,\n    paddingHorizontal: 32,\n  },\n  emptyText: {\n    fontSize: 16,\n    color: colors.primary,\n    opacity: 0.7,\n    textAlign: 'center',\n    lineHeight: 24,\n  },\n  signOutButton: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'center',\n    gap: 12,\n  backgroundColor: '#b91c1c',\n    borderRadius: 12,\n    padding: 16,\n    marginTop: 16,\n    borderWidth: 1,\n  borderColor: '#7f1d1d',\n  },\n  signOutButtonDisabled: {\n    opacity: 0.6,\n  },\n  signOutText: {\n    fontSize: 16,\n    fontWeight: '600' as const,\n    color: '#fff',\n  },\n  modalContainer: {\n    flex: 1,\n    backgroundColor: colors.background,\n  },\n  modalHeader: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    paddingHorizontal: 20,\n    paddingBottom: 20,\n    backgroundColor: colors.background,\n    borderBottomWidth: 1,\n    borderBottomColor: colors.lightGreen,\n  },\n  modalTitle: {\n    fontSize: 24,\n    fontWeight: '700' as const,\n    color: colors.darkGreen,\n  },\n  closeButton: {\n    width: 40,\n    height: 40,\n    borderRadius: 20,\n    backgroundColor: colors.lightGreen,\n    justifyContent: 'center',\n    alignItems: 'center',\n  },\n  modalContent: {\n    flex: 1,\n    padding: 20,\n  },\n  photoSection: {\n    alignItems: 'center',\n    marginBottom: 32,\n    paddingTop: 20,\n  },\n  photoContainer: {\n    width: 120,\n    height: 120,\n    borderRadius: 60,\n    overflow: 'hidden',\n    position: 'relative',\n    marginBottom: 12,\n  },\n  editPhoto: {\n    width: '100%',\n    height: '100%',\n  },\n  cameraOverlay: {\n    position: 'absolute',\n    bottom: 0,\n    left: 0,\n    right: 0,\n    height: 40,\n    backgroundColor: 'rgba(0, 0, 0, 0.5)',\n    justifyContent: 'center',\n    alignItems: 'center',\n  },\n  photoHint: {\n    fontSize: 14,\n    color: '#6b7280',\n  },\n  inputSection: {\n    marginBottom: 24,\n  },\n  inputLabel: {\n    fontSize: 15,\n    fontWeight: '600' as const,\n    color: colors.primary,\n    marginBottom: 8,\n  },\n  input: {\n    backgroundColor: colors.background,\n    borderRadius: 12,\n    padding: 16,\n    fontSize: 16,\n    color: colors.darkGreen,\n    borderWidth: 1,\n    borderColor: colors.lightGreen,\n  },\n  disabledInput: {\n    backgroundColor: colors.surface,\n    borderRadius: 12,\n    padding: 16,\n    borderWidth: 1,\n    borderColor: '#e5e7eb',\n  },\n  disabledInputText: {\n    fontSize: 16,\n    color: '#9ca3af',\n  },\n  inputHint: {\n    fontSize: 13,\n    color: '#9ca3af',\n    marginTop: 6,\n  },\n  modalFooter: {\n    padding: 20,\n    backgroundColor: colors.background,\n    borderTopWidth: 1,\n    borderTopColor: colors.lightGreen,\n  },\n  saveButton: {\n    backgroundColor: colors.primary,\n    borderRadius: 12,\n    padding: 16,\n    alignItems: 'center',\n  },\n  saveButtonDisabled: {\n    opacity: 0.6,\n  },\n  saveButtonText: {\n    fontSize: 16,\n    fontWeight: '600' as const,\n    color: '#fff',\n  },\n  initialAvatar: {\n    width: '100%',\n    height: '100%',\n    backgroundColor: colors.lightGreen,\n    justifyContent: 'center',\n    alignItems: 'center',\n  },\n  initialAvatarText: {\n    fontSize: 36,\n    fontWeight: '700' as const,\n    color: '#fff',\n  },\n});\n","import { StyleSheet } from 'react-native';\nimport colors from '@/constants/colors';\n\nconst styles = StyleSheet.create({\n    container: {\n        flex: 1,\n        backgroundColor: colors.background,\n    },\n    headerButtons: {\n        position: 'absolute',\n        left: 0,\n        right: 0,\n        zIndex: 100,\n        flexDirection: 'row',\n        justifyContent: 'space-between',\n        alignItems: 'center',\n        paddingHorizontal: 16,\n    },\n    headerButton: {\n        width: 44,\n        height: 44,\n        borderRadius: 22,\n        backgroundColor: colors.darkGreen,\n        justifyContent: 'center',\n        alignItems: 'center',\n        shadowColor: colors.black,\n        shadowOffset: { width: 0, height: 2 },\n        shadowOpacity: 0.15,\n        shadowRadius: 4,\n        elevation: 4,\n    },\n    headerRightButtons: {\n        flexDirection: 'row',\n        gap: 12,\n    },\n    scrollContainer: {\n        flex: 1,\n    },\n    scrollContent: {\n        paddingBottom: 32,\n    },\n    loadingContainer: {\n        flex: 1,\n        justifyContent: 'center',\n        alignItems: 'center',\n        backgroundColor: colors.background,\n    },\n    loadingText: {\n        marginTop: 16,\n        fontSize: 16,\n        color: colors.lightGreen,\n        fontWeight: '500' as const,\n    },\n    heroSection: {\n        position: 'relative',\n    },\n    heroImageContainer: {\n        width: '100%',\n        height: 500,\n        position: 'relative',\n    },\n    heroImage: {\n        width: '100%',\n        height: '100%',\n        backgroundColor: colors.border,\n    },\n    heroGradient: {\n        position: 'absolute',\n        bottom: 0,\n        left: 0,\n        right: 0,\n        height: 100,\n    },\n    changePhotoFab: {\n        position: 'absolute',\n        bottom: 80,\n        right: 20,\n        width: 56,\n        height: 56,\n        borderRadius: 28,\n        backgroundColor: colors.primary,\n        justifyContent: 'center',\n        alignItems: 'center',\n        shadowColor: '#000',\n        shadowOffset: { width: 0, height: 4 },\n        shadowOpacity: 0.3,\n        shadowRadius: 8,\n        elevation: 6,\n    },\n\n    addPhotoContainer: {\n        width: '100%',\n        height: 280,\n        backgroundColor: colors.lightGreen,\n        justifyContent: 'center',\n        alignItems: 'center',\n        paddingHorizontal: 32,\n    },\n    addPhotoIcon: {\n        width: 72,\n        height: 72,\n        borderRadius: 36,\n        backgroundColor: colors.background,\n        justifyContent: 'center',\n        alignItems: 'center',\n        marginBottom: 16,\n    },\n    addPhotoText: {\n        fontSize: 18,\n        fontWeight: '600' as const,\n        color: colors.darkGreen,\n        marginBottom: 4,\n    },\n    addPhotoSubtext: {\n        fontSize: 14,\n        color: colors.mediumGreen,\n    },\n    contentWrapper: {\n        backgroundColor: colors.background,\n        borderTopLeftRadius: 24,\n        borderTopRightRadius: 24,\n        marginTop: -24,\n        zIndex: 10,\n    },\n    content: {\n        padding: 24,\n    },\n    titleSection: {\n        marginBottom: 20,\n    },\n    titleRow: {\n        flexDirection: 'row',\n        alignItems: 'flex-start',\n        gap: 12,\n        marginBottom: 8,\n    },\n    title: {\n        flex: 1,\n        fontSize: 32,\n        fontWeight: '700' as const,\n        color: colors.darkGreen,\n        lineHeight: 40,\n    },\n    editIconButton: {\n        width: 40,\n        height: 40,\n        borderRadius: 20,\n        backgroundColor: colors.lightGreen,\n        justifyContent: 'center',\n        alignItems: 'center',\n        marginTop: 4,\n    },\n    nameEditContainer: {\n        marginBottom: 8,\n    },\n    nameInput: {\n        fontSize: 28,\n        fontWeight: '700' as const,\n        color: colors.darkGreen,\n        backgroundColor: colors.white,\n        borderWidth: 2,\n        borderColor: colors.primary,\n        borderRadius: 12,\n        padding: 12,\n        marginBottom: 12,\n    },\n    nameInputInDetails: {\n        fontSize: 16,\n        color: colors.darkGreen,\n        backgroundColor: colors.background,\n        borderWidth: 1,\n        borderColor: colors.lightGreen,\n        borderRadius: 12,\n        padding: 16,\n    },\n    editButtons: {\n        flexDirection: 'row',\n        gap: 8,\n    },\n    iconButton: {\n        width: 44,\n        height: 44,\n        borderRadius: 22,\n        justifyContent: 'center',\n        alignItems: 'center',\n    },\n    saveIconButton: {\n        backgroundColor: colors.primary,\n    },\n    cancelIconButton: {\n        backgroundColor: colors.lightGreen,\n    },\n    locationRow: {\n        flexDirection: 'row',\n        alignItems: 'center',\n        gap: 6,\n        marginBottom: 12,\n    },\n    location: {\n        fontSize: 16,\n        color: colors.mediumGreen,\n        fontWeight: '500' as const,\n    },\n    ratingRow: {\n        flexDirection: 'row',\n        gap: 4,\n    },\n    reviewCard: {\n        backgroundColor: colors.surface,\n        borderRadius: 16,\n        padding: 20,\n        marginBottom: 24,\n        borderWidth: 1,\n        borderColor: colors.paleYellow,\n    },\n    reviewText: {\n        fontSize: 16,\n        color: colors.darkGreen,\n        lineHeight: 24,\n    },\n    statsSection: {\n        flexDirection: 'row',\n        flexWrap: 'wrap' as const,\n        gap: 12,\n        marginBottom: 24,\n    },\n    statCard: {\n        flex: 1,\n        minWidth: 100,\n        backgroundColor: colors.surface,\n        borderRadius: 16,\n        padding: 16,\n        alignItems: 'center',\n        shadowColor: colors.black,\n        shadowOffset: { width: 0, height: 2 },\n        shadowOpacity: 0.05,\n        shadowRadius: 8,\n        elevation: 2,\n    },\n    statIconContainer: {\n        width: 44,\n        height: 44,\n        borderRadius: 22,\n        backgroundColor: colors.primary,\n        justifyContent: 'center',\n        alignItems: 'center',\n        marginBottom: 12,\n    },\n    statLabel: {\n        fontSize: 13,\n        color: colors.mediumGreen,\n        fontWeight: '500' as const,\n        marginBottom: 4,\n    },\n    statValue: {\n        fontSize: 20,\n        color: colors.darkGreen,\n        fontWeight: '700' as const,\n    },\n    tagsSection: {\n        backgroundColor: colors.surface,\n        borderRadius: 16,\n        padding: 20,\n        marginBottom: 20,\n        shadowColor: '#000',\n        shadowOffset: { width: 0, height: 2 },\n        shadowOpacity: 0.05,\n        shadowRadius: 8,\n        elevation: 2,\n    },\n    sectionHeader: {\n        flexDirection: 'row',\n        alignItems: 'center',\n        gap: 8,\n        marginBottom: 16,\n    },\n    sectionTitle: {\n        fontSize: 18,\n        fontWeight: '700' as const,\n        color: colors.darkGreen,\n    },\n    tagsGrid: {\n        flexDirection: 'row',\n        flexWrap: 'wrap' as const,\n        gap: 8,\n    },\n    tagChip: {\n        backgroundColor: colors.lightGreen,\n        paddingHorizontal: 16,\n        paddingVertical: 8,\n        borderRadius: 20,\n    },\n    tagText: {\n        fontSize: 14,\n        fontWeight: '500' as const,\n        color: colors.darkGreen,\n    },\n    editDetailsButton: {\n        flexDirection: 'row',\n        alignItems: 'center',\n        justifyContent: 'center',\n        gap: 8,\n        backgroundColor: colors.white,\n        borderRadius: 12,\n        paddingVertical: 14,\n        paddingHorizontal: 20,\n        marginBottom: 20,\n        borderWidth: 2,\n        borderColor: colors.primary,\n    },\n    editDetailsText: {\n        fontSize: 16,\n        fontWeight: '600' as const,\n        color: colors.primary,\n    },\n    editSection: {\n        backgroundColor: colors.surface,\n        borderRadius: 16,\n        padding: 20,\n        marginBottom: 20,\n        shadowColor: '#000',\n        shadowOffset: { width: 0, height: 2 },\n        shadowOpacity: 0.05,\n        shadowRadius: 8,\n        elevation: 2,\n    },\n    editSectionTitle: {\n        fontSize: 16,\n        fontWeight: '700' as const,\n        color: colors.darkGreen,\n        marginBottom: 12,\n    },\n    ratingStars: {\n        flexDirection: 'row',\n        gap: 8,\n    },\n    starButton: {\n        padding: 4,\n    },\n    reviewInput: {\n        backgroundColor: colors.background,\n        borderWidth: 1,\n        borderColor: colors.lightGreen,\n        borderRadius: 12,\n        padding: 16,\n        fontSize: 15,\n        color: colors.darkGreen,\n        minHeight: 120,\n    },\n    difficultyOptions: {\n        flexDirection: 'row',\n        gap: 8,\n    },\n    difficultyChip: {\n        flex: 1,\n        paddingVertical: 12,\n        paddingHorizontal: 16,\n        borderRadius: 12,\n        backgroundColor: colors.background,\n        borderWidth: 2,\n        borderColor: colors.lightGreen,\n        alignItems: 'center',\n    },\n    difficultyChipSelected: {\n        backgroundColor: colors.primary,\n        borderColor: colors.primary,\n    },\n    difficultyChipText: {\n        fontSize: 15,\n        fontWeight: '600' as const,\n        color: colors.mediumGreen,\n    },\n    difficultyChipTextSelected: {\n        color: colors.white,\n    },\n    editTagChip: {\n        paddingHorizontal: 16,\n        paddingVertical: 8,\n        borderRadius: 20,\n        backgroundColor: colors.background,\n        borderWidth: 1.5,\n        borderColor: colors.lightGreen,\n    },\n    editTagChipSelected: {\n        backgroundColor: colors.primary,\n        borderColor: colors.primary,\n    },\n    editTagChipText: {\n        fontSize: 14,\n        fontWeight: '500' as const,\n        color: colors.mediumGreen,\n    },\n    editTagChipTextSelected: {\n        color: colors.white,\n    },\n    editActionButtons: {\n        flexDirection: 'row',\n        gap: 12,\n        marginTop: 24,\n    },\n    actionButton: {\n        flex: 1,\n        flexDirection: 'row',\n        alignItems: 'center',\n        justifyContent: 'center',\n        gap: 8,\n        paddingVertical: 14,\n        borderRadius: 12,\n    },\n    cancelActionButton: {\n        backgroundColor: colors.background,\n        borderWidth: 2,\n        borderColor: colors.lightGreen,\n    },\n    cancelActionText: {\n        fontSize: 16,\n        fontWeight: '600' as const,\n        color: colors.darkGreen,\n    },\n    saveActionButton: {\n        backgroundColor: colors.primary,\n    },\n    saveActionText: {\n        fontSize: 16,\n        fontWeight: '600' as const,\n        color: colors.white,\n    },\n    mapSection: {\n        marginBottom: 20,\n    },\n    mapContainer: {\n        height: 260,\n        borderRadius: 16,\n        overflow: 'hidden',\n        marginBottom: 12,\n        borderWidth: 1,\n        borderColor: colors.lightGreen,\n    },\n    map: {\n        width: '100%',\n        height: '100%',\n    },\n    webMapPlaceholder: {\n        justifyContent: 'center',\n        alignItems: 'center',\n        backgroundColor: colors.lightGreen,\n    },\n    webMapText: {\n        marginTop: 12,\n        fontSize: 14,\n        color: colors.mediumGreen,\n    },\n    directionsButton: {\n        flexDirection: 'row',\n        alignItems: 'center',\n        justifyContent: 'center',\n        backgroundColor: colors.primary,\n        borderRadius: 12,\n        paddingVertical: 16,\n        paddingHorizontal: 24,\n        gap: 10,\n        shadowColor: colors.primary,\n        shadowOffset: { width: 0, height: 4 },\n        shadowOpacity: 0.3,\n        shadowRadius: 8,\n        elevation: 4,\n    },\n    directionsButtonText: {\n        fontSize: 16,\n        fontWeight: '700' as const,\n        color: colors.white,\n    },\n    detailsSection: {\n        backgroundColor: colors.surface,\n        borderRadius: 16,\n        padding: 20,\n        shadowColor: '#000',\n        shadowOffset: { width: 0, height: 2 },\n        shadowOpacity: 0.05,\n        shadowRadius: 8,\n        elevation: 2,\n    },\n    detailsTitle: {\n        fontSize: 18,\n        fontWeight: '700' as const,\n        color: colors.darkGreen,\n        marginBottom: 16,\n    },\n    detailRow: {\n        flexDirection: 'row',\n        alignItems: 'flex-start',\n        paddingVertical: 12,\n        borderBottomWidth: 1,\n        borderBottomColor: colors.background,\n    },\n    detailIcon: {\n        width: 36,\n        height: 36,\n        borderRadius: 18,\n        backgroundColor: colors.lightGreen,\n        justifyContent: 'center',\n        alignItems: 'center',\n        marginRight: 12,\n    },\n    detailContent: {\n        flex: 1,\n    },\n    detailLabel: {\n        fontSize: 13,\n        fontWeight: '600' as const,\n        color: colors.mediumGreen,\n        marginBottom: 2,\n    },\n    detailValue: {\n        fontSize: 16,\n        color: colors.darkGreen,\n        fontWeight: '500' as const,\n    },\n});\n\nexport default styles;\n","import { Link, Stack } from \"expo-router\";\nimport React from 'react';\nimport { View, Text, StyleSheet } from \"react-native\";\n\nexport default function NotFoundScreen() {\n  return (\n    <>\n      <Stack.Screen options={{ title: \"Oops!\" }} />\n      <View style={styles.container}>\n        <Text style={styles.title}>This screen doesn&apos;t exist.</Text>\n\n        <Link href=\"/\" asChild style={styles.link}>\n          <Text style={styles.linkText}>Go to home screen!</Text>\n        </Link>\n      </View>\n    </>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    padding: 20,\n  },\n  title: {\n    fontSize: 20,\n    fontWeight: \"bold\",\n  },\n  link: {\n    marginTop: 15,\n    paddingVertical: 15,\n  },\n  linkText: {\n    fontSize: 14,\n    color: \"#2e78b7\",\n  },\n});\n","import { Coordinate } from '@/types/trail';\n\nexport function calculateDistance(coord1: Coordinate, coord2: Coordinate): number {\n  const R = 6371;\n  const dLat = toRad(coord2.latitude - coord1.latitude);\n  const dLon = toRad(coord2.longitude - coord1.longitude);\n  const lat1 = toRad(coord1.latitude);\n  const lat2 = toRad(coord2.latitude);\n\n  const a =\n    Math.sin(dLat / 2) * Math.sin(dLat / 2) +\n    Math.sin(dLon / 2) * Math.sin(dLon / 2) * Math.cos(lat1) * Math.cos(lat2);\n  const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\n  return R * c;\n}\n\nfunction toRad(value: number): number {\n  return (value * Math.PI) / 180;\n}\n\nexport function calculateTotalDistance(coordinates: Coordinate[]): number {\n  if (coordinates.length < 2) return 0;\n  \n  let total = 0;\n  for (let i = 0; i < coordinates.length - 1; i++) {\n    const dist = calculateDistance(coordinates[i], coordinates[i + 1]);\n    total += dist;\n  }\n  return total * 1000;\n}\n\nexport function formatDistance(meters: number): string {\n  if (meters < 1000) {\n    return `${Math.round(meters)}m`;\n  }\n  const km = meters / 1000;\n  return `${km.toFixed(2)}km`;\n}\n\nexport function formatDuration(seconds: number): string {\n  const hrs = Math.floor(seconds / 3600);\n  const mins = Math.floor((seconds % 3600) / 60);\n  const secs = seconds % 60;\n\n  if (hrs > 0) {\n    return `${hrs}h ${mins}m`;\n  }\n  if (mins > 0) {\n    return `${mins}m ${secs}s`;\n  }\n  return `${secs}s`;\n}\n\nexport function formatDate(timestamp: number): string {\n  const date = new Date(timestamp);\n  const now = new Date();\n  const diffDays = Math.floor((now.getTime() - date.getTime()) / (1000 * 60 * 60 * 24));\n\n  if (diffDays === 0) {\n    return `Today at ${date.toLocaleTimeString('en-US', { hour: 'numeric', minute: '2-digit' })}`;\n  }\n  if (diffDays === 1) {\n    return `Yesterday at ${date.toLocaleTimeString('en-US', { hour: 'numeric', minute: '2-digit' })}`;\n  }\n  return date.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' });\n}\n","import { Appearance } from 'react-native';\n\n// Light theme (existing)\nconst lightTheme = {\n  primary: '#5d6b4a',\n  accent: '#FFFE77',\n  background: '#F8F7F2',\n  darkGreen: '#282E10',\n  mediumGreen: '#3d4520',\n  lightGreen: '#a8ad8e',\n  paleYellow: '#d4d4a0',\n  // semantic additions for more consistent theming\n  surface: '#f3f4f6',\n  border: '#d1d5db', // slightly darker for better contrast\n  muted: '#5b646f', // darker muted text for accessibility\n  white: '#ffffff',\n  black: '#000000',\n  info: '#2563eb',\n  danger: '#b91c1c',\n  tabBarBg: 'rgba(40,46,16,0.95)',\n  light: {\n    text: '#11120f',\n    background: '#F7F7F3',\n    tint: '#5d6b4a',\n    tabIconDefault: '#7f8b7a', // darker default icon color\n    tabIconSelected: '#FFFE77',\n  },\n};\n\n// Dark theme (new)\nconst darkTheme = {\n  primary: '#86a06a', // slightly lighter green for contrast on dark bg\n  accent: '#FFFE77',\n  background: '#071009', // very dark background\n  darkGreen: '#b5c47aff', // used for text in dark mode\n  mediumGreen: '#223015',\n  lightGreen: '#6b7b56',\n  paleYellow: '#bfb77a',\n  // semantic additions for dark mode\n  surface: '#0f1a14',\n  border: '#123019',\n  muted: '#9ca3af',\n  white: '#eef7e6',\n  black: '#071009',\n  info: '#6596ff',\n  danger: '#ef9a9a',\n  tabBarBg: 'rgba(10,12,6,0.95)',\n  light: {\n    text: '#eef7e6',\n    background: '#071009',\n    tint: '#86a06a',\n    tabIconDefault: '#9ca3af',\n    tabIconSelected: '#FFFE77',\n  },\n};\n\n// Start with system preference but keep a mutable object so existing imports\n// continue to work (we mutate the exported object when theme changes).\nconst systemScheme = Appearance.getColorScheme();\nconst initial = systemScheme === 'dark' ? darkTheme : lightTheme;\n\n// Mutable colors object exported as default for backwards compatibility.\nconst colors: any = { ...initial };\n\nfunction applyTheme(theme: any) {\n  // mutate the exported colors object in-place\n  Object.keys(colors).forEach((k) => delete colors[k]);\n  Object.assign(colors, theme);\n}\n\n// Listen for system theme changes and update exported colors in-place.\nif (Appearance && typeof Appearance.addChangeListener === 'function') {\n  Appearance.addChangeListener((evt: any) => {\n    const scheme = evt.colorScheme || Appearance.getColorScheme();\n    applyTheme(scheme === 'dark' ? darkTheme : lightTheme);\n  });\n}\n\n// Allow manual override at runtime\nexport function setTheme(scheme: 'light' | 'dark' | null) {\n  if (scheme === 'dark') applyTheme(darkTheme);\n  else if (scheme === 'light') applyTheme(lightTheme);\n  else applyTheme(Appearance.getColorScheme() === 'dark' ? darkTheme : lightTheme);\n}\n\nexport default colors;\n","import { StyleSheet } from 'react-native';\nimport colors from '@/constants/colors';\n\nexport default StyleSheet.create({\n  container: {\n    overflow: 'hidden',\n    borderRadius: 12,\n    backgroundColor: colors.surface,\n  },\n  map: {\n    width: '100%',\n    height: '100%',\n  },\n  placeholder: {\n    justifyContent: 'center',\n    alignItems: 'center',\n    padding: 12,\n  },\n  text: {\n    color: colors.primary,\n    fontWeight: 'bold',\n    fontSize: 16,\n  },\n  subtext: {\n    color: colors.muted,\n    fontSize: 12,\n    marginTop: 4,\n  },\n});\n","import React, { useEffect, useRef } from 'react';\nimport { Text, View } from 'react-native';\nimport styles from './TrailMapPreview.styles';\nimport { Coordinate } from '@/types/trail';\nimport * as maplibregl from 'maplibre-gl';\nimport 'maplibre-gl/dist/maplibre-gl.css';\n\n\ninterface TrailMapPreviewProps {\n  coordinates?: Coordinate[];\n  // backend may return path as [[lon, lat], ...]\n  path?: number[][] | null;\n  style?: any;\n  height?: number | string;\n  startLatitude?: number | null;\n  startLongitude?: number | null;\n}\n\nexport default function TrailMapPreview({ coordinates, path, style, height = 260, startLatitude = null, startLongitude = null }: TrailMapPreviewProps) {\n  const mapContainerRef = useRef<HTMLDivElement | null>(null);\n  const mapRef = useRef<maplibregl.Map | null>(null);\n  const markerRef = useRef<maplibregl.Marker | null>(null);\n\n  // derive coords from coordinates or path\n  const coords: Coordinate[] = (coordinates && coordinates.length > 0)\n    ? coordinates\n    : (Array.isArray((path as any)) ? (path as number[][]).map(p => ({ latitude: p[1], longitude: p[0] })) : []);\n\n  useEffect(() => {\n    if (!mapContainerRef.current) return;\n\n    // Initialize map\n    const center: [number, number] = (startLatitude != null && startLongitude != null)\n      ? [startLongitude, startLatitude]\n      : (coords.length > 0 ? [coords[0].longitude, coords[0].latitude] : [0, 0]);\n\n    const map = new maplibregl.Map({\n      container: mapContainerRef.current,\n      style: 'https://basemaps.cartocdn.com/gl/positron-gl-style/style.json',\n      center,\n      zoom: coords.length > 0 ? 12 : 1,\n      interactive: false,\n    });\n\n    mapRef.current = map;\n\n    map.on('load', () => {\n      // If we have a route (multiple points), draw it\n      if (coords && coords.length > 1) {\n        const geojson = {\n          type: 'Feature',\n          properties: {},\n          geometry: {\n            type: 'LineString',\n            coordinates: coords.map(c => [c.longitude, c.latitude]),\n          }\n        } as any;\n\n        if (map.getSource('preview-route')) {\n          (map.getSource('preview-route') as maplibregl.GeoJSONSource).setData(geojson);\n        } else {\n          map.addSource('preview-route', { type: 'geojson', data: geojson });\n\n          map.addLayer({\n            id: 'preview-route',\n            type: 'line',\n            source: 'preview-route',\n            layout: { 'line-join': 'round', 'line-cap': 'round' },\n            paint: { 'line-color': '#5d6b4a', 'line-width': 3 }\n          });\n        }\n\n        const bounds = new maplibregl.LngLatBounds();\n        coords.forEach(c => bounds.extend([c.longitude, c.latitude]));\n        map.fitBounds(bounds, { padding: 10, maxZoom: 16 });\n      }\n\n      // If there's a single point, place a marker at the location and center\n      else if (coords && coords.length === 1) {\n        const pt = coords[0];\n        // create a simple default marker\n        if (markerRef.current) {\n          markerRef.current.setLngLat([pt.longitude, pt.latitude]);\n        } else {\n          const m = new maplibregl.Marker({ color: '#5d6b4a' })\n            .setLngLat([pt.longitude, pt.latitude])\n            .addTo(map);\n          markerRef.current = m;\n        }\n\n        map.setCenter([pt.longitude, pt.latitude]);\n        map.setZoom(14);\n      }\n    });\n\n    return () => {\n      try {\n        map.remove();\n      } catch (e) {\n        // ignore remove errors\n      }\n      mapRef.current = null;\n      markerRef.current = null;\n    };\n  // Recreate map when coordinates/path/start center change\n  }, [JSON.stringify(coords), startLatitude, startLongitude]);\n\n  return (\n    <View style={[styles.container, style]}>\n      {coords && coords.length > 0 ? (\n        <div\n          ref={mapContainerRef}\n          style={{ width: '100%', height: typeof height === 'number' ? `${height}px` : height }}\n        />\n      ) : (\n        <View style={styles.placeholder}>\n          <Text style={styles.text}>Map Preview (Web)</Text>\n          <Text style={styles.subtext}>{coords?.length || 0} points recorded</Text>\n        </View>\n      )}\n    </View>\n  );\n}\n\n// styles imported from TrailMapPreview.styles.ts\n","import React, { useEffect, useState, useMemo, useCallback } from 'react';\nimport createContextHook from '@nkzw/create-context-hook';\nimport { useAuth } from '@/context/AuthContext';\nimport { DogProfile } from '@/types/dog-profile';\nimport { API_URL } from '@/lib/api';\n\nexport const [DogsContext, useDogs] = createContextHook(() => {\n  const { user, session, isLoading: isAuthLoading } = useAuth();\n  const [dogProfiles, setDogProfiles] = useState<DogProfile[]>([]);\n  const [activeDogId, setActiveDogId] = useState<string | null>(null);\n  const [isDogProfileLoading, setIsDogProfileLoading] = useState<boolean>(true);\n\n  const dogProfile = useMemo(() => \n    dogProfiles.find(d => d.id === activeDogId) || dogProfiles[0] || null\n  , [dogProfiles, activeDogId]);\n\n  const loadDogProfiles = useCallback(async (userId: string, token: string) => {\n    console.log('Loading dog profiles for user:', userId);\n    setIsDogProfileLoading(true);\n    try {\n      // We assume GET /dog returns the list of dogs for the current user\n      // This endpoint is needed to discover the dog IDs\n      const response = await fetch(`${API_URL}/dog`, {\n        headers: {\n          'Authorization': `Bearer ${token}`\n        }\n      });\n      \n      if (response.ok) {\n        const data = await response.json();\n        if (Array.isArray(data)) {\n          setDogProfiles(data);\n          if (data.length > 0 && !activeDogId) {\n            setActiveDogId(data[0].id);\n          }\n        } else if (data && typeof data === 'object') {\n          setDogProfiles([data]);\n          setActiveDogId(data.id);\n        } else {\n          setDogProfiles([]);\n        }\n      } else {\n        setDogProfiles([]);\n      }\n    } catch (error) {\n      console.error('Error loading dog profiles:', error);\n      setDogProfiles([]);\n    } finally {\n      setIsDogProfileLoading(false);\n    }\n  }, [activeDogId]);\n\n  const refreshDogProfile = useCallback(async () => {\n    if (user && session) {\n      await loadDogProfiles(user.id, session.accessToken);\n    }\n  }, [user, session, loadDogProfiles]);\n\n  useEffect(() => {\n    // Don't decide dog profile loading state until auth has finished initializing.\n    if (isAuthLoading) return;\n\n    if (user && session) {\n      loadDogProfiles(user.id, session.accessToken);\n    } else {\n      setDogProfiles([]);\n      setIsDogProfileLoading(false);\n    }\n  }, [user, session, loadDogProfiles, isAuthLoading]);\n\n  const createDogProfile = useCallback(async (profile: Omit<DogProfile, 'id' | 'created_at' | 'updated_at'>) => {\n    if (!session) throw new Error('No session');\n    \n    const response = await fetch(`${API_URL}/dog`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        'Authorization': `Bearer ${session.accessToken}`\n      },\n      body: JSON.stringify(profile),\n    });\n\n    if (!response.ok) {\n      const errorData = await response.json();\n      throw new Error(errorData.detail?.[0]?.msg || 'Failed to create dog profile');\n    }\n\n    const data = await response.json();\n    setDogProfiles(prev => [...prev, data]);\n    setActiveDogId(data.id);\n    return data;\n  }, [session]);\n\n  const updateDogProfile = useCallback(async (profile: DogProfile) => {\n    if (!session) throw new Error('No session');\n    if (!profile.id) throw new Error('Dog ID is required for update');\n    \n    const response = await fetch(`${API_URL}/dog/${profile.id}`, {\n      method: 'PUT',\n      headers: {\n        'Content-Type': 'application/json',\n        'Authorization': `Bearer ${session.accessToken}`\n      },\n      body: JSON.stringify(profile),\n    });\n\n    if (!response.ok) {\n      const errorData = await response.json();\n      throw new Error(errorData.detail?.[0]?.msg || 'Failed to update dog profile');\n    }\n\n    const data = await response.json();\n    setDogProfiles(prev => prev.map(d => d.id === data.id ? data : d));\n    return data;\n  }, [session]);\n\n  return useMemo(() => ({\n    dogProfile,\n    dogProfiles,\n    activeDogId,\n    setActiveDogId,\n    isDogProfileLoading,\n    hasDogProfile: dogProfiles.length > 0,\n    refreshDogProfile,\n    createDogProfile,\n    updateDogProfile,\n  }), [dogProfile, dogProfiles, activeDogId, isDogProfileLoading, refreshDogProfile, createDogProfile, updateDogProfile]);\n});\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","var deferred = [];\n__webpack_require__.O = (result, chunkIds, fn, priority) => {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar [chunkIds, fn, priority] = deferred[i];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every((key) => (__webpack_require__.O[key](chunkIds[j])))) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.p = \"/\";","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t792: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n__webpack_require__.O.j = (chunkId) => (installedChunks[chunkId] === 0);\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = (parentChunkLoadingFunction, data) => {\n\tvar [chunkIds, moreModules, runtime] = data;\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some((id) => (installedChunks[id] !== 0))) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkId] = 0;\n\t}\n\treturn __webpack_require__.O(result);\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunkweb\"] = self[\"webpackChunkweb\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","// startup\n// Load entry module and return exports\n// This entry module depends on other loaded chunks and execution need to be delayed\nvar __webpack_exports__ = __webpack_require__.O(undefined, [607], () => (__webpack_require__(389)))\n__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n"],"names":["map","webpackContext","req","id","webpackContextResolve","__webpack_require__","o","e","Error","code","keys","Object","resolve","module","exports","DOG_SIZES","PERSONALITY_TAGS","RECALL_RELIABILITY_OPTIONS","LOCATION_KEY","START_TIME_KEY","MAX_ELEV_KEY","MAX_SPEED_KEY","LAST_UPDATE_KEY","RecordScreenWeb","saveTrail","getTrailById","useTrails","user","useAuth","params","useLocalSearchParams","router","useRouter","trailId","undefined","existingTrail","mapRef","useRef","isRecording","setIsRecording","useState","coordinates","setCoordinates","currentLocation","setCurrentLocation","duration","setDuration","hasPermission","setHasPermission","isLoadingPermission","setIsLoadingPermission","startLocation","setStartLocation","watchIdRef","Map","timerRef","wakeLockRef","bottomSheetHeight","Dimensions","get","height","collapsedHeight","bottomSheetAnim","Animated","Value","current","isExpanded","setIsExpanded","elevation","setElevation","maxElevation","setMaxElevation","pace","setPace","speed","setSpeed","maxSpeed","setMaxSpeed","showSaveModal","setShowSaveModal","draftTrail","setDraftTrail","formName","setFormName","formDescription","setFormDescription","formPhoto","setFormPhoto","useEffect","navigator","permissions","query","status","name","state","onchange","Promise","reject","geolocation","getCurrentPosition","timeout","err","console","warn","loadRecordingState","async","coordsStr","AsyncStorage","getItem","coords","JSON","parse","maxElevationStr","parseFloat","maxSpeedStr","startTimeStr","elapsed","Math","floor","Date","now","parseInt","startTimer","error","setInterval","cancelSave","distanceKm","calculateTotalDistance","paceMinPerKm","minutes","seconds","round","toString","padStart","initialHeight","panResponder","PanResponder","create","onStartShouldSetPanResponder","onMoveShouldSetPanResponder","_","gestureState","abs","dy","onPanResponderGrant","_value","onPanResponderMove","newValue","setValue","onPanResponderRelease","threshold","currentValue","expandBottomSheet","collapseBottomSheet","spring","toValue","useNativeDriver","tension","friction","start","_jsxs","View","style","styles","loadingContainer","children","_jsx","ActivityIndicator","size","color","colors","primary","Text","loadingText","permissionContainer","MapPin","permissionTitle","permissionText","TouchableOpacity","permissionButton","onPress","permissionButtonText","distance","progress","length","min","showProgress","container","TrailMap","ref","initialRegion","latitude","longitude","latitudeDelta","longitudeDelta","showsUserLocation","followsUserLocation","showsMyLocationButton","recenterButton","pos","coord","animateToRegion","activeOpacity","Navigation","bottomSheet","add","bottom","assign","panHandlers","handleBar","handleContainer","toggleBottomSheet","handle","ChevronDown","ChevronUp","bottomSheetContent","statsGrid","statItem","statItemLabel","statItemValue","formatDuration","formatDistance","toFixed","recordButton","recordButtonActive","log","clearWatch","release","clearInterval","finalCoords","finalMaxElevation","finalMaxSpeed","finalDuration","Alert","alert","removeItem","finalPace","trail","date","city","country","description","photo","startTime","setItem","stringify","enableHighAccuracy","watchPosition","prev","newCoords","catch","maximumAge","wakeLock","request","message","_Fragment","Square","fill","recordButtonText","Play","expandedContent","divider","optionRow","optionIconContainer","Watch","optionTextContainer","optionTitle","optionSubtitle","optionBadge","optionBadgeText","Bell","optionBadgeActive","optionBadgeTextActive","Modal","visible","animationType","transparent","onRequestClose","modalOverlay","modalContainer","modalContent","modalTitle","fontSize","marginTop","TextInput","placeholder","value","onChangeText","input","multiline","flexDirection","gap","modalButton","modalButtonText","modalButtonPrimary","toSave","savedId","push","StyleSheet","flex","backgroundColor","background","absoluteFillObject","webContainer","justifyContent","alignItems","padding","webText","muted","textAlign","fontWeight","darkGreen","paddingHorizontal","paddingVertical","borderRadius","statsContainer","position","left","right","statBox","shadowColor","shadowOffset","width","shadowOpacity","shadowRadius","statLabel","marginBottom","statValue","controlContainer","borderTopLeftRadius","borderTopRightRadius","paddingTop","paddingBottom","border","flexWrap","surface","textTransform","letterSpacing","marginVertical","marginRight","maxHeight","overflow","borderWidth","borderColor","marginLeft","top","TrailsScreen","trails","isLoading","FlatList","data","renderItem","renderTrailItem","item","trailItem","trailHeader","iconContainer","trailInfo","trailDate","formatDate","statsRow","statText","Clock","keyExtractor","contentContainerStyle","emptyList","list","ListEmptyComponent","renderEmptyState","emptyContainer","emptyTitle","emptyText","white","black","lineHeight","AccountContext","useAccount","createContextHook","session","userProfile","setUserProfile","setIsLoading","fetchAccount","useCallback","accessToken","response","fetch","API_URL","headers","ok","json","updateAccount","method","body","updates","errorData","detail","msg","deleteAccount","useMemo","refreshAccount","safeContainer","stickyHeader","stickySearchContainer","searchBar","demoButton","demoButtonText","searchPlaceholder","largeTrailCard","largeTrailImage","bookmarkButton","cardGradient","cardOverlayContent","overlayTrailName","textShadowColor","textShadowOffset","textShadowRadius","overlayLocation","opacity","overlayBadges","badge","badgeText","categoriesSection","categoriesScroll","categoryButton","categoryButtonActive","categoryText","categoryTextActive","categoryTrailsSection","bottomPadding","placeholderImage","searchModalContainer","searchModalHeader","borderBottomWidth","borderBottomColor","backButton","paleYellow","searchModalInputContainer","searchModalInput","clearButton","searchModalContent","currentLocationItem","marginHorizontal","locationIconContainer","locationTextContainer","locationTitle","locationSubtitle","suggestionItem","suggestionIconContainer","suggestionTextContainer","suggestionTitle","suggestionSubtitle","AuthContext","setSession","setUser","savedSession","parsedSession","loadSession","requestOtp","email","verifyOtp","otpCode","requestRegistration","verifyRegistration","signInWithToken","sessionObj","tokenResponse","tokenType","signOut","isAuthenticated","ENVIRONMENT_TAG_OPTIONS","DIFFICULTY_OPTIONS","TrailDetailScreen","updateTrailName","updateTrailPhoto","updateTrailDetails","getTrailWithUser","setTrail","isEditingName","setIsEditingName","editedName","setEditedName","isEditingDetails","setIsEditingDetails","editedRating","setEditedRating","editedReview","setEditedReview","editedTags","setEditedTags","editedDifficulty","setEditedDifficulty","editedNameInDetails","setEditedNameInDetails","isUploadingPhoto","setIsUploadingPhoto","fileInputRef","scrollY","insets","useSafeAreaInsets","IconOrEmoji","IconComponent","emoji","isSaved","setIsSaved","loadTrail","foundTrail","rating","review","environment_tags","difficulty","loadedTrail","handlePickImage","click","region","canEdit","user_id","max","type","accept","display","onChange","file","event","target","files","startsWith","reader","FileReader","onload","base64","result","onerror","readAsDataURL","headerButtons","headerButton","handleBack","back","ArrowLeft","headerRightButtons","handleShare","Share2","handleSave","Bookmark","handleMore","MoreVertical","ScrollView","scrollContainer","scrollContent","onScroll","nativeEvent","contentOffset","y","scrollEventThrottle","heroSection","heroImageContainer","Image","source","uri","heroImage","contentFit","cachePolicy","LinearGradient","heroGradient","changePhotoFab","disabled","Camera","addPhotoContainer","addPhotoIcon","addPhotoText","addPhotoSubtext","contentWrapper","content","titleSection","nameEditContainer","nameInput","autoFocus","placeholderTextColor","editButtons","iconButton","saveIconButton","trim","Check","cancelIconButton","handleCancelEdit","X","titleRow","title","toLocaleDateString","locationRow","lightGreen","location","ratingRow","star","Star","reviewCard","reviewText","statsSection","statCard","statIconContainer","strokeWidth","TrendingUp","tagsSection","sectionHeader","Tag","sectionTitle","tagsGrid","tag","index","tagChip","tagText","editDetailsButton","Edit3","editDetailsText","editSection","editSectionTitle","nameInputInDetails","ratingStars","starButton","reviewInput","numberOfLines","textAlignVertical","difficultyOptions","difficultyChip","difficultyChipSelected","difficultyChipText","difficultyChipTextSelected","editTagChip","includes","editTagChipSelected","filter","t","toggleTag","editTagChipText","editTagChipTextSelected","editActionButtons","actionButton","cancelActionButton","handleCancelDetailsEdit","cancelActionText","saveActionButton","saveActionText","mapSection","mapContainer","scrollEnabled","zoomEnabled","directionsButton","handleGetDirections","url","Linking","canOpenURL","then","supported","openURL","directionsButtonText","detailsTitle","detailRow","detailIcon","detailContent","detailLabel","detailValue","Activity","Calendar","toLocaleString","weekday","year","month","day","hour","minute","SignupScreen","setEmail","setName","setOtpCode","step","setStep","KeyboardAvoidingView","behavior","header","UserPlus","subtitle","form","inputContainer","label","autoCapitalize","editable","keyboardType","autoComplete","button","buttonDisabled","toLowerCase","buttonText","window","PublicKeyCredential","opts","webauthnRegisterOptions","rpId","rp_id","rp","userIdStr","userId","String","userName","user_name","publicKey","challenge","base64UrlToBuffer","rpName","rp_name","hostname","TextEncoder","encode","displayName","pubKeyCredParams","pub_key_cred_params","exclude","excludeCredentials","exclude_credentials","exclude_credentials_list","Array","isArray","c","cred","credentials","attestation","clientDataJSON","bufferToBase64Url","attestationObject","rawId","webauthnRegisterVerify","nickname","maxLength","helperText","replace","secondaryButton","secondaryButtonText","footer","footerText","linkText","light","text","LoginScreen","logo","webauthnAuthOptions","allow_credentials","allowCredentials","assertion","authData","authenticatorData","signature","credentialId","verifyResp","webauthnAuthVerify","customAlphabet","alphabet","defaultSize","i","random","nanoid","CATEGORIES","icon","Heart","Umbrella","ExploreScreen","loadNearbyTrails","saveTrailBookmark","removeTrailBookmark","isTrailSaved","selectedCategory","setSelectedCategory","nearbyTrails","setNearbyTrails","isLoadingNearby","setIsLoadingNearby","setUserCity","bookmarkAnimations","setBookmarkAnimations","searchQuery","setSearchQuery","showSearchModal","setShowSearchModal","searchSuggestions","setSearchSuggestions","loadUserLocationAndNearbyTrails","useFocusEffect","loadSearchSuggestions","suggestions","slice","handleCloseSearchModal","getBookmarkAnimation","newAnim","filteredTrails","filtered","sort","a","b","some","getFilteredTrails","showsVerticalScrollIndicator","stickyHeaderIndices","handleSearchBarPress","Search","horizontal","showsHorizontalScrollIndicator","category","Icon","isSelected","handleCategoryPress","categoryId","tabIconSelected","anim","handleNavigateToTrail","TrailMapPreview","path","startLatitude","startLongitude","locations","stopPropagation","isRealTrail","test","sequence","timing","handleBookmarkPress","transform","scale","BarChart3","distance_from_user","accent","presentationStyle","ChevronLeft","returnKeyType","handleCurrentLocationPress","handleSuggestionPress","suggestionId","DogBasicsScreen","dogProfile","useDogs","setNickname","age","setAge","setSize","setPhoto","showSizePicker","setShowSizePicker","isLoadingImage","setIsLoadingImage","pickImage","ImagePicker","mediaTypes","allowsEditing","aspect","quality","canceled","assets","takePhoto","Stack","Screen","options","headerShown","progressContainer","progressDot","progressDotActive","photoContainer","handleImagePicker","photoPlaceholder","photoPlaceholderText","photoOverlay","Upload","formSection","testID","pickerButton","pickerButtonText","pickerButtonTextPlaceholder","pickerOptions","s","pickerOption","pickerOptionSelected","pickerOptionText","pickerOptionTextSelected","nextButton","handleNext","parsedAge","isNaN","pathname","isEditing","nextButtonText","LOCATION_TRACKING_TASK","RecordScreen","locationSubscription","formTags","setFormTags","formDifficulty","setFormDifficulty","foregroundStatus","Location","backgroundStatus","bgError","accuracy","Balanced","locError","errorMessage","requestPermissions","TaskManager","remove","tags","initialCoord","BestForNavigation","distanceInterval","timeInterval","foregroundService","notificationTitle","notificationBody","notificationColor","pausesUpdatesAutomatically","showsBackgroundLocationIndicator","bgLocationError","altitude","currentElevation","currentSpeed","tabBar","tabBarBg","tabButton","tabTouchable","tabContent","iconWrapper","AnimatedTabBar","descriptors","navigation","animatedValues","routes","r","key","forEach","route","tabBarPaddingBottom","tabBarLabel","tabBarIcon","isFocused","animatedValue","containerWidth","interpolate","inputRange","outputRange","textOpacity","iconColor","tabIconDefault","accessibilityRole","accessibilityState","selected","accessibilityLabel","tabBarAccessibilityLabel","emit","canPreventDefault","defaultPrevented","navigate","focused","TabLayout","Tabs","props","screenOptions","tabBarActiveTintColor","tabBarInactiveTintColor","User","Index","Redirect","href","DEMO_TRAIL","DemoTrailScreen","scrollView","headerContent","locationText","section","zIndex","__EXPO_PUBLIC_API_URL__","process","base64Url","repeat","raw","atob","Buffer","from","rawLength","array","Uint8Array","charCodeAt","buffer","bytes","binary","byteLength","fromCharCode","btoa","res","payload","DogPersonalityScreen","refreshDogProfile","createDogProfile","updateDogProfile","selectedTags","setSelectedTags","recallReliability","setRecallReliability","isSaving","setIsSaving","personality_tags","recall_reliability","tagsContainer","tagSelected","tagTextSelected","recallContainer","option","recallOption","recallOptionSelected","recallText","recallTextSelected","backButtonText","finishButton","finishButtonDisabled","profileData","finishButtonText","TrailsContext","setTrails","savedTrails","setSavedTrails","isSavedLoading","setIsSavedLoading","loadTrails","resp","loadSavedTrails","coordsToPath","surface_type","surfaceType","max_elevation","deleteTrail","found","find","encodeURIComponent","txt","updated","forwardRef","mapContainerRef","useImperativeHandle","easeTo","center","zoom","fitToCoordinates","bounds","maplibregl","extend","fitBounds","edgePadding","interactive","on","addSource","addLayer","alignSelf","mediumGreen","ThemeContext","createContext","theme","setThemeMode","ThemeProvider","system","Appearance","getColorScheme","setThemeState","setTheme","Provider","sys","SplashScreen","queryClient","QueryClient","RootLayoutNav","hasDogProfile","isDogProfileLoading","segments","useSegments","inAuthGroup","inLoginOrSignup","inOnboarding","headerBackTitle","RootLayout","QueryClientProvider","client","DogsContext","GestureHandlerRootView","ExploreWebScreen","showPicker","setShowPicker","React","selectedCoords","setSelectedCoords","setDistanceKm","containerReady","setContainerReady","defaultCenter","getSource","features","paint","lat","lngLat","lng","src","setData","geometry","flyTo","handleSearchNearby","el","d","require","ProfileScreen","isAccountLoading","isTrailsLoading","showEditModal","setShowEditModal","editedPhoto","setEditedPhoto","selectedTab","setSelectedTab","defaultName","split","defaultPhoto","totalWalks","totalTime","reduce","acc","totalDistance","handleTabPress","tab","handleEditDogProfile","handleCloseEditModal","displayedTrails","userSection","userHeader","userAvatar","handleOpenEditModal","userAvatarImage","initialAvatar","initialAvatarText","charAt","toUpperCase","userInfo","userEmailRow","Mail","userEmail","dogCardContainer","loadingDogCard","dogCard","dogPhotoContainer","dogPhoto","dogPhotoPlaceholder","Dog","dogName","dogNickname","nicknameSpacing","hours","formatTime","dogInfoRow","dogInfoBadge","dogInfoText","noDogCard","noDogText","addDogButton","addDogButtonText","tabsContainer","tabActive","tabCount","tabCountActive","tabText","tabTextActive","trailsSection","trailCard","trailImage","trailGradient","trailContent","trailName","trailLocation","trailBadges","trailBadge","trailBadgeText","signOutButton","signOutButtonDisabled","LogOut","signOutText","modalHeader","closeButton","photoSection","editPhoto","cameraOverlay","photoHint","inputSection","inputLabel","disabledInput","disabledInputText","inputHint","modalFooter","saveButton","saveButtonDisabled","saveButtonText","borderTopWidth","borderTopColor","editIconButton","minWidth","minHeight","webMapPlaceholder","webMapText","detailsSection","NotFoundScreen","Link","asChild","link","calculateDistance","coord1","coord2","dLat","toRad","dLon","lat1","lat2","sin","cos","atan2","sqrt","PI","total","meters","hrs","mins","secs","timestamp","diffDays","getTime","toLocaleTimeString","lightTheme","info","danger","tint","darkTheme","initial","applyTheme","k","scheme","addChangeListener","evt","colorScheme","subtext","markerRef","p","geojson","properties","layout","maxZoom","pt","setLngLat","m","addTo","setCenter","setZoom","isAuthLoading","dogProfiles","setDogProfiles","activeDogId","setActiveDogId","setIsDogProfileLoading","loadDogProfiles","token","profile","__webpack_module_cache__","moduleId","cachedModule","__webpack_modules__","call","deferred","O","chunkIds","fn","priority","notFulfilled","Infinity","fulfilled","j","every","splice","n","getter","__esModule","definition","defineProperty","enumerable","g","globalThis","this","Function","obj","prop","prototype","hasOwnProperty","Symbol","toStringTag","installedChunks","chunkId","webpackJsonpCallback","parentChunkLoadingFunction","moreModules","runtime","chunkLoadingGlobal","self","bind","__webpack_exports__"],"ignoreList":[],"sourceRoot":""}